(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19863,(e,t,r)=>{"use strict";var n,o,a,i,s,l;Object.defineProperty(r,"__esModule",{value:!0}),r.VovkSchemaIdEnum=r.HttpStatus=r.HttpMethod=void 0,(i=n||(r.HttpMethod=n={})).GET="GET",i.POST="POST",i.PUT="PUT",i.PATCH="PATCH",i.DELETE="DELETE",i.HEAD="HEAD",i.OPTIONS="OPTIONS",(s=o||(r.HttpStatus=o={}))[s.NULL=0]="NULL",s[s.CONTINUE=100]="CONTINUE",s[s.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",s[s.PROCESSING=102]="PROCESSING",s[s.EARLYHINTS=103]="EARLYHINTS",s[s.OK=200]="OK",s[s.CREATED=201]="CREATED",s[s.ACCEPTED=202]="ACCEPTED",s[s.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",s[s.NO_CONTENT=204]="NO_CONTENT",s[s.RESET_CONTENT=205]="RESET_CONTENT",s[s.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",s[s.AMBIGUOUS=300]="AMBIGUOUS",s[s.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",s[s.FOUND=302]="FOUND",s[s.SEE_OTHER=303]="SEE_OTHER",s[s.NOT_MODIFIED=304]="NOT_MODIFIED",s[s.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",s[s.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",s[s.BAD_REQUEST=400]="BAD_REQUEST",s[s.UNAUTHORIZED=401]="UNAUTHORIZED",s[s.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",s[s.FORBIDDEN=403]="FORBIDDEN",s[s.NOT_FOUND=404]="NOT_FOUND",s[s.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",s[s.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",s[s.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",s[s.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",s[s.CONFLICT=409]="CONFLICT",s[s.GONE=410]="GONE",s[s.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",s[s.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",s[s.PAYLOAD_TOO_LARGE=413]="PAYLOAD_TOO_LARGE",s[s.URI_TOO_LONG=414]="URI_TOO_LONG",s[s.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",s[s.REQUESTED_RANGE_NOT_SATISFIABLE=416]="REQUESTED_RANGE_NOT_SATISFIABLE",s[s.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",s[s.I_AM_A_TEAPOT=418]="I_AM_A_TEAPOT",s[s.MISDIRECTED=421]="MISDIRECTED",s[s.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",s[s.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",s[s.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",s[s.TOO_MANY_TRequestS=429]="TOO_MANY_TRequestS",s[s.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",s[s.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",s[s.BAD_GATEWAY=502]="BAD_GATEWAY",s[s.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",s[s.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",s[s.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",(l=a||(r.VovkSchemaIdEnum=a={})).META="https://vovk.dev/api/schema/v3/meta.json",l.CONFIG="https://vovk.dev/api/schema/v3/config.json",l.SEGMENT="https://vovk.dev/api/schema/v3/segment.json",l.SCHEMA="https://vovk.dev/api/schema/v3/schema.json"},22468,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.HttpException=void 0,r.HttpException=class extends Error{statusCode;message;cause;constructor(e,t,r){super(t),this.statusCode=e,this.message=t,this.cause=r}}},77742,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),"symbol"!=typeof Symbol.dispose&&Object.defineProperty(Symbol,"dispose",{configurable:!1,enumerable:!1,writable:!1,value:Symbol.for("dispose")}),"symbol"!=typeof Symbol.asyncDispose&&Object.defineProperty(Symbol,"asyncDispose",{configurable:!1,enumerable:!1,writable:!1,value:Symbol.for("asyncDispose")})},44901,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.JSONLinesResponse=void 0,e.r(77742);class n extends Response{isClosed=!1;controller;encoder;readableStream;iteratorQueue=[];iteratorResolvers=[];constructor(e,t){let r;const n=new TextEncoder,o=new ReadableStream({cancel:()=>{this.isClosed=!0},start:e=>{r=e}});super(o,{...t,headers:{"content-type":!e||e?.headers?.get("accept")?.includes("application/jsonl")?"application/jsonl; charset=utf-8":"text/plain; charset=utf-8",...t?.headers}}),this.readableStream=e?o:null,this.encoder=e?n:null,this.controller=e?r:null,e?.signal?.addEventListener("abort",this.close,{once:!0}),this.controller?.enqueue(n?.encode(""))}send=e=>{let{controller:t,encoder:r}=this;this.isClosed||(t?.enqueue(r?.encode(JSON.stringify(e)+"\n")),this.iteratorResolvers.length>0?this.iteratorResolvers.shift()({value:e,done:!1}):this.iteratorQueue.push(e))};close=()=>{let{controller:e}=this;if(!this.isClosed)for(this.isClosed=!0,e?.close();this.iteratorResolvers.length>0;)this.iteratorResolvers.shift()({done:!0,value:void 0})};throw=e=>(this.send({isError:!0,reason:e instanceof Error?e.message:e}),this.close());[Symbol.dispose]=()=>this.close();[Symbol.asyncDispose]=()=>this.close();[Symbol.asyncIterator]=()=>({next:async()=>this.iteratorQueue.length>0?{value:this.iteratorQueue.shift(),done:!1}:this.isClosed?{done:!0,value:void 0}:new Promise(e=>{this.iteratorResolvers.push(e)})})}r.JSONLinesResponse=n},59273,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){let t={};if(!e)return t;for(let r of e.replace(/^\?/,"").split("&")){let[e,n=""]=r.split("="),o=decodeURIComponent(e),a=decodeURIComponent(n);!function(e,t,r){let n=e;for(let e=0;e<t.length;e++){let o=t[e];if(e===t.length-1)if(""===o)Array.isArray(n)||(n=[]),n.push(r);else if(isNaN(Number(o)))n[o]=r;else{let e=Number(o);Array.isArray(n)||(n=[]),n[e]=r}else{let r=t[e+1];if(""===o)Array.isArray(n)||(n=[]),0===n.length?n.push("string"!=typeof r||isNaN(Number(r))?{}:[]):"string"!=typeof r||isNaN(Number(r))?"object"!=typeof n[n.length-1]&&(n[n.length-1]={}):Array.isArray(n[n.length-1])||(n[n.length-1]=[]),n=n[n.length-1];else if(isNaN(Number(o)))void 0===n[o]&&(n[o]="string"!=typeof r||isNaN(Number(r))?{}:[]),n=n[o];else{let e=Number(o);Array.isArray(n)||(n=[]),void 0===n[e]&&(n[e]="string"!=typeof r||isNaN(Number(r))?{}:[]),n=n[e]}}}}(t,function(e){let t,r=[],n=e.match(/^([^[\]]+)/);n?r.push(n[1]):r.push("");let o=/\[([^[\]]*)\]/g;for(;null!==(t=o.exec(e));)r.push(t[1]);return r}(o),a)}return t}},27225,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return(0,o.default)(e.nextUrl.search)};let o=n(e.r(59273))},97067,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){return t?n.set(e,{...n.get(e),...t}):null===t&&n.delete(e),n.get(e)??{}};let n=new WeakMap},69179,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;let n=new WeakMap;async function o(e){if(n.has(e))return n.get(e);let t=await e.formData();e.formData=()=>Promise.resolve(t);let r={};for(let[e,n]of t.entries())n instanceof File?r[e]?Array.isArray(r[e])?r[e].push(n):r[e]=[r[e],n]:r[e]=n:r[e]=n.toString();return n.set(e,r),r}},60078,(e,t,r)=>{"use strict";var n,o=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.VovkApp=void 0;let a=e.r(19863),i=e.r(22468),s=e.r(44901),l=o(e.r(27225)),c=o(e.r(97067)),u=o(e.r(69179));class p{static getHeadersFromOptions(e){return e?{...e.cors?{"access-control-allow-origin":"*","access-control-allow-methods":"GET, POST, PUT, DELETE, OPTIONS, HEAD","access-control-allow-headers":"content-type, authorization"}:{},...e.headers??{}}:{}}routes={GET:new Map,POST:new Map,PUT:new Map,PATCH:new Map,DELETE:new Map,HEAD:new Map,OPTIONS:new Map};GET=async(e,t)=>this.#e({httpMethod:a.HttpMethod.GET,req:e,params:await t.params});POST=async(e,t)=>this.#e({httpMethod:a.HttpMethod.POST,req:e,params:await t.params});PUT=async(e,t)=>this.#e({httpMethod:a.HttpMethod.PUT,req:e,params:await t.params});PATCH=async(e,t)=>this.#e({httpMethod:a.HttpMethod.PATCH,req:e,params:await t.params});DELETE=async(e,t)=>this.#e({httpMethod:a.HttpMethod.DELETE,req:e,params:await t.params});HEAD=async(e,t)=>this.#e({httpMethod:a.HttpMethod.HEAD,req:e,params:await t.params});OPTIONS=async(e,t)=>this.#e({httpMethod:a.HttpMethod.OPTIONS,req:e,params:await t.params});respond=async({statusCode:e,responseBody:t,options:r})=>new Response(JSON.stringify(t),{status:e,headers:{"content-type":"application/json",...n.getHeadersFromOptions(r)}});#t=({req:e,statusCode:t,message:r,options:n,cause:o})=>this.respond({req:e,statusCode:t,responseBody:{cause:o,statusCode:t,message:r,isError:!0},options:n});#r=new Map;#n=new Map;#o=new Map;#a=new Map;#i=({handlers:e,path:t,params:r})=>{let n={};if(0===Object.keys(r).length)return{handler:e[""],methodParams:n};let o=t.join("/"),s=this.#a.get(o);if(s)return{handler:e[s.route],methodParams:s.params};let l=e[o]?o:null;if(!l){let r=[],s=t.length,c=new Map;for(let t of Object.keys(e)){let e=this.#n.get(t);if(!e&&(e=t.split("/"),this.#n.set(t,e),t.includes("{"))){let r=[];for(let t=0;t<e.length;t++){let n=e[t];if(n.includes("{")){let e=n.match(/\{(\w+)\}/);e&&r.push({index:t,paramName:e[1]})}}this.#o.set(t,r)}let r=e.length;if(r!==s)continue;let n=c.get(r)||[];n.push(t),c.set(r,n)}for(let e of c.get(s)||[]){let o=this.#n.get(e),s={},l=this.#o.get(e);if(l){let c=!0;for(let e=0;e<o.length;e++){let r=o[e];if(!r.includes("{")&&r!==t[e]){c=!1;break}}if(!c)continue;for(let{index:r,paramName:n}of l){let l=o[r],u=t[r],p=this.#r.get(l);if(!p){let e=l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\\{(\w+)\\}/g,"(?<$1>[^/]+)");p=RegExp(`^${e}$`),this.#r.set(l,p)}let d=u.match(p)?.groups;if(!d){c=!1;break}if(n in s)throw new i.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,`Duplicate parameter "${n}" at ${e}`);s[n]=d[n]}c&&(n=s,r.push(e))}else{let n=!0;for(let e=0;e<o.length;e++)if(o[e]!==t[e]){n=!1;break}n&&r.push(e)}}if(r.length>1)throw new i.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,`Conflicting routes found: ${r.join(", ")}`);[l]=r,l&&this.#a.set(o,{route:l,params:n})}return l?{handler:e[l],methodParams:n}:{handler:null,methodParams:n}};#s={};#l=e=>{let t=this.routes[e],r={};return t.forEach((e,t)=>{let n=t._prefix??"";Object.entries(e??{}).forEach(([e,o])=>{r[[n,e].filter(Boolean).join("/")]={staticMethod:o,controller:t}})}),r};#e=async({httpMethod:e,req:t,params:r})=>{let o,i=r[Object.keys(r)[0]],p=this.#s[e]??this.#l(e);this.#s[e]=p;try{o=t.headers}catch{o=null}let d=o?.get("x-meta"),f=d&&JSON.parse(d);f&&(0,c.default)(t,{xMetaHeader:f});let{handler:m,methodParams:h}=this.#i({handlers:p,path:i,params:r});if(!m)return this.#t({req:t,statusCode:a.HttpStatus.NOT_FOUND,message:`${Object.keys(p)} - Route ${i.join("/")} is not found`});let{staticMethod:E,controller:y}=m,{_onSuccess:O,_onBefore:g}=y;t.vovk={body:()=>t.json(),query:()=>(0,l.default)(t),meta:e=>(0,c.default)(t,e),form:()=>(0,u.default)(t),params:()=>h};try{await E._options?.before?.call(y,t),await g?.(t);let e=await E.call(y,t,h);if(e instanceof Response)return await O?.(e,t),e;if("object"==typeof e&&e&&!(e instanceof Array)&&(Reflect.has(e,Symbol.iterator)&&"function"==typeof e[Symbol.iterator]||Reflect.has(e,Symbol.asyncIterator)&&"function"==typeof e[Symbol.asyncIterator])){let r=new s.JSONLinesResponse(t,{headers:{...n.getHeadersFromOptions(E._options)}});return(async()=>{try{for await(let t of e)r.send(t)}catch(e){return r.throw(e)}return r.close()})(),await O?.(r,t),r}let r=e??null;return await O?.(r,t),this.respond({req:t,statusCode:200,responseBody:r,options:E._options})}catch(e){try{await y._onError?.(e,t)}catch(e){console.error(e)}if("NEXT_REDIRECT"!==e.message&&"NEXT_NOT_FOUND"!==e.message){let r=e.statusCode||a.HttpStatus.INTERNAL_SERVER_ERROR;return this.#t({req:t,statusCode:r,message:e.message,options:E._options,cause:e.cause})}throw e}}}r.VovkApp=p,n=p},19555,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getControllerSchema=o,r.default=a;let n=e.r(19863);async function o(e,t,r){let n=r?e._handlers??{}:Object.fromEntries(Object.entries(e._handlers??{}).map(([e,{validation:t,...r}])=>[e,r]));return{rpcModuleName:t,originalControllerName:e.name,prefix:e._prefix??"",handlers:n}}async function a(e){let t=e?.exposeValidation??!0,r=e.emitSchema??!0,a={$schema:n.VovkSchemaIdEnum.SEGMENT,emitSchema:r,segmentName:e.segmentName??"",segmentType:"segment",controllers:{}};if(e.forceApiRoot&&(a.forceApiRoot=e.forceApiRoot),!r)return a;for(let[r,n]of Object.entries(e.controllers??{}))a.controllers[r]=await o(n,r,t);return a}},56823,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createVovkApp=function(){let e=new o.VovkApp;function t(t){let r=function(r="",n){let o=i(r);return function(r,a){s({controller:r,propertyKey:a,path:o,options:n,httpMethod:t,vovkApp:e})}};return r.auto=r=>function(n,o){let a=e.routes[t].get(n)??{};e.routes[t].set(n,a),n._handlers={...n._handlers,[o]:{...(n._handlers??{})[o],httpMethod:t}};let i=Object.keys(n._handlers[o]?.validation?.params?.properties??{}),l=o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase().replace(/^-/,"");s({controller:n,propertyKey:o,path:i.length?`${l}/${i.map(e=>`{${e}}`).join("/")}`:l,options:r,httpMethod:t,vovkApp:e})},r}return{get:t(a.HttpMethod.GET),post:t(a.HttpMethod.POST),put:t(a.HttpMethod.PUT),patch:t(a.HttpMethod.PATCH),del:t(a.HttpMethod.DELETE),head:t(a.HttpMethod.HEAD),options:t(a.HttpMethod.OPTIONS),prefix:(e="")=>{let t=i(e);return e=>(e._prefix=t,e)},initSegment:t=>{for(let[e,r]of(t.segmentName=i(t.segmentName??""),Object.entries(t.controllers??{})))r._rpcModuleName=e,r._onError=t?.onError,r._onSuccess=t?.onSuccess,r._onBefore=t?.onBefore;return{GET:e.GET,POST:e.POST,PUT:e.PUT,PATCH:e.PATCH,DELETE:e.DELETE,HEAD:e.HEAD,OPTIONS:e.OPTIONS}}}};let o=e.r(60078),a=e.r(19863);n(e.r(19555));let i=e=>e.trim().replace(/^\/|\/$/g,""),s=({controller:e,propertyKey:t,path:r,options:n,httpMethod:o,vovkApp:a})=>{if("undefined"!=typeof window)throw Error("HTTP decorators can be used on server-side only. You have probably imported a controller on the client-side.");if(!("function"==typeof e&&/class/.test(e.toString()))){let e=o.toLowerCase();throw"delete"===e&&(e="del"),Error(`Decorator must be used on a static class method. Check the controller method named "${t}" used with @${e}().`)}let i=a.routes[o].get(e)??{};if(a.routes[o].set(e,i),n?.cors){let t=a.routes.OPTIONS.get(e)??{};t[r]=()=>{},t[r]._options=n,a.routes.OPTIONS.set(e,t)}let s=e[t];s._controller=e,s._sourceMethod=s._sourceMethod??s;let l=s._sourceMethod._getSchema?.(e);s.schema=l,s.fn=s._sourceMethod?.fn,s.models=s._sourceMethod?.models,s._sourceMethod.wrapper=s,e._handlers={...e._handlers,[t]:{...l,...(e._handlers??{})[t],path:r,httpMethod:o}},i[r]=s,i[r]._options=n,e._handlersMetadata={...e._handlersMetadata,[t]:{...(e._handlersMetadata??{})[t],staticParams:n?.staticParams}}}},19147,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fetcher=r.DEFAULT_ERROR_MESSAGE=void 0,r.createFetcher=a;let n=e.r(19863),o=e.r(22468);function a({prepareRequestInit:e,transformResponse:t,onSuccess:i,onError:s}={}){return async({httpMethod:a,getEndpoint:l,validate:c,defaultHandler:u,defaultStreamHandler:p,schema:d},f)=>{let m=null,h=null,E=null;try{let{meta:s,apiRoot:y,disableClientValidation:O,init:g,interpretAs:b}=f,{body:_,query:S,params:T}=f;console.log("BLIAD apiRoot",y);let R=l({apiRoot:y,params:T,query:S}),v=Array.from(new URL(R.startsWith("/")?`http://localhost${R}`:R).pathname.matchAll(/\{([^}]+)\}/g)).map(e=>e[1]);if(v.length)throw new o.HttpException(n.HttpStatus.NULL,`Unused params: ${v.join(", ")} in ${R}`,{body:_,query:S,params:T,endpoint:R});if(!O)try{({body:_,query:S,params:T}=await c(f,{endpoint:R})??{body:_,query:S,params:T})}catch(e){if(e instanceof o.HttpException)throw e;throw new o.HttpException(n.HttpStatus.NULL,e.message??r.DEFAULT_ERROR_MESSAGE,{body:_,query:S,params:T,endpoint:R})}E={method:a,...g,headers:{accept:"application/jsonl, application/json",..._ instanceof FormData?{}:{"content-type":"application/json"},...s?{"x-meta":JSON.stringify(s)}:{},...g?.headers}},_ instanceof FormData?E.body=_:_&&(E.body=JSON.stringify(_));let A=new AbortController;E.signal=A.signal,E=e?await e(E,f):E;try{m=await fetch(R,E)}catch(e){throw new o.HttpException(n.HttpStatus.NULL,(e?.message??r.DEFAULT_ERROR_MESSAGE)+" "+R,{body:_,query:S,params:T,endpoint:R})}let N=b??m.headers.get("content-type");return h=N?.startsWith("application/jsonl")?p({response:m,abortController:A,schema:d}):N?.startsWith("application/json")?await u({response:m,schema:d}):m,h=t?await t(h,f,{response:m,init:E,schema:d}):h,await i?.(h,f,{response:m,init:E,schema:d}),[h,m]}catch(e){throw await s?.(e,f,{response:m,init:E,respData:h,schema:d}),e}}}r.DEFAULT_ERROR_MESSAGE="Unknown error at default fetcher",r.fetcher=a()},73593,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaultHandler=r.DEFAULT_ERROR_MESSAGE=void 0;let n=e.r(22468);r.DEFAULT_ERROR_MESSAGE="Unknown error at defaultHandler";let o=async({response:e,schema:t})=>{let o;try{o=await e.json()}catch(t){throw new n.HttpException(e.status,t?.message??r.DEFAULT_ERROR_MESSAGE)}if(!e.ok){let a=t.operationObject&&"x-errorMessageKey"in t.operationObject?t.operationObject["x-errorMessageKey"]:"message",i=o;throw new n.HttpException(e.status,a.split(".").reduce((e,t)=>e&&"object"==typeof e?e[t]:void 0,i)??r.DEFAULT_ERROR_MESSAGE,i?.cause??JSON.stringify(o))}return o};r.defaultHandler=o},7731,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaultStreamHandler=r.DEFAULT_ERROR_MESSAGE=void 0;let n=e.r(19863),o=e.r(22468);e.r(77742),r.DEFAULT_ERROR_MESSAGE="An unknown error at defaultStreamHandler",r.defaultStreamHandler=({response:e,abortController:t})=>{if(e.ok||e.json().then(t=>{throw new o.HttpException(e.status,t.message??r.DEFAULT_ERROR_MESSAGE)}).catch(t=>{throw new o.HttpException(e.status,t.message??r.DEFAULT_ERROR_MESSAGE,t)}),!e.body)throw new o.HttpException(n.HttpStatus.NULL,"Stream body is falsy. Check your controller code.");let a=e.body.getReader(),i=new Set;async function*s(){let e="",r=0;for(;;){let n;try{let e;if(t.signal.aborted||({value:n,done:e}=await a.read(),e))break}catch(t){let e=Error("JSONLines stream error. "+String(t));throw e.cause=t,e}for(let o of(e+="number"==typeof n?String.fromCharCode(n):new TextDecoder().decode(n)).split("\n").filter(Boolean)){let n;try{n=JSON.parse(o),e=e.slice(o.length+1)}catch{break}if(n){if(i.forEach(e=>{t.signal.aborted||e(n,r)}),r++,"isError"in n&&"reason"in n){let e=n.reason;if(t.abort(n.reason),"string"==typeof e)throw Error(e);throw e}t.signal.aborted||(yield n)}}}}let l=async()=>{let e=[];for await(let t of s())e.push(t);return e};return{status:e.status,asPromise:l,abortController:t,[Symbol.asyncIterator]:s,[Symbol.dispose]:()=>{t.abort("Stream disposed")},[Symbol.asyncDispose]:()=>{t.abort("Stream async disposed")},onIterate:e=>t.signal.aborted?()=>{}:(i.add(e),()=>{i.delete(e)})}}},44787,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){if(!e||"object"!=typeof e)return"";let t=[];for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){let n=e[r];t.push(...function e(t,r){return null==r?[]:"object"==typeof r?Array.isArray(r)?r.flatMap((r,n)=>e(`${t}[${n}]`,r)):Object.keys(r).flatMap(n=>e(`${t}[${n}]`,r[n])):[`${encodeURIComponent(t)}=${encodeURIComponent(String(r))}`]}(r,n))}return t.join("&")}},4067,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createRPC=void 0;let o=e.r(19147),a=e.r(73593),i=e.r(7731),s=n(e.r(44787)),l=(e,t,r)=>{let n=e,o=r?(0,s.default)(r):null;for(let[e,r]of Object.entries(t??{}))n=n.replace(`{${e}}`,r);return`${n}${o?"?":""}${o}`};r.createRPC=(e,t,r,n,s)=>{let c=s?.segmentNameOverride??t,u=e.segments[t];if(!u)throw Error(`Unable to create RPC module. Segment schema is missing for segment "${t}".`);let p=e.segments[t]?.controllers[r],d={};p||(console.warn(`ðŸº Unable to create RPC module. Controller schema is missing for module "${r}" from segment "${t}". Assuming that schema is not ready yet and a segment is importing an uncompiled RPC module.`),p={rpcModuleName:r,prefix:"",handlers:{}});let f=(p.prefix??"").trim().replace(/^\/|\/$/g,""),m=p.forceApiRoot??u.forceApiRoot,h=m??s?.apiRoot??"/api";for(let[t,r]of Object.entries(p.handlers??{})){let{path:E,httpMethod:y,validation:O}=r,g=({apiRoot:e,params:t,query:r})=>(console.log("apiRoot",e=e??h,h),console.log("forceApiRoot ?? options?.apiRoot",m,s?.apiRoot),[e.startsWith("http://")||e.startsWith("https://")||e.startsWith("/")?"":"/",e,m?"":c,l([f,E].filter(Boolean).join("/"),t,r)].filter(Boolean).join("/").replace(/([^:])\/+/g,"$1/")),b=async(l={})=>{let c=n instanceof Promise?(await n).fetcher:n??o.fetcher,u={name:t,httpMethod:y,getEndpoint:g,validate:async(t,{endpoint:r})=>{let n=l.validateOnClient??(s?.validateOnClient instanceof Promise?(await s?.validateOnClient)?.validateOnClient:s?.validateOnClient);if(n&&O){if("function"!=typeof n)throw Error("validateOnClient must be a function");return await n({...t},O,{fullSchema:e,endpoint:r})??t}return t},defaultHandler:a.defaultHandler,defaultStreamHandler:i.defaultStreamHandler,schema:r},p={...s,...l,body:l.body??null,query:l.query??{},params:l.params??{}};if(!c)throw Error("Fetcher is not provided");let[d,f]=await c(u,p);return l.transform?l.transform(d,f):d};b.schema=r,b.controllerSchema=p,b.segmentSchema=u,b.fullSchema=e,b.isRPC=!0,b.apiRoot=h,b.path=[c,f,E].filter(Boolean).join("/"),b.queryKey=e=>[b.segmentSchema.segmentName,b.controllerSchema.prefix??"",b.controllerSchema.rpcModuleName,b.schema.path,b.schema.httpMethod,...e??[]],d[t]=b}return d}},15577,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.progressive=function(e,...t){let[r]=t,n={};return e(r).then(async e=>{for await(let t of e)for(let[e,r]of Object.entries(t))if(e in n)n[e].isSettled||(n[e].isSettled=!0,n[e].resolve(r));else{let{promise:t,resolve:o,reject:a}=Promise.withResolvers();n[e]={resolve:o,reject:a,promise:t,isSettled:!0},n[e].resolve(r)}return Object.keys(n).forEach(e=>{n[e].isSettled||(n[e].isSettled=!0,n[e].reject(Error(`The connection was closed without sending a value for "${e}"`)))}),e}).catch(e=>(Object.keys(n).forEach(t=>{n[t].isSettled||(n[t].isSettled=!0,n[t].reject(e))}),e)),new Proxy({},{get(e,t){if(t in n)return n[t].promise;let{promise:r,resolve:o,reject:a}=Promise.withResolvers();return n[t]={resolve:o,reject:a,promise:r,isSettled:!1},r},ownKeys:()=>{throw Error("Getting own keys is not possible as they are dynamically created")}})}},98446,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.progressive=r.createFetcher=r.fetcher=r.createRPC=void 0;var n=e.r(4067);Object.defineProperty(r,"createRPC",{enumerable:!0,get:function(){return n.createRPC}});var o=e.r(19147);Object.defineProperty(r,"fetcher",{enumerable:!0,get:function(){return o.fetcher}}),Object.defineProperty(r,"createFetcher",{enumerable:!0,get:function(){return o.createFetcher}});var a=e.r(15577);Object.defineProperty(r,"progressive",{enumerable:!0,get:function(){return a.progressive}})},67241,(e,t,r)=>{"use strict";function n(e,t,r){if(!e||"object"!=typeof e)return null;if(t=t||e,!r||"string"!==e.type||"binary"!==e.format){if(void 0!==e.example)return e.example;if(e.examples&&e.examples.length>0)return e.examples[0];if(void 0!==e.const)return e.const;if(e.$ref){return i=e.$ref,s=t,l=r,n(o(i,s),s,l)}if(e.enum&&e.enum.length>0)return e.enum[0];if(e.oneOf&&e.oneOf.length>0)return n(e.oneOf[0],t,r);if(e.anyOf&&e.anyOf.length>0)return n(e.anyOf[0],t,r);if(e.allOf&&e.allOf.length>0)return n(e.allOf.reduce((e,t)=>({...e,...t}),{}),t,r);if(e.type)switch(e.type){case"string":var i,s,l,c,u=e;if(u.format)switch(u.format){case"email":case"idn-email":return"user@example.com";case"uri":case"url":case"iri":return"https://example.com";case"date":return"2023-01-01";case"date-time":return"2023-01-01T00:00:00Z";case"time":return"12:00:00Z";case"duration":return"PT1H";case"uuid":return"00000000-0000-0000-0000-000000000000";case"regex":return"^[a-zA-Z0-9]+$";case"relative-json-pointer":return"/some/relative/path";case"color":return"#000000";case"hostname":return"example.com";case"zipcode":return"12345";case"phone":return"+123-456-7890";case"password":return"******";case"binary":return"binary-data";default:return"string"}return u.pattern?"pattern-string":"string";case"number":case"integer":return void 0!==(c=e).minimum&&void 0!==c.maximum||void 0!==c.minimum?c.minimum:void 0!==c.maximum?c.maximum:0;case"boolean":return!0;case"object":return a(e,t,r);case"array":var p=e,d=t,f=r;if(p.items){let e=p.items;if(f&&"string"===e.type&&"binary"===e.format)return;let t=Math.min(p.minItems||1,3),r=Array.from({length:t},()=>n(e,d,f)).filter(e=>void 0!==e);if(0===r.length&&t>0)return;return r}return[];default:return null}return e.properties?a(e,t,r):null}}function o(e,t){let r=e.split("/").slice(1),n=t;for(let e of r)if(void 0===(n=n[e]))return{};return n}function a(e,t,r){let o={};if(e.properties){let a=e.required||[];for(let[i,s]of Object.entries(e.properties))if(a.includes(i)||0===a.length){let e=n(s,t,r);void 0!==e&&(o[i]=e)}}if(e.additionalProperties&&"object"==typeof e.additionalProperties){let a=n(e.additionalProperties,t,r);void 0!==a&&(o.additionalProp=a)}return o}Object.defineProperty(r,"__esModule",{value:!0}),r.getJSONSchemaExample=function(e,t,r){let{comment:a="//",stripQuotes:i=!1,indent:s=0,nestingIndent:l=4,ignoreBinary:c=!1}=t;return e&&"object"==typeof e?(r=r||e,function e(t,r,n,a,i,s,l,c,u){let p=" ".repeat(s),d=" ".repeat(l);if(void 0===t)return"";if(null===t)return"null";if("object"!=typeof t||t instanceof Date)return JSON.stringify(t);if(Array.isArray(t)){if(0===t.length)return"[]";let o=t.map(t=>{let o=e(t,r.items||{},n,a,i,s+l,l,c,!1);return`${p}${d}${o}`});return`[
${o.join(",\n")}
${p}]`}if("object"==typeof t){let f=Object.entries(t);if(0===f.length)return"{}";let m=[];if(u&&"object"===r.type&&r.description){let e=r.description.split("\n");m.push(`${p}${d}${a} -----`),e.forEach(e=>{m.push(`${p}${d}${a} ${e.trim()}`)}),m.push(`${p}${d}${a} -----`)}return f.forEach(([t,u],h)=>{let E=r.properties?.[t]??{},y=E;E.$ref&&(y=o(E.$ref,n)),y.description&&y.description.split("\n").forEach(e=>{m.push(`${p}${d}${a} ${e.trim()}`)});let O=i&&/^[A-Za-z_$][0-9A-Za-z_$]*$/.test(t)?t:JSON.stringify(t),g=e(u,y,n,a,i,s+l,l,c,!1);m.push(`${p}${d}${O}: ${g}${h<f.length-1?",":""}`)}),`{
${m.join("\n")}
${p}}`}return JSON.stringify(t)}(n(e,r,c),e,r,a,i,s,l,c,!0)):"null"},r.getSampleValue=n},40064,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getSampleFromObject=function(e,t){let{stripQuotes:r=!1,indent:n=0,nestingIndent:o=2,quote:a='"'}=t||{},i=JSON.stringify(e,null,o);if("'"===a&&(i=i.replace(/"([^"]*)"/g,(e,t)=>{let r=i.indexOf(e);if(i.substring(r+e.length).startsWith(":"))return e;let n=t.replace(/'/g,"\\'");return`'${n}'`})),r){let e="'"===a?"'":'"',t=RegExp(`${e}([a-zA-Z_$][a-zA-Z0-9_$]*)${e}:`,"g");i=i.replace(t,"$1:")}if(n>0){let e=" ".repeat(n);i=i.split("\n").map((t,r)=>0===r?t:e+t).join("\n")}return i}},78925,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createCodeSamples=function({handlerName:e,handlerSchema:t,controllerSchema:r,package:s,config:l}){let c=t?.validation?.query,u=t?.validation?.body,p=t?.validation?.params,d=t?.validation?.output,f=t?.validation?.iteration,m=!!c||!!u||!!p||!!l?.apiRoot||!!l?.headers,h=r.rpcModuleName,E=s?.name||"vovk-client",y=a(E),O=s?.py_name??y,g=s?.rs_name??y,b={handlerName:e,rpcName:h,packageName:E,queryValidation:c,bodyValidation:u,paramsValidation:p,outputValidation:d,iterationValidation:f,hasArg:m,config:l},_=function({handlerName:e,rpcName:t,packageName:r,queryValidation:a,bodyValidation:s,paramsValidation:l,outputValidation:c,iterationValidation:u,hasArg:p,config:d}){let f=(e,t)=>(0,n.getJSONSchemaExample)(e,{stripQuotes:!0,indent:t??4}),m=(e,t,r)=>{let o;o="string"===e.type&&"binary"===e.format?`new Blob(${i(e.contentMediaType)?'["text_content"]':"[binary_data]"}${e.contentMediaType?`, { type: "${e.contentMediaType}" }`:""})`:"object"===e.type?'"object_unknown"':`"${(0,n.getSampleValue)(e)}"`;let a=e.description??r;return`
${a?`// ${a}
`:""}formData.append("${t}", ${o});`},h=p?`{
${[s?`    body: ${s["x-isForm"]?"formData":f(s)},`:null,a?`    query: ${f(a)},`:null,l?`    params: ${f(l)},`:null,d?.apiRoot?`    apiRoot: '${d.apiRoot}',`:null,d?.headers?`    init: {
      headers: ${(0,o.getSampleFromObject)(d.headers,{stripQuotes:!0,indent:6,nestingIndent:4})}
    },`:null].filter(Boolean).join("\n")}
}`:"";return`import { ${t} } from '${r}';
${s?.["x-isForm"]?(e=>{let t="\nconst formData = new FormData();";for(let[r,n]of Object.entries(e.properties||{})){let e=n.oneOf?.[0]||n.anyOf?.[0]||n.allOf?.[0]||n,o=e.description??n.description??void 0;"array"===e.type&&e.items?(t+=m(e.items,r,o),t+=m(e.items,r,o)):t+=m(e,r,o)}return t})(s)+"\n":""}
${u?"using":"const"} response = await ${t}.${e}(${h});
${c?`
console.log(response); 
/* 
${f(c,0)}
*/`:""}${u?`
for await (const item of response) {
    console.log(item); 
    /*
    ${f(u)}
    */
}`:""}`.trim()}(b);return{ts:_,py:function({handlerName:e,rpcName:t,packageName:r,queryValidation:s,bodyValidation:l,paramsValidation:c,outputValidation:u,iterationValidation:p,hasArg:d,config:f}){let m=(e,t)=>(0,n.getJSONSchemaExample)(e,{stripQuotes:!1,indent:t??4,comment:"#",ignoreBinary:!0,nestingIndent:4}),h=a(e),E=e=>`('name.ext', BytesIO(${i(e.contentMediaType)?'"text_content".encode("utf-8")':"binary_data"})${e.contentMediaType?`, "${e.contentMediaType}"`:""})`,y=l?Object.entries(l.properties??{}).reduce((e,[t,r])=>{let n=r.oneOf?.[0]||r.anyOf?.[0]||r.allOf?.[0]||r,o=n.description??r.description??void 0;if("string"===n.type&&"binary"===n.format)e.push(`${o?`${" ".repeat(8)}# ${o}
`:""}${" ".repeat(8)}('${t}', ${E(n)})`);else if("array"===n.type&&n.items?.format==="binary"){let r=`${o?`${" ".repeat(8)}# ${o}
`:""}${" ".repeat(8)}('${t}', ${E(n.items)})`;e.push(r,r)}return e},[]):null,O=y?.length?`${" ".repeat(4)}files=[
${y.join(",\n")}
${" ".repeat(4)}],`:null;return`from ${r} import ${t}
${l?.["x-isForm"]?"from io import BytesIO\n":""}
response = ${t}.${h}(${d?"\n"+[l?`    body=${m(l)},`:null,O,s?`    query=${m(s)},`:null,c?`    params=${m(c)},`:null,f?.apiRoot?`    api_root="${f.apiRoot}",`:null,f?.headers?`    headers=${(0,o.getSampleFromObject)(f.headers,{stripQuotes:!1,indent:4,nestingIndent:4})},`:null].filter(Boolean).join("\n")+"\n":""})

${u?`print(response)
${m(u,0)}`:""}${p?`for i, item in enumerate(response):
    print(f"iteration #{i}:\\n {item}")
    # iteration #0:
    ${m(p)}`:""}`.trim()}({...b,packageName:O}),rs:function({handlerName:e,rpcName:t,packageName:r,queryValidation:o,bodyValidation:s,paramsValidation:l,outputValidation:c,iterationValidation:u,config:p}){let d=(e,t)=>(0,n.getJSONSchemaExample)(e,{stripQuotes:!1,indent:t??4}),f=(e,t)=>(0,n.getJSONSchemaExample)(e,{stripQuotes:!0,indent:t??4}),m=(e,t,r)=>{let o;"string"===e.type&&"binary"===e.format?(o=i(e.contentMediaType)?'multipart::Part::text("text_content")':"multipart::Part::bytes(binary_data)",e.contentMediaType&&(o+=`.mime_str("${e.contentMediaType}").unwrap()`)):o="object"===e.type?'"object_unknown"':`"${(0,n.getSampleValue)(e)}"`;let a=e.description??r;return`
${" ".repeat(4)}${a?`// ${a}
`:""}${" ".repeat(4)}.part("${t}", ${o});`},h=a(e),E=a(t),y=e=>`from_value(json!(${e})).unwrap()`;return`use ${r}::${E};
use serde_json::{ 
  from_value, 
  json 
};
${s?.["x-isForm"]?`use multipart;
`:""}
pub fn main() {${s?.["x-isForm"]?"\n  "+(e=>{let t="let form = multipart::Form::new()";for(let[r,n]of Object.entries(e.properties||{})){let e=n.oneOf?.[0]||n.anyOf?.[0]||n.allOf?.[0]||n,o=e.description??n.description??void 0;"array"===e.type&&e.items?(t+=m(e.items,r,o),t+=m(e.items,r,o)):t+=m(e,r,o)}return t})(s)+"\n":""}
  let response = ${E}::${h}(
    ${s?s["x-isForm"]?"form":y(d(s)):"()"}, /* body */ 
    ${o?y(d(o)):"()"}, /* query */ 
    ${l?y(d(l)):"()"}, /* params */ 
    ${p?.headers?`${((e,t=4)=>{let r=Object.entries(e).map(([e,r])=>{let n;return`${n=t+2," ".repeat(n)}("${e}".to_string(), "${r}".to_string())`}).join(",\n");return`Some(&HashMap::from([
${r}
${" ".repeat(4)}]))`})(p.headers)}, /* headers */`:"None, /* headers (HashMap) */ "}
    ${p?.apiRoot?`"${p.apiRoot}".to_string(), /* api_root */`:"None, /* api_root */"}
    false, /* disable_client_validation */
  );${c?`

match response {
    Ok(output) => println!("{:?}", output),
    /* 
    output ${f(c)} 
    */
    Err(e) => println!("error: {:?}", e),
  }`:""}${u?`

match response {
    Ok(stream) => {
      for (i, item) in stream.enumerate() {
        println!("#{}: {:?}", i, item);
        /*
        #0: iteration ${f(u,8)}
        */
      }
    },
    Err(e) => println!("Error initiating stream: {:?}", e),
  }`:""}
}`.trim()}({...b,packageName:g})}};let n=e.r(67241),o=e.r(40064),a=e=>e.replace(/-/g,"_").replace(/([a-z0-9])([A-Z])/g,"$1_$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1_$2").toLowerCase().replace(/^_/,"");function i(e){return!!e&&(e.startsWith("text/")||["application/json","application/ld+json","application/xml","application/xhtml+xml","application/javascript","application/typescript","application/yaml","application/x-yaml","application/toml","application/sql","application/graphql","application/x-www-form-urlencoded"].includes(e)||e.endsWith("+json")||e.endsWith("+xml"))}},22559,(e,t,r)=>{"use strict";function n(e,t){if(!e||"object"!=typeof e)return null;if(t=t||e,void 0!==e.example)return e.example;if(e.examples&&e.examples.length>0)return e.examples[0];if(void 0!==e.const)return e.const;if(e.$ref){var r,a=e.$ref,i=t;let o=a.split("/").slice(1),s=i;for(let e of o)if(void 0===(s=s[e]))return null;return n(s,i)}if(e.enum&&e.enum.length>0)return e.enum[0];if(e.oneOf&&e.oneOf.length>0)return n(e.oneOf[0],t);if(e.anyOf&&e.anyOf.length>0)return n(e.anyOf[0],t);if(e.allOf&&e.allOf.length>0)return n(e.allOf.reduce((e,t)=>({...e,...t}),{}),t);if(e.type)switch(e.type){case"string":var s=e;if(s.format)switch(s.format){case"email":case"idn-email":return"user@example.com";case"uri":case"url":case"iri":return"https://example.com";case"date":return"2023-01-01";case"date-time":return"2023-01-01T00:00:00Z";case"time":return"12:00:00Z";case"duration":return"PT1H";case"uuid":return"00000000-0000-0000-0000-000000000000";case"regex":return"^[a-zA-Z0-9]+$";case"relative-json-pointer":return"/some/relative/path";case"color":return"#000000";case"hostname":return"example.com";case"zipcode":return"12345";case"phone":return"+123-456-7890";case"password":return"******";default:return"string"}return s.pattern?"pattern-string":"string";case"number":case"integer":return void 0!==(r=e).minimum&&void 0!==r.maximum||void 0!==r.minimum?r.minimum:void 0!==r.maximum?r.maximum:0;case"boolean":return!0;case"object":return o(e,t);case"array":var l=e,c=t;if(l.items){let e=l.items;return Array.from({length:Math.min(l.minItems||1,3)},()=>n(e,c))}return[];default:return null}return e.properties?o(e,t):null}function o(e,t){let r={};if(e.properties){let o=e.required||[];for(let[a,i]of Object.entries(e.properties))(o.includes(a)||0===o.length)&&(r[a]=n(i,t))}return e.additionalProperties&&"object"==typeof e.additionalProperties&&(r.additionalProp=n(e.additionalProperties,t)),r}Object.defineProperty(r,"__esModule",{value:!0}),r.getJSONSchemaSample=n},51893,(e,t,r)=>{"use strict";var n=e.i(67034);function o(e){return e instanceof n.Buffer||e instanceof Date||e instanceof RegExp}function a(e){if(e instanceof n.Buffer){let t=n.Buffer.alloc?n.Buffer.alloc(e.length):n.Buffer.from(e);return e.copy(t),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);throw Error("Unexpected situation")}function i(e){let t=[];return e.forEach((e,r)=>{"object"==typeof e&&null!==e?Array.isArray(e)?t[r]=i(e):o(e)?t[r]=a(e):t[r]=l({},e):t[r]=e}),t}function s(e,t){return"__proto__"===t?void 0:e[t]}function l(...e){if(e.length<1||"object"!=typeof e[0])return!1;if(e.length<2)return e[0];let t=e[0];return e.slice(1).forEach(e=>{"object"!=typeof e||null===e||Array.isArray(e)||Object.keys(e).forEach(r=>{let n=s(t,r),c=s(e,r);if(c!==t){if("object"!=typeof c||null===c){t[r]=c;return}if(Array.isArray(c)){t[r]=i(c);return}if(o(c)){t[r]=a(c);return}else if("object"!=typeof n||null===n||Array.isArray(n)){t[r]=l({},c);return}else{t[r]=l(n,c);return}}})}),t}Object.defineProperty(r,"__esModule",{value:!0}),r.deepExtend=l,r.deepCloneArray=i,r.isSpecificValue=o,r.cloneSpecificValue=a,r.safeGetProperty=s,r.default=l},35237,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.resolveGeneratorConfigValues=function({schema:e,configs:t,segmentName:r,isBundle:n,projectPackageJson:a}){let i=(0,o.default)({},{main:"./index.cjs",module:"./index.mjs",types:"./index.d.mts",exports:{".":{import:"./index.mjs",require:"./index.cjs",types:"./index.d.mts"}}},Object.fromEntries(Object.entries(a??{}).filter(([e])=>["name","version","description","license","authors","repository","homepage","bugs","keywords"].includes(e))),e.meta?.config?.outputConfig?.package,n?e.meta?.config?.bundle?.outputConfig?.package:void 0,"string"==typeof r?e.segments?.[r]?.meta?.package:void 0,"string"==typeof r?e.meta?.config?.outputConfig?.segments?.[r]?.package:void 0,t?.reduce((e,t)=>(0,o.default)(e,t.package),{}));return{package:i,openAPIObject:(0,o.default)({},{openapi:"3.1.0",info:{title:i.name,version:i.version,description:i.description}},e.meta?.config?.outputConfig?.openAPIObject,n?e.meta?.config?.bundle?.outputConfig?.openAPIObject:void 0,"string"==typeof r?e?.segments?.[r]?.meta?.openAPIObject:void 0,"string"==typeof r?e.meta?.config?.outputConfig?.segments?.[r]?.openAPIObject:void 0,t?.reduce((e,t)=>(0,o.default)(e,t.openAPIObject),{})),samples:(0,o.default)({},e.meta?.config?.outputConfig?.samples,n?e.meta?.config?.bundle?.outputConfig?.samples:void 0,"string"==typeof r?e.meta?.config?.outputConfig?.segments?.[r]?.samples:void 0,t?.reduce((e,t)=>(0,o.default)(e,t.samples),{})),readme:(0,o.default)({},e.meta?.config?.outputConfig?.readme,n?e.meta?.config?.bundle?.outputConfig?.readme:void 0,"string"==typeof r?e.meta?.config?.outputConfig?.segments?.[r]?.readme:void 0,t?.reduce((e,t)=>(0,o.default)(e,t.readme),{})),origin:[n?e.meta?.config?.bundle?.outputConfig?.origin:void 0,"string"==typeof r?e.meta?.config?.outputConfig?.segments?.[r]?.origin:void 0,e.meta?.config?.outputConfig?.origin,...t?.map(e=>e.origin)??[]].filter(Boolean).at(-1)?.replace(/\/$/,"")??"",imports:(0,o.default)({fetcher:["vovk"],validateOnClient:null,createRPC:["vovk"]},e.meta?.config?.outputConfig?.imports,n?e.meta?.config?.bundle?.outputConfig?.imports:void 0,"string"==typeof r?e.meta?.config?.outputConfig?.segments?.[r]?.imports:void 0,t?.reduce((e,t)=>(0,o.default)(e,t.imports),{})),reExports:(0,o.default)({},!r&&e.meta?.config?.outputConfig?.reExports,!r&&n?e.meta?.config?.bundle?.outputConfig?.reExports:void 0,"string"!=typeof r&&Object.values(e.meta?.config?.outputConfig?.segments??{}).reduce((e,t)=>(0,o.default)(e,t.reExports??{}),{}),"string"==typeof r?e.meta?.config?.outputConfig?.segments?.[r]?.reExports:void 0,t?.reduce((e,t)=>(0,o.default)(e,t.reExports),{}))}};let o=n(e.r(51893))},91204,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.vovkSchemaToOpenAPI=function({rootEntry:e="api",schema:t,configs:r,segmentName:l}){let c={},u={},{openAPIObject:p,samples:d,package:f}=(0,i.resolveGeneratorConfigValues)({schema:t,configs:r,segmentName:l??null});for(let[r,o]of l?[[l,t.segments[l]]]:Object.entries(t.segments??{}))for(let t of Object.values(o.controllers))for(let[o,i]of Object.entries(t.handlers??{}))if(i.operationObject){let[l,p]=s(i?.validation?.query),[m,h]=s(i?.validation?.body),[E,y]=s(i?.validation?.params),[O,g]=s(i?.validation?.output),[b,_]=s(i?.validation?.iteration);Object.assign(u,p,h,y,g,_);let{ts:S,rs:T,py:R}=(0,n.createCodeSamples)({package:f,handlerName:o,handlerSchema:i,controllerSchema:t,config:d}),v=l&&"type"in l&&"properties"in l?Object.entries(l.properties??{}).map(([e,t])=>({name:e,in:"query",required:!!l.required&&l.required.includes(e),schema:t})):null,A=E&&"type"in E&&"properties"in E?Object.entries(E.properties??{}).map(([e,t])=>({name:e,in:"path",required:!!E.required&&E.required.includes(e),schema:t})):null,N=i.misc?.originalPath??"/"+[e.replace(/^\/+|\/+$/g,""),r,t.prefix,i.path].filter(Boolean).join("/");c[N]=c[N]??{};let P=i.httpMethod.toLowerCase();c[N][P]??={},c[N][P]={...i.operationObject,...c[N][P],"x-codeSamples":[...c[N][P]["x-codeSamples"]??[],...i.operationObject?.["x-codeSamples"]??[],{label:"TypeScript RPC",lang:"typescript",source:S},{label:"Python RPC",lang:"python",source:R},{label:"Rust RPC",lang:"rust",source:T}],...v||A?{parameters:i.operationObject?.parameters??[...v||[],...A||[]]}:{},...c[N][P].parameters?{parameters:c[N][P].parameters}:{},...O&&"type"in O?{responses:{200:{description:"description"in O?O.description:"Success",content:{[O["x-isForm"]?"multipart/form-data":"application/json"]:{schema:O}}},...i.operationObject?.responses}}:{},...b&&"type"in b?{responses:{200:{description:"description"in b?b.description:"JSON Lines response",content:{"application/jsonl":{schema:{...b,examples:b.examples??[[JSON.stringify((0,a.getJSONSchemaSample)(b)),JSON.stringify((0,a.getJSONSchemaSample)(b)),JSON.stringify((0,a.getJSONSchemaSample)(b))].join("\n")]}}}},...i.operationObject?.responses}}:{},...c[N][P].responses?{responses:c[N][P].responses}:{},...m&&"type"in m?{requestBody:i.operationObject?.requestBody??{description:"description"in m?m.description:"Request body",required:!0,content:{"application/json":{schema:m}}}}:{},...c[N][P].requestBody?{requestBody:c[N][P].requestBody}:{},tags:c[N][P].tags??i.operationObject?.tags}}return{...p,components:{...p?.components,schemas:{...p?.components?.schemas??u,HttpStatus:{type:"integer",description:"HTTP status code",enum:Object.keys(o.HttpStatus).map(e=>o.HttpStatus[e]).filter(Boolean).filter(e=>"number"==typeof e)},VovkErrorResponse:{type:"object",description:"Vovk error response",properties:{cause:{description:"Error cause of any shape"},statusCode:{$ref:"#/components/schemas/HttpStatus"},message:{type:"string",description:"Error message"},isError:{type:"boolean",const:!0,description:"Indicates that this object represents an error"}},required:["statusCode","message","isError"],additionalProperties:!1},...p?.components?.schemas}},paths:c}};let n=e.r(78925),o=e.r(19863),a=e.r(22559),i=e.r(35237);function s(e){if(!e)return[void 0,{}];let t={},r=(e,n=[])=>{if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(e=>r(e,n));let o={};for(let[a,i]of(Object.entries({...e.definitions,...e.$defs}).forEach(([e,o])=>{t[e]=r(o,[...n,e])}),Object.entries(e??{})))if("$defs"!==a&&"definitions"!==a)if("$ref"===a&&"string"==typeof i){let e=i.split("/"),t=e[e.length-1];o[a]=`#/components/schemas/${t}`}else o[a]=r(i,[...n,a]);return o};return[r(e),t]}},84202,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.camelCase=function(e){return((null==e?"":String(e)).replace(/[\s_-]+/g," ").trim().match(n)||[]).map((e,t)=>{let r=e.toLowerCase();return 0===t?r:r.charAt(0).toUpperCase()+r.slice(1)}).join("")};let n=/[\p{Lu}]{2,}(?=[\p{Lu}][\p{Ll}]+[0-9]*|\b)|[\p{Lu}]?[\p{Ll}]+[0-9]*|[\p{Lu}]|[0-9]+/gu},4389,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.upperFirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},71057,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.applyComponentsSchemas=function(e,t,r){let i="components/schemas";if(!t||!Object.keys(t).length)return e;let s=a(e);s.$defs=s.$defs||{};let l=new Set;return function e(c){if(!c||"object"!=typeof c)return c;if(Array.isArray(c))return c.map(t=>e(t));let u={...c},p=u.$ref;if(p&&"string"==typeof p&&p.startsWith(`#/${i}/`)){let c=p.replace(`#/${i}/`,"");t[c]?(u.$ref=`#/$defs/${c}`,u["x-tsType"]??=`Mixins.${(0,o.upperFirst)((0,n.camelCase)(r))}.${(0,o.upperFirst)((0,n.camelCase)(c))}`):delete u.$ref,!l.has(c)&&t[c]&&(l.add(c),s.$defs[c]=e(a(t[c])))}for(let t in u)Object.prototype.hasOwnProperty.call(u,t)&&(u[t]=e(u[t]));return u}(s)};let n=e.r(84202),o=e.r(4389);function a(e){if(null===e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(a);let t={};for(let[r,n]of Object.entries(e))n instanceof Date||n instanceof RegExp||"function"==typeof n||(t[r]=a(n));return t}},5711,(e,t,r)=>{"use strict";function n(e,t){if(!e.startsWith("#/"))return void console.warn(`External references are not supported: ${e}`);let r=e.substring(1).split("/").filter(e=>""!==e),n=t;for(let t of r){let r=t.replace(/~1/g,"/").replace(/~0/g,"~");if(!n||"object"!=typeof n||!(r in n))return void console.warn(`Could not resolve reference: ${e}`);n=n[r]}return n}Object.defineProperty(r,"__esModule",{value:!0}),r.inlineRefs=function(e,t){if(null==e)return e;if(Array.isArray(e))return e.map(e=>{if(e&&"object"==typeof e&&"$ref"in e&&"string"==typeof e.$ref){if(e.$ref.startsWith("#/components/schemas/"))return e;let r=n(e.$ref,t);if(void 0!==r){let{$ref:t,...n}=e;return Object.keys(n).length>0?{...r,...n}:r}}return e});if("object"!=typeof e)return e;if("$ref"in e&&"string"==typeof e.$ref){if(e.$ref.startsWith("#/components/schemas/"))return e;let r=n(e.$ref,t);if(void 0!==r){let{$ref:t,...n}=e;return Object.keys(n).length>0?{...r,...n}:r}}return e}},90838,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.openAPIToVovkSchema=function({apiRoot:e,source:{object:t},getModuleName:r,getMethodName:i,errorMessageKey:s,segmentName:l}){l=l??"";let c=e||(t.servers?.[0]?.url??("host"in t?`https://${t.host}${"basePath"in t?t.basePath:""}`:null));if(!c)throw Error("API root URL is required in OpenAPI configuration");let{paths:u,...p}=t,d={$schema:n.VovkSchemaIdEnum.SCHEMA,segments:{[l]:{$schema:n.VovkSchemaIdEnum.SEGMENT,emitSchema:!0,segmentName:l,segmentType:"mixin",controllers:{},forceApiRoot:c,meta:{openAPIObject:p}}}},f=d.segments[l];return Object.entries(u??{}).reduce((e,[n,c])=>(Object.entries(c??{}).filter(([,e])=>e&&"object"==typeof e).forEach(([e,c])=>{let u=r({method:e.toUpperCase(),path:n,openAPIObject:t,operationObject:c}),p=i({method:e.toUpperCase(),path:n,openAPIObject:t,operationObject:c});f.controllers[u]??={rpcModuleName:u,handlers:{}};let d=(0,a.inlineRefs)(c.parameters??[],t),m=d.filter(e=>"query"===e.in)??null,h=d.filter(e=>"path"===e.in)??null,E=m?.length?{type:"object",properties:Object.fromEntries(m.map(e=>[e.name,e.schema])),required:m.filter(e=>e.required).map(e=>e.name)}:null,y=h?.length?{type:"object",properties:Object.fromEntries(h.map(e=>[e.name,e.schema])),required:h.filter(e=>e.required).map(e=>e.name)}:null,O=(0,a.inlineRefs)(c.requestBody,t)?.content??{},g=O["application/json"]?.schema??null,b=O["multipart/form-data"]?.schema??null,_=O["application/x-www-form-urlencoded"]?.schema??null;b&&_&&JSON.stringify(b)===JSON.stringify(_)&&(_=null),b&&Object.assign(b,{"x-isForm":!0,"x-tsType":"FormData"}),_&&Object.assign(_,{"x-isForm":!0,"x-tsType":"FormData"});let S=[g,b,_].filter(Boolean),T=S.length?1===S.length?S[0]:{anyOf:S}:null,R=c.responses?.["200"]?.content?.["application/json"]?.schema??c.responses?.["201"]?.content?.["application/json"]?.schema??null,v=c.responses?.["200"]?.content?.["application/jsonl"]?.schema??c.responses?.["201"]?.content?.["application/jsonl"]?.schema??c.responses?.["200"]?.content?.["application/jsonlines"]?.schema??c.responses?.["201"]?.content?.["application/jsonlines"]?.schema??null;s&&(c["x-errorMessageKey"]=s);let A=t.components?.schemas??("definitions"in t?t.definitions:{});f.controllers[u].handlers[p]={httpMethod:e.toUpperCase(),path:n,operationObject:c,misc:{originalPath:n},validation:{...E&&{query:(0,o.applyComponentsSchemas)(E,A,l)},...y&&{params:(0,o.applyComponentsSchemas)(y,A,l)},...T&&{body:(0,o.applyComponentsSchemas)(T,A,l)},...R&&{output:(0,o.applyComponentsSchemas)(R,A,l)},...v&&{iteration:(0,o.applyComponentsSchemas)(v,A,l)}}}}),e),d)};let n=e.r(19863),o=e.r(71057),a=e.r(5711)},21070,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createDecorator=function(e,t){return function(...r){return function(n,o){let a=n[o];if("function"!=typeof a)throw Error(`Unable to decorate: ${o} is not a function`);let i=a._sourceMethod??a,s=function(t,o){let i=async()=>await a.call(n,t,o);return e?e.call(n,t,i,...r):i()};n[o]=s,s._controller=n,s._sourceMethod=i,s.fn=a.fn,s.models=a.models,i.wrapper=s,a._controller=n;let l=n._handlers?.[o]??null,c=t?.call(n,...r),u="function"==typeof c?c(l,{handlerName:o}):c,p={...l,...u?.validation?{validation:u.validation}:{},...u?.operationObject?{operationObject:u.operationObject}:{},...u?.misc?{misc:u.misc}:{}};s.schema=p,n._handlers={...n._handlers,[o]:p}}}}},98876,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.error=void 0;let n=e.r(19863),o=e.r(21070),a={[n.HttpStatus.NULL]:"Error",[n.HttpStatus.CONTINUE]:"Continue",[n.HttpStatus.SWITCHING_PROTOCOLS]:"Switching Protocols",[n.HttpStatus.PROCESSING]:"Processing",[n.HttpStatus.EARLYHINTS]:"Early Hints",[n.HttpStatus.OK]:"OK",[n.HttpStatus.CREATED]:"Created",[n.HttpStatus.ACCEPTED]:"Accepted",[n.HttpStatus.NON_AUTHORITATIVE_INFORMATION]:"Non Authoritative Information",[n.HttpStatus.NO_CONTENT]:"No Content",[n.HttpStatus.RESET_CONTENT]:"Reset Content",[n.HttpStatus.PARTIAL_CONTENT]:"Partial Content",[n.HttpStatus.AMBIGUOUS]:"Ambiguous",[n.HttpStatus.MOVED_PERMANENTLY]:"Moved Permanently",[n.HttpStatus.FOUND]:"Found",[n.HttpStatus.SEE_OTHER]:"See Other",[n.HttpStatus.NOT_MODIFIED]:"Not Modified",[n.HttpStatus.TEMPORARY_REDIRECT]:"Temporary Redirect",[n.HttpStatus.PERMANENT_REDIRECT]:"Permanent Redirect",[n.HttpStatus.BAD_REQUEST]:"Bad Request",[n.HttpStatus.UNAUTHORIZED]:"Unauthorized",[n.HttpStatus.PAYMENT_REQUIRED]:"Payment Required",[n.HttpStatus.FORBIDDEN]:"Forbidden",[n.HttpStatus.NOT_FOUND]:"Not Found",[n.HttpStatus.METHOD_NOT_ALLOWED]:"Method Not Allowed",[n.HttpStatus.NOT_ACCEPTABLE]:"Not Acceptable",[n.HttpStatus.PROXY_AUTHENTICATION_REQUIRED]:"Proxy Authentication Required",[n.HttpStatus.REQUEST_TIMEOUT]:"Request Timeout",[n.HttpStatus.CONFLICT]:"Conflict",[n.HttpStatus.GONE]:"Gone",[n.HttpStatus.LENGTH_REQUIRED]:"Length Required",[n.HttpStatus.PRECONDITION_FAILED]:"Precondition Failed",[n.HttpStatus.PAYLOAD_TOO_LARGE]:"Payload Too Large",[n.HttpStatus.URI_TOO_LONG]:"URI Too Long",[n.HttpStatus.UNSUPPORTED_MEDIA_TYPE]:"Unsupported Media Type",[n.HttpStatus.REQUESTED_RANGE_NOT_SATISFIABLE]:"Requested Range Not Satisfiable",[n.HttpStatus.EXPECTATION_FAILED]:"Expectation Failed",[n.HttpStatus.I_AM_A_TEAPOT]:"I am a teapot",[n.HttpStatus.MISDIRECTED]:"Misdirected",[n.HttpStatus.UNPROCESSABLE_ENTITY]:"Unprocessable Entity",[n.HttpStatus.FAILED_DEPENDENCY]:"Failed Dependency",[n.HttpStatus.PRECONDITION_REQUIRED]:"Precondition Required",[n.HttpStatus.TOO_MANY_TRequestS]:"Too Many Requests",[n.HttpStatus.INTERNAL_SERVER_ERROR]:"Internal Server Error",[n.HttpStatus.NOT_IMPLEMENTED]:"Not Implemented",[n.HttpStatus.BAD_GATEWAY]:"Bad Gateway",[n.HttpStatus.SERVICE_UNAVAILABLE]:"Service Unavailable",[n.HttpStatus.GATEWAY_TIMEOUT]:"Gateway Timeout",[n.HttpStatus.HTTP_VERSION_NOT_SUPPORTED]:"HTTP Version Not Supported"};r.error=(0,o.createDecorator)(null,(e,t)=>r=>({...r,operationObject:{...r?.operationObject,responses:{...r?.operationObject?.responses,[e]:{description:`${e} ${a[e]}`,content:{"application/json":{schema:{allOf:[{$ref:"#/components/schemas/VovkErrorResponse"},{type:"object",properties:{message:{type:"string",enum:[t,...r?.operationObject?.responses?.[e]?.content?.["application/json"]?.schema?.allOf?.[1]?.properties?.message?.enum??[]]},statusCode:{type:"integer",enum:[e]}}}]}}}}}}}))},3182,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.openAPIToVovkSchema=r.vovkSchemaToOpenAPI=r.operation=r.operationDecorator=void 0;let n=e.r(91204);Object.defineProperty(r,"vovkSchemaToOpenAPI",{enumerable:!0,get:function(){return n.vovkSchemaToOpenAPI}});let o=e.r(90838);Object.defineProperty(r,"openAPIToVovkSchema",{enumerable:!0,get:function(){return o.openAPIToVovkSchema}});let a=e.r(98876);r.operationDecorator=(0,e.r(21070).createDecorator)(null,(e={})=>t=>({...t,operationObject:{...t?.operationObject,...e}})),r.operation=Object.assign(r.operationDecorator,{error:a.error})},95533,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateStaticAPI=function(e,t="vovk"){return[{[t]:["_schema_"]},...Object.values(e).map(e=>{let r=e._handlers,n=e._prefix?.split("/")??[];return Object.entries(r??{}).map(([r,o])=>{let a=e._handlersMetadata?.[r]?.staticParams;return a?.length?a.map(e=>{let r=o.path;for(let[t,n]of Object.entries(e??{}))r=r.replace(`{${t}}`,n);return{[t]:[...n,...r.split("/")].filter(Boolean)}}):[{[t]:[...n,...o.path.split("/")].filter(Boolean)}]}).flat()}).flat()]}},54305,(e,t,r)=>{"use strict";async function n(e,t){e._getSchema=r=>{if(!r)throw Error("Error setting client validators. Controller not found. Did you forget to use an HTTP decorator?");if(!Object.getOwnPropertyNames(r).find(t=>r[t]._sourceMethod===e))throw Error("Error setting client validators. Handler not found.");return t}}Object.defineProperty(r,"__esModule",{value:!0}),r.setHandlerSchema=n},88736,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.withValidationLibrary=function({isForm:e,disableServerSideValidation:t,skipSchemaEmission:r,validateEachIteration:n,body:c,query:u,params:p,output:d,iteration:f,handle:m,toJSONSchema:h,validate:E,preferTransformed:y,operationObject:O}){y=y??!0;let g=!1===t?[]:!0===t?l:t??[],b=!1===r?[]:!0===r?l:r??[],_=async(e,t)=>{let{__disableClientValidation:r}=e.vovk.meta(),i=await m(e,t);if(r)return i;if(d&&f)throw new o.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,"Output and iteration are mutually exclusive. You can't use them together.");if(d&&!g.includes("output")){if(!i)throw new o.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,"Output is required. You probably forgot to return something from your handler.");let t=await E(i,d,{type:"output",req:e})??i;return y?t:i}if(f&&!g.includes("iteration")){if(!i||"function"!=typeof i[Symbol.asyncIterator])throw new o.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,"Data is not an async iterable but iteration validation is defined.");return async function*(){let t=0;for await(let r of i){let o;o=n||0===t?await E(r,f,{type:"iteration",req:e,status:200,i:t})??r:r,t++,yield y?o:r}}()}if(n)throw new o.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,"validateEachIteration is set but iteration is not defined.");return i},S=async(t,r)=>{let{__disableClientValidation:n}=t.vovk.meta();if(!n){if(c&&!g.includes("body")){let r=await t.vovk[e?"form":"body"](),n=await E(r,c,{type:e?"form":"body",req:t})??r,o=y?n:r;t.json=()=>Promise.resolve(r),t.vovk[e?"form":"body"]=()=>Promise.resolve(o)}if(u&&!g.includes("query")){let e=t.vovk.query(),r=await E(e,u,{type:"query",req:t})??e,n=y?r:e;t.vovk.query=()=>n}if(p&&!g.includes("params")){let e=t.vovk.params(),r=await E(e,p,{type:"params",req:t})??e,n=y?r:e;t.vovk.params=()=>n}}return _(t,r)},T=Object.assign(S,{fn:function(e){let t={vovk:{body:()=>Promise.resolve(e?.body??{}),query:()=>e?.query??{},params:()=>e?.params??{},meta:e=>(0,i.default)(t,e),form:()=>{throw Error("Form data is not supported in this context.")}}};return t.vovk.meta({__disableClientValidation:e?.disableClientValidation,...e?.meta}),(S.wrapper??S)(t,e?.params??{})},models:{...void 0!==c?{body:c}:{},...void 0!==u?{query:u}:{},...void 0!==p?{params:p}:{},...void 0!==d?{output:d}:{},...void 0!==f?{iteration:f}:{}}});if(h){let t=(t,r)=>Object.assign(h(t,{type:r}),"body"===r&&e?{"x-isForm":e}:{}),r={};c&&!b.includes("body")&&(r.body=t(c,"body")),u&&!b.includes("query")&&(r.query=t(u,"query")),p&&!b.includes("params")&&(r.params=t(p,"params")),d&&!b.includes("output")&&(r.output=t(d,"output")),f&&!b.includes("iteration")&&(r.iteration=t(f,"iteration")),T.schema={validation:r,operationObject:O},(0,s.setHandlerSchema)(T,{validation:r,operationObject:O})}return T};let o=e.r(22468),a=e.r(19863),i=n(e.r(97067)),s=e.r(54305),l=["body","query","params","output","iteration"]},47549,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createStandardValidation=function({toJSONSchema:e}){return function({isForm:t,body:r,query:i,params:s,output:l,iteration:c,handle:u,disableServerSideValidation:p,skipSchemaEmission:d,validateEachIteration:f,preferTransformed:m,operationObject:h}){return(0,o.withValidationLibrary)({isForm:t,body:r,query:i,params:s,output:l,iteration:c,disableServerSideValidation:p,skipSchemaEmission:d,validateEachIteration:f,handle:u,toJSONSchema:e,validate:async(e,t,{type:r,i:o})=>{let i=await t["~standard"].validate(e);if(i.issues?.length)throw new a.HttpException(n.HttpStatus.BAD_REQUEST,`Validation failed. Invalid ${"iteration"===r?`${r} #${o}`:r} on server: ${i.issues.map(({message:e,path:t})=>`${e}${t?` at ${t.join(".")}`:""}`).join(", ")}`,{[r]:e,result:i});return i.value},preferTransformed:m,operationObject:h})}};let n=e.r(19863),o=e.r(88736),a=e.r(22468)},69923,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.multitenant=function(e){let{requestUrl:t,requestHost:r,targetHost:o,overrides:a}=e,i=new URL(t),s=i.pathname.slice(1);if(s.endsWith("_schema_"))return{action:null,destination:null,message:"Schema endpoint, bypassing overrides",subdomains:null};let l=s.split("/").filter(Boolean),c=Object.keys(a).filter(e=>!e.includes("[")&&!e.includes("]"));for(let e=0;e<l.length;e++){let t=l[e];if(c.includes(t)){let r=`${t}.${o}`,n=[...l.slice(0,e),...l.slice(e+1)].join("/"),a=new URL(`${i.protocol}//${r}`);return n&&(a.pathname=`/${n}`),a.search=i.search,{action:"redirect",destination:a.toString(),message:`Redirecting to ${t} subdomain`,subdomains:null}}}for(let e in a){let{regex:t,paramNames:l}=n(`${e}.${o}`),c=r.match(t);if(c){let t=a[e],r={};if(c.length>1)for(let e=0;e<l.length;e++)r[l[e]]=c[e+1];for(let e of t)if(s===e.from||s.startsWith(`${e.from}/`)){let t=s.replace(e.from,e.to);Object.keys(r).length>0&&Object.entries(r).forEach(([e,r])=>{t=t.replace(`[${e}]`,r)});let n=l.length>0?r:null;return{action:"rewrite",destination:`${i.protocol}//${i.host}/${t}${i.search}`,message:`Rewriting to ${t}`,subdomains:n}}}}if(l.length>0&&c.includes(l[0])){let e=l[0],t=l.slice(1).join("/"),r=`${e}.${o}`,n=new URL(`${i.protocol}//${r}`);return t&&(n.pathname=`/${t}`),n.search=i.search,{action:"redirect",destination:n.toString(),message:`Redirecting to ${e} subdomain`,subdomains:null}}return{action:null,destination:null,message:"No action",subdomains:null}};let n=e=>{let t=[],r=e.replace(/\[([^\]]+)\]/g,(e,r)=>(t.push(r),"([^.]+)")).replace(/\./g,"\\.");return{regex:RegExp(`^${r}$`),paramNames:t}}},86388,(e,t,r)=>{"use strict";async function n({handler:e,body:t,query:r,params:n,init:o,meta:a,resultFormatter:i,schema:s},l){if(!e.isRPC&&!e.fn)throw Error("Handler is not a valid RPC or controller method");try{let l;return e.isRPC&&(l=await e({handler:e,body:t,query:r,params:n,init:o,meta:a})),e.fn&&(l=await e.fn({body:t,query:r,params:n,meta:a})),[i(l,s),null]}catch(e){return[i(e,s),e]}}async function o(e,t){let r=t?.operationObject?.["x-tool-successMessage"]??"Tool executed successfully.",n=t?.operationObject?.["x-tool-errorMessage"]??"An error occurred while executing the tool.";return{content:[{type:"text",text:[e instanceof Error?n:r,t?.operationObject?.["x-tool-includeResponse"]??!0?`${e instanceof Error?"Error":"Result"}:
${JSON.stringify(e,null,2)}`:null].filter(Boolean).join("\n\n")}]}}async function a(e,t){return e}Object.defineProperty(r,"__esModule",{value:!0}),r.createLLMTools=function({modules:e,caller:t=n,meta:r,resultFormatter:i,onExecute:s=e=>e,onError:l=()=>{}}){let c=Object.entries(e??{}).map(([e,n])=>{let c,u,p;return Array.isArray(n)?[p,{init:c,apiRoot:u}]=n:p=n,Object.entries(p??{}).filter(([,e])=>e?.schema?.operationObject&&!e?.schema?.operationObject?.["x-tool-disable"]).map(([n])=>(({moduleName:e,handlerName:t,caller:r,module:n,init:o,apiRoot:a,meta:i,resultFormatter:s,onExecute:l,onError:c})=>{if(!n)throw Error(`Module "${e}" not found.`);let u=n[t];if(!u)throw Error(`Handler "${t}" not found in module "${e}".`);let{schema:p,models:d}=u;if(!p||!p.operationObject)throw Error(`Handler "${t}" in module "${e}" does not have a valid schema.`);let f=async(n,f)=>{let{body:m,query:h,params:E}=n,y={schema:p,models:d,handler:u,body:m,query:h,params:E,init:o,apiRoot:a,meta:i,handlerName:t,moduleName:e,resultFormatter:s},[O,g]=await r(y,f);return g?c?.(g,y,f):l(O,y,f),O},m={...p?.validation?.body?{body:p.validation.body}:{},...p?.validation?.query?{query:p.validation.query}:{},...p?.validation?.params?{params:p.validation.params}:{}};return{type:"function",execute:f,name:`${e}_${t}`,description:p.operationObject?.["x-tool-description"]??([p.operationObject?.summary??"",p.operationObject?.description??""].filter(Boolean).join("\n")||t),parameters:{type:"object",properties:m,required:Object.keys(m),additionalProperties:!1},models:d}})({moduleName:e,handlerName:n,caller:t,module:p,init:c,apiRoot:u,meta:r,resultFormatter:i?"mcp"===i?o:i:a,onExecute:s,onError:l}))}).flat(),u=Object.fromEntries(c.map(e=>[e.name,e]));return{tools:c,toolsByName:u}}},18125,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createValidateOnClient=function({validate:e}){return async function(t,r,n){let o={...t};return t.body&&r.body&&(o.body=await e(t.body,r.body,{...n,type:"body"})??t.body),t.query&&r.query&&(o.query=await e(t.query,r.query,{...n,type:"query"})??t.query),t.params&&r.params&&(o.params=await e(t.params,r.params,{...n,type:"params"})??t.params),o}}},17198,(e,t,r)=>{"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.initSegment=r.prefix=r.options=r.head=r.del=r.patch=r.put=r.post=r.get=r.resolveGeneratorConfigValues=r.vovkSchemaToOpenAPI=r.openAPIToVovkSchema=r.operation=r.progressive=r.createValidateOnClient=r.createCodeSamples=r.createLLMTools=r.multitenant=r.createStandardValidation=r.withValidationLibrary=r.generateStaticAPI=r.createFetcher=r.fetcher=r.createRPC=r.createDecorator=r.createVovkApp=r.HttpMethod=r.HttpStatus=r.HttpException=r.JSONLinesResponse=r.VovkSchemaIdEnum=void 0;let o=e.r(56823);Object.defineProperty(r,"createVovkApp",{enumerable:!0,get:function(){return o.createVovkApp}});let a=e.r(19863);Object.defineProperty(r,"HttpStatus",{enumerable:!0,get:function(){return a.HttpStatus}}),Object.defineProperty(r,"HttpMethod",{enumerable:!0,get:function(){return a.HttpMethod}}),Object.defineProperty(r,"VovkSchemaIdEnum",{enumerable:!0,get:function(){return a.VovkSchemaIdEnum}});let i=e.r(98446);Object.defineProperty(r,"createRPC",{enumerable:!0,get:function(){return i.createRPC}}),Object.defineProperty(r,"fetcher",{enumerable:!0,get:function(){return i.fetcher}}),Object.defineProperty(r,"createFetcher",{enumerable:!0,get:function(){return i.createFetcher}}),Object.defineProperty(r,"progressive",{enumerable:!0,get:function(){return i.progressive}});let s=e.r(3182);Object.defineProperty(r,"operation",{enumerable:!0,get:function(){return s.operation}}),Object.defineProperty(r,"openAPIToVovkSchema",{enumerable:!0,get:function(){return s.openAPIToVovkSchema}}),Object.defineProperty(r,"vovkSchemaToOpenAPI",{enumerable:!0,get:function(){return s.vovkSchemaToOpenAPI}});let l=e.r(22468);Object.defineProperty(r,"HttpException",{enumerable:!0,get:function(){return l.HttpException}});let c=e.r(21070);Object.defineProperty(r,"createDecorator",{enumerable:!0,get:function(){return c.createDecorator}});let u=e.r(44901);Object.defineProperty(r,"JSONLinesResponse",{enumerable:!0,get:function(){return u.JSONLinesResponse}});let p=e.r(95533);Object.defineProperty(r,"generateStaticAPI",{enumerable:!0,get:function(){return p.generateStaticAPI}});let d=e.r(88736);Object.defineProperty(r,"withValidationLibrary",{enumerable:!0,get:function(){return d.withValidationLibrary}});let f=e.r(47549);Object.defineProperty(r,"createStandardValidation",{enumerable:!0,get:function(){return f.createStandardValidation}});let m=e.r(69923);Object.defineProperty(r,"multitenant",{enumerable:!0,get:function(){return m.multitenant}});let h=e.r(86388);Object.defineProperty(r,"createLLMTools",{enumerable:!0,get:function(){return h.createLLMTools}});let E=e.r(78925);Object.defineProperty(r,"createCodeSamples",{enumerable:!0,get:function(){return E.createCodeSamples}});let y=e.r(18125);Object.defineProperty(r,"createValidateOnClient",{enumerable:!0,get:function(){return y.createValidateOnClient}});let O=e.r(35237);Object.defineProperty(r,"resolveGeneratorConfigValues",{enumerable:!0,get:function(){return O.resolveGeneratorConfigValues}}),r.get=(n=(0,o.createVovkApp)()).get,r.post=n.post,r.put=n.put,r.patch=n.patch,r.del=n.del,r.head=n.head,r.options=n.options,r.prefix=n.prefix,r.initSegment=n.initSegment}]);