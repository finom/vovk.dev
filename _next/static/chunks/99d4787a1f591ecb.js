(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19863,(e,t,r)=>{"use strict";var o,a,n,i,s,l;Object.defineProperty(r,"__esModule",{value:!0}),r.VovkSchemaIdEnum=r.HttpStatus=r.HttpMethod=void 0,(i=o||(r.HttpMethod=o={})).GET="GET",i.POST="POST",i.PUT="PUT",i.PATCH="PATCH",i.DELETE="DELETE",i.HEAD="HEAD",i.OPTIONS="OPTIONS",(s=a||(r.HttpStatus=a={}))[s.NULL=0]="NULL",s[s.CONTINUE=100]="CONTINUE",s[s.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",s[s.PROCESSING=102]="PROCESSING",s[s.EARLYHINTS=103]="EARLYHINTS",s[s.OK=200]="OK",s[s.CREATED=201]="CREATED",s[s.ACCEPTED=202]="ACCEPTED",s[s.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",s[s.NO_CONTENT=204]="NO_CONTENT",s[s.RESET_CONTENT=205]="RESET_CONTENT",s[s.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",s[s.AMBIGUOUS=300]="AMBIGUOUS",s[s.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",s[s.FOUND=302]="FOUND",s[s.SEE_OTHER=303]="SEE_OTHER",s[s.NOT_MODIFIED=304]="NOT_MODIFIED",s[s.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",s[s.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",s[s.BAD_REQUEST=400]="BAD_REQUEST",s[s.UNAUTHORIZED=401]="UNAUTHORIZED",s[s.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",s[s.FORBIDDEN=403]="FORBIDDEN",s[s.NOT_FOUND=404]="NOT_FOUND",s[s.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",s[s.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",s[s.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",s[s.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",s[s.CONFLICT=409]="CONFLICT",s[s.GONE=410]="GONE",s[s.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",s[s.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",s[s.PAYLOAD_TOO_LARGE=413]="PAYLOAD_TOO_LARGE",s[s.URI_TOO_LONG=414]="URI_TOO_LONG",s[s.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",s[s.REQUESTED_RANGE_NOT_SATISFIABLE=416]="REQUESTED_RANGE_NOT_SATISFIABLE",s[s.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",s[s.I_AM_A_TEAPOT=418]="I_AM_A_TEAPOT",s[s.MISDIRECTED=421]="MISDIRECTED",s[s.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",s[s.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",s[s.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",s[s.TOO_MANY_TRequestS=429]="TOO_MANY_TRequestS",s[s.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",s[s.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",s[s.BAD_GATEWAY=502]="BAD_GATEWAY",s[s.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",s[s.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",s[s.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",(l=n||(r.VovkSchemaIdEnum=n={})).META="https://vovk.dev/api/schema/v3/meta.json",l.CONFIG="https://vovk.dev/api/schema/v3/config.json",l.SEGMENT="https://vovk.dev/api/schema/v3/segment.json",l.SCHEMA="https://vovk.dev/api/schema/v3/schema.json"},41300,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.HttpException=void 0,r.HttpException=class extends Error{statusCode;message;cause;constructor(e,t,r){super(t),this.statusCode=e,this.message=t,this.cause=r}toJSON(){return{isError:!0,statusCode:this.statusCode,message:this.message,...this.cause?{cause:this.cause}:{}}}}},40700,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createDecorator=function(e,t){return function(...r){return function(o,a){let n=o[a];if("function"!=typeof n)throw Error(`Unable to decorate: ${a} is not a function`);let i=n._sourceMethod??n,s=function(t,a){let i=async()=>await n.call(o,t,a);return e?e.call(o,t,i,...r):i()};o[a]=s,s._controller=o,s._sourceMethod=i,s.fn=n.fn,s.definition=n.definition,i.wrapper=s,n._controller=o;let l=o._handlers?.[a]??null,c=t?.call(o,...r),u="function"==typeof c?c(l,{handlerName:a}):c,p={...l,...u?.validation?{validation:u.validation}:{},...u?.operationObject?{operationObject:u.operationObject}:{},...u?.misc?{misc:u.misc}:{}};s.schema=p,o._handlers={...o._handlers,[a]:p}}}}},16137,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.controllersToStaticParams=function(e,t="vovk"){return[{[t]:["_schema_"]},...Object.values(e).map(e=>{let r=e._handlers,o=e._prefix?.split("/")??[];return Object.entries(r??{}).map(([r,a])=>{let n=e._handlersMetadata?.[r]?.staticParams;return n?.length?n.map(e=>{let r=a.path;for(let[t,o]of Object.entries(e??{}))r=r.replace(`{${t}}`,o);return{[t]:[...o,...r.split("/")].filter(Boolean)}}):[{[t]:[...o,...a.path.split("/")].filter(Boolean)}]}).flat()}).flat()]}},31391,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.multitenant=function(e){let{requestUrl:t,requestHost:r,targetHost:a,overrides:n}=e,i=new URL(t),s=i.pathname.slice(1);if(s.endsWith("_schema_"))return{action:null,destination:null,message:"Schema endpoint, bypassing overrides",subdomains:null};let l=s.split("/").filter(Boolean),c=Object.keys(n).filter(e=>!e.includes("[")&&!e.includes("]"));for(let e=0;e<l.length;e++){let t=l[e];if(c.includes(t)){let r=`${t}.${a}`,o=[...l.slice(0,e),...l.slice(e+1)].join("/"),n=new URL(`${i.protocol}//${r}`);return o&&(n.pathname=`/${o}`),n.search=i.search,{action:"redirect",destination:n.toString(),message:`Redirecting to ${t} subdomain`,subdomains:null}}}for(let e in n){let{regex:t,paramNames:l}=o(`${e}.${a}`),c=r.match(t);if(c){let t=n[e],r={};if(c.length>1)for(let e=0;e<l.length;e++)r[l[e]]=c[e+1];for(let e of t)if(s===e.from||s.startsWith(`${e.from}/`)){let t=s.replace(e.from,e.to);Object.keys(r).length>0&&Object.entries(r).forEach(([e,r])=>{t=t.replace(`[${e}]`,r)});let o=l.length>0?r:null;return{action:"rewrite",destination:`${i.protocol}//${i.host}/${t}${i.search}`,message:`Rewriting to ${t}`,subdomains:o}}}}if(l.length>0&&c.includes(l[0])){let e=l[0],t=l.slice(1).join("/"),r=`${e}.${a}`,o=new URL(`${i.protocol}//${r}`);return t&&(o.pathname=`/${t}`),o.search=i.search,{action:"redirect",destination:o.toString(),message:`Redirecting to ${e} subdomain`,subdomains:null}}return{action:null,destination:null,message:"No action",subdomains:null}};let o=e=>{let t=[],r=e.replace(/\[([^\]]+)\]/g,(e,r)=>(t.push(r),"([^.]+)")).replace(/\./g,"\\.");return{regex:RegExp(`^${r}$`),paramNames:t}}},77742,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),"symbol"!=typeof Symbol.dispose&&Object.defineProperty(Symbol,"dispose",{configurable:!1,enumerable:!1,writable:!1,value:Symbol.for("dispose")}),"symbol"!=typeof Symbol.asyncDispose&&Object.defineProperty(Symbol,"asyncDispose",{configurable:!1,enumerable:!1,writable:!1,value:Symbol.for("asyncDispose")})},29701,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.JSONLinesResponder=r.Responder=void 0,e.r(77742);class o{response}r.Responder=o,r.JSONLinesResponder=class extends o{isClosed=!1;i=0;controller;encoder;readableStream;headers;onBeforeSend=e=>e;constructor(e,t){let r;super();const o=new TextEncoder,a=new ReadableStream({cancel:()=>{this.isClosed=!0},start:e=>{r=e}}),n=e?.headers?.get("accept"),i={"content-type":n?.includes("application/jsonl")?"application/jsonl; charset=utf-8":"text/plain; charset=utf-8"};this.headers=i,this.readableStream=a,this.encoder=o,this.controller=r,this.response=t?.(this)??new Response(a,{headers:i}),e?.signal?.addEventListener("abort",this.close,{once:!0}),this.controller?.enqueue(o?.encode(""))}send=async e=>this.sendLineOrError(await this.onBeforeSend(e,this.i++));sendLineOrError=e=>{let{controller:t,encoder:r}=this;this.isClosed||t?.enqueue(r?.encode(JSON.stringify(e)+"\n"))};close=()=>{let{controller:e}=this;this.isClosed||(this.isClosed=!0,e?.close())};throw=e=>(this.sendLineOrError({isError:!0,reason:e instanceof Error?e.message:e}),this.close())}},62066,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toDownloadResponse=function(e,{filename:t,type:r,headers:o}={}){let a=e instanceof Blob||e instanceof ReadableStream?e:new Blob([e],{type:r??"application/octet-stream"}),n=t??(e instanceof File?e.name:void 0),i=r??(a instanceof Blob?a.type:void 0);return new Response(a,{headers:{...i?{"Content-Type":i}:{},...n?{"Content-Disposition":`attachment; filename="${n.replace(/[^\x20-\x7E]|"/g,"_")}"; filename*=UTF-8''${encodeURIComponent(n)}`}:{},...o}})}},15577,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.progressive=function(e,...t){let[r]=t,o={};return e(r).then(async e=>{for await(let t of e)for(let[e,r]of Object.entries(t))if(e in o)o[e].isSettled||(o[e].isSettled=!0,o[e].resolve(r));else{let{promise:t,resolve:a,reject:n}=Promise.withResolvers();o[e]={resolve:a,reject:n,promise:t,isSettled:!0},o[e].resolve(r)}return Object.keys(o).forEach(e=>{o[e].isSettled||(o[e].isSettled=!0,o[e].reject(Error(`The connection was closed without sending a value for "${e}"`)))}),e}).catch(e=>(Object.keys(o).forEach(t=>{o[t].isSettled||(o[t].isSettled=!0,o[t].reject(e))}),e)),new Proxy({},{get(e,t){if(t in o)return o[t].promise;let{promise:r,resolve:a,reject:n}=Promise.withResolvers();return o[t]={resolve:a,reject:n,promise:r,isSettled:!1},r},ownKeys:()=>{throw Error("Getting own keys is not possible as they are dynamically created")}})}},19147,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fetcher=r.DEFAULT_ERROR_MESSAGE=void 0,r.createFetcher=n;let o=e.r(19863),a=e.r(41300);function n({prepareRequestInit:e,transformResponse:t,onSuccess:i,onError:s}={}){return async({httpMethod:n,getURL:l,validate:c,defaultHandler:u,defaultStreamHandler:p,schema:d},f)=>{let E=null,h=null,m=null;try{let{meta:s,apiRoot:O,disableClientValidation:y,init:T,interpretAs:_}=f,{body:R,query:S,params:b}=f,N=l({apiRoot:O,params:b,query:S}),g=Array.from(new URL(N.startsWith("/")?`http://localhost${N}`:N).pathname.matchAll(/\{([^}]+)\}/g)).map(e=>e[1]);if(g.length)throw new a.HttpException(o.HttpStatus.NULL,`Unused params: ${g.join(", ")} in ${N}`,{body:R,query:S,params:b,endpoint:N});if(!y)try{({body:R,query:S,params:b}=await c(f,{endpoint:N})??{body:R,query:S,params:b})}catch(e){if(e instanceof a.HttpException)throw e;throw new a.HttpException(o.HttpStatus.NULL,e.message??r.DEFAULT_ERROR_MESSAGE,{body:R,query:S,params:b,endpoint:N})}m={method:n,...T,headers:{accept:"application/jsonl, application/json",...R instanceof FormData?{}:{"content-type":"application/json"},...s?{"x-meta":JSON.stringify(s)}:{},...T?.headers}},R instanceof FormData?m.body=R:R&&(m.body=JSON.stringify(R));let v=new AbortController;m.signal=v.signal,m=e?await e(m,f):m;try{E=await fetch(N,m)}catch(e){throw new a.HttpException(o.HttpStatus.NULL,(e?.message??r.DEFAULT_ERROR_MESSAGE)+" "+N,{body:R,query:S,params:b,endpoint:N})}let A=_??E.headers.get("content-type");return h=A?.startsWith("application/jsonl")?p({response:E,abortController:v}):A?.startsWith("application/json")?await u({response:E,schema:d}):E,h=t?await t(h,f,{response:E,init:m,schema:d}):h,await i?.(h,f,{response:E,init:m,schema:d}),[h,E]}catch(e){throw await s?.(e,f,{response:E,init:m,respData:h,schema:d}),e}}}r.DEFAULT_ERROR_MESSAGE="Unknown error at default fetcher",r.fetcher=n()},73593,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaultHandler=r.DEFAULT_ERROR_MESSAGE=void 0;let o=e.r(41300);r.DEFAULT_ERROR_MESSAGE="Unknown error at defaultHandler";let a=async({response:e,schema:t})=>{let a;try{a=await e.json()}catch(t){throw new o.HttpException(e.status,t?.message??r.DEFAULT_ERROR_MESSAGE)}if(!e.ok){let n=t.operationObject&&"x-errorMessageKey"in t.operationObject?t.operationObject["x-errorMessageKey"]:"message",i=a;throw new o.HttpException(e.status,n.split(".").reduce((e,t)=>e&&"object"==typeof e?e[t]:void 0,i)??r.DEFAULT_ERROR_MESSAGE,i?.cause??JSON.stringify(a))}return a};r.defaultHandler=a},7731,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaultStreamHandler=r.DEFAULT_ERROR_MESSAGE=void 0;let o=e.r(19863),a=e.r(41300);e.r(77742),r.DEFAULT_ERROR_MESSAGE="An unknown error at defaultStreamHandler",r.defaultStreamHandler=({response:e,abortController:t})=>{if(e.ok||e.json().then(t=>{throw new a.HttpException(e.status,t.message??r.DEFAULT_ERROR_MESSAGE)}).catch(t=>{throw new a.HttpException(e.status,t.message??r.DEFAULT_ERROR_MESSAGE,t)}),!e.body)throw new a.HttpException(o.HttpStatus.NULL,"Stream body is falsy. Check your controller code.");let n=e.body.getReader(),i=new Set,s=!1,l=[],c=!1,u=null,p=-1,d=!1,f=[],E=()=>{for(let e=f.length-1;e>=0;e--){let r=f[e];u&&r.index>=p?(f.splice(e,1),r.reject(u)):r.index<l.length?(f.splice(e,1),r.resolve({value:l[r.index],done:!1})):(c||t.signal.aborted&&s)&&(f.splice(e,1),r.resolve({value:void 0,done:!0}))}},h=async()=>{let e="",r=0;try{for(;;){let o,a;if(t.signal.aborted&&s)break;try{if({value:o,done:a}=await n.read(),a)break}catch(t){if(t?.name==="AbortError"&&s)break;let e=Error("JSONLines stream error. "+String(t));e.cause=t,p=l.length,u=e,E();return}let c="number"==typeof o?String.fromCharCode(o):new TextDecoder().decode(o);for(let o of(e+=c).split("\n").filter(Boolean)){let a;if(t.signal.aborted&&s)break;try{a=JSON.parse(o),e=e.slice(o.length+1)}catch{break}if(a){if(i.forEach(e=>{t.signal.aborted||e(a,r)}),r++,"isError"in a&&"reason"in a){let e=a.reason;t.abort(a.reason);let r="string"==typeof e?Error(e):e;p=l.length,u=r,E();return}t.signal.aborted||(l.push(a),E())}}if(t.signal.aborted&&s)break}}finally{c=!0,E()}},m=async()=>{let e=[];for await(let t of O())e.push(t);return e};async function*O(){d||(d=!0,h());let e=0;for(;;){if(u&&e>=p)throw u;if(t.signal.aborted&&s)return;if(e<l.length){yield l[e++];continue}if(c)return;if(u&&e>=p)throw u;let r=await new Promise((r,o)=>{u&&e>=p?o(u):t.signal.aborted&&s?r({value:void 0,done:!0}):e<l.length?r({value:l[e],done:!1}):c?r({value:void 0,done:!0}):f.push({index:e,resolve:r,reject:o})});if(r.done)return;e++,yield r.value}}return{status:e.status,asPromise:m,abortController:t,[Symbol.asyncIterator]:O,[Symbol.dispose]:()=>{s=!0,c=!0,E(),t.abort("Stream disposed"),n.cancel().catch(()=>{})},[Symbol.asyncDispose]:()=>{s=!0,c=!0,E(),t.abort("Stream async disposed"),n.cancel().catch(()=>{})},abortWithoutError:e=>{s=!0,c=!0,E(),t.abort(e),n.cancel().catch(()=>{})},onIterate:e=>t.signal.aborted?()=>{}:(i.add(e),()=>{i.delete(e)})}}},49931,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.serializeQuery=function(e){if(!e||"object"!=typeof e)return"";let t=[];for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){let o=e[r];t.push(...function e(t,r){return null==r?[]:"object"==typeof r?Array.isArray(r)?r.flatMap((r,o)=>e(`${t}[${o}]`,r)):Object.keys(r).flatMap(o=>e(`${t}[${o}]`,r[o])):[`${encodeURIComponent(t)}=${encodeURIComponent(String(r))}`]}(r,o))}return t.join("&")}},51893,(e,t,r)=>{"use strict";var o=e.i(67034);function a(e){return e instanceof o.Buffer||e instanceof Date||e instanceof RegExp}function n(e){if(e instanceof o.Buffer){let t=o.Buffer.alloc?o.Buffer.alloc(e.length):o.Buffer.from(e);return e.copy(t),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);throw Error("Unexpected situation")}function i(e){let t=[];return e.forEach((e,r)=>{"object"==typeof e&&null!==e?Array.isArray(e)?t[r]=i(e):a(e)?t[r]=n(e):t[r]=l({},e):t[r]=e}),t}function s(e,t){return"__proto__"===t?void 0:e[t]}function l(...e){if(e.length<1||"object"!=typeof e[0])return!1;if(e.length<2)return e[0];let t=e[0];return e.slice(1).forEach(e=>{"object"!=typeof e||null===e||Array.isArray(e)||Object.keys(e).forEach(r=>{let o=s(t,r),c=s(e,r);if(c!==t){if("object"!=typeof c||null===c){t[r]=c;return}if(Array.isArray(c)){t[r]=i(c);return}if(a(c)){t[r]=n(c);return}else if("object"!=typeof o||null===o||Array.isArray(o)){t[r]=l({},c);return}else{t[r]=l(o,c);return}}})}),t}Object.defineProperty(r,"__esModule",{value:!0}),r.deepExtend=l,r.deepCloneArray=i,r.isSpecificValue=a,r.cloneSpecificValue=n,r.safeGetProperty=s},4067,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createRPC=void 0;let o=e.r(19147),a=e.r(73593),n=e.r(7731),i=e.r(49931),s=e.r(51893),l=(e,t,r)=>{let o=e,a=r?(0,i.serializeQuery)(r):null;for(let[e,r]of Object.entries(t??{}))o=o.replace(`{${e}}`,r);return`${o}${a?`?${a}`:""}`};r.createRPC=(e,t,i,c,u)=>{let p=u?.segmentNameOverride??t,d=e.segments[t];if(!d)throw Error(`Unable to create RPC module. Segment schema is missing for segment "${t}".`);let f=e.segments[t]?.controllers[i],E={};f||(console.warn(`ðŸº Unable to create RPC module. Controller schema is missing for module "${i}" from segment "${t}". Assuming that schema is not ready yet and a segment is importing an uncompiled RPC module.`),f={rpcModuleName:i,prefix:"",handlers:{}});let h=(f.prefix??"").trim().replace(/^\/|\/$/g,""),m=f.forceApiRoot??d.forceApiRoot,O=e.meta?.config?.rootEntry,y=m??u?.apiRoot??(O?`/${O}`:"/api");for(let[t,r]of Object.entries(f.handlers??{})){let{path:i,httpMethod:O,validation:T}=r,_=({apiRoot:e,params:t,query:r}={})=>[(e=e??y).startsWith("http://")||e.startsWith("https://")||e.startsWith("/")?"":"/",e,m?"":p,l([h,i].filter(Boolean).join("/"),t,r)].filter(Boolean).join("/").replace(/([^:])\/+/g,"$1/"),R=async(i={})=>{let l=u?.validateOnClient instanceof Promise?(await u?.validateOnClient)?.validateOnClient:u?.validateOnClient,p=c instanceof Promise?(await c).fetcher:c??o.fetcher,d={name:t,httpMethod:O,getURL:_,validate:async(t,{endpoint:r})=>{let o=i.validateOnClient??l;if(o&&T){if("function"!=typeof o)throw Error("validateOnClient must be a function");return await o({...t},T,{fullSchema:e,endpoint:r})??t}return t},defaultHandler:a.defaultHandler,defaultStreamHandler:n.defaultStreamHandler,schema:r},f={...(0,s.deepExtend)({},u,{validateOnClient:l},i),body:i.body??null,query:i.query??{},params:i.params??{}};if(!p)throw Error("Fetcher is not provided");let[E,h]=await p(d,f);return i.transform?i.transform(E,h):E};R.schema=r,R.controllerSchema=f,R.segmentSchema=d,R.fullSchema=e,R.isRPC=!0,R.apiRoot=y,R.getURL=_,R.queryKey=e=>[R.segmentSchema.segmentName,R.controllerSchema.prefix??"",R.controllerSchema.rpcModuleName,R.schema.path,R.schema.httpMethod,...e??[]],E[t]=R}return E.withDefaults=o=>(0,r.createRPC)(e,t,i,c,{...u,...o}),E}},94007,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseQuery=function(e){let t={};if(!e)return t;for(let r of e.replace(/^\?/,"").split("&")){let[e,o=""]=r.split("="),a=decodeURIComponent(e),n=decodeURIComponent(o);!function(e,t,r){let o=e;for(let e=0;e<t.length;e++){let a=t[e];if(e===t.length-1)if(""===a)Array.isArray(o)||(o=[]),o.push(r);else if(isNaN(Number(a)))o[a]=r;else{let e=Number(a);Array.isArray(o)||(o=[]),o[e]=r}else{let r=t[e+1];if(""===a)Array.isArray(o)||(o=[]),0===o.length?o.push("string"!=typeof r||isNaN(Number(r))?{}:[]):"string"!=typeof r||isNaN(Number(r))?"object"!=typeof o[o.length-1]&&(o[o.length-1]={}):Array.isArray(o[o.length-1])||(o[o.length-1]=[]),o=o[o.length-1];else if(isNaN(Number(a)))void 0===o[a]&&(o[a]="string"!=typeof r||isNaN(Number(r))?{}:[]),o=o[a];else{let e=Number(a);Array.isArray(o)||(o=[]),void 0===o[e]&&(o[e]="string"!=typeof r||isNaN(Number(r))?{}:[]),o=o[e]}}}}(t,function(e){let t,r=[],o=e.match(/^([^[\]]+)/);o?r.push(o[1]):r.push("");let a=/\[([^[\]]*)\]/g;for(;null!==(t=a.exec(e));)r.push(t[1]);return r}(a),n)}return t}},4110,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.reqQuery=function(e){return(0,o.parseQuery)(e.nextUrl.search)};let o=e.r(94007)},86037,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.reqMeta=function(e,t){return t?o.set(e,{...o.get(e),...t}):null===t&&o.delete(e),o.get(e)??{}};let o=new WeakMap},81051,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.reqForm=a;let o=new WeakMap;async function a(e){if(o.has(e))return o.get(e);let t=await e.formData();e.formData=()=>Promise.resolve(t);let r={};for(let[e,o]of t.entries())o instanceof File?r[e]?Array.isArray(r[e])?r[e].push(o):r[e]=[r[e],o]:r[e]=o:r[e]=o.toString();return o.set(e,r),r}},36013,(e,t,r)=>{"use strict";var o;Object.defineProperty(r,"__esModule",{value:!0}),r.vovkApp=void 0;let a=e.r(19863),n=e.r(41300),i=e.r(29701),s=e.r(4110),l=e.r(86037),c=e.r(81051);class u{static getHeadersFromDecoratorOptions(e){return e?{...e.cors?{"access-control-allow-origin":"*","access-control-allow-methods":"GET, POST, PUT, DELETE, OPTIONS, HEAD","access-control-allow-headers":"content-type, authorization"}:{},...e.headers??{}}:{}}routes={GET:new Map,POST:new Map,PUT:new Map,PATCH:new Map,DELETE:new Map,HEAD:new Map,OPTIONS:new Map};GET=async(e,t,r)=>this.#e({httpMethod:a.HttpMethod.GET,req:e,params:await t.params,segmentName:r});POST=async(e,t,r)=>this.#e({httpMethod:a.HttpMethod.POST,req:e,params:await t.params,segmentName:r});PUT=async(e,t,r)=>this.#e({httpMethod:a.HttpMethod.PUT,req:e,params:await t.params,segmentName:r});PATCH=async(e,t,r)=>this.#e({httpMethod:a.HttpMethod.PATCH,req:e,params:await t.params,segmentName:r});DELETE=async(e,t,r)=>this.#e({httpMethod:a.HttpMethod.DELETE,req:e,params:await t.params,segmentName:r});HEAD=async(e,t,r)=>this.#e({httpMethod:a.HttpMethod.HEAD,req:e,params:await t.params,segmentName:r});OPTIONS=async(e,t,r)=>this.#e({httpMethod:a.HttpMethod.OPTIONS,req:e,params:await t.params,segmentName:r});respond=async({statusCode:e,responseBody:t,options:r})=>new Response(JSON.stringify(t),{status:e,headers:{"content-type":"application/json",...o.getHeadersFromDecoratorOptions(r)}});#t=({req:e,statusCode:t,message:r,options:o,cause:a})=>this.respond({req:e,statusCode:t,responseBody:{cause:a,statusCode:t,message:r,isError:!0},options:o});#r=new Map;#o=new Map;#a=new Map;#n=new Map;#i=({handlers:e,path:t,params:r})=>{let o={};if(0===Object.keys(r).length)return{handler:e[""],methodParams:o};let i=t.join("/"),s=this.#n.get(i);if(s)return{handler:e[s.route],methodParams:s.params};let l=e[i]?i:null;if(!l){let r=[],s=t.length,c=new Map;for(let t of Object.keys(e)){let e=this.#o.get(t);if(!e&&(e=t.split("/"),this.#o.set(t,e),t.includes("{"))){let r=[];for(let t=0;t<e.length;t++){let o=e[t];if(o.includes("{")){let e=o.match(/\{(\w+)\}/);e&&r.push({index:t,paramName:e[1]})}}this.#a.set(t,r)}let r=e.length;if(r!==s)continue;let o=c.get(r)||[];o.push(t),c.set(r,o)}for(let e of c.get(s)||[]){let i=this.#o.get(e),s={},l=this.#a.get(e);if(l){let c=!0;for(let e=0;e<i.length;e++){let r=i[e];if(!r.includes("{")&&r!==t[e]){c=!1;break}}if(!c)continue;for(let{index:r,paramName:o}of l){let l=i[r],u=t[r],p=this.#r.get(l);if(!p){let e=l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\\{(\w+)\\}/g,"(?<$1>[^/]+)");p=RegExp(`^${e}$`),this.#r.set(l,p)}let d=u.match(p)?.groups;if(!d){c=!1;break}if(o in s)throw new n.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,`Duplicate parameter "${o}" at ${e}`);s[o]=d[o]}c&&(o=s,r.push(e))}else{let o=!0;for(let e=0;e<i.length;e++)if(i[e]!==t[e]){o=!1;break}o&&r.push(e)}}if(r.length>1)throw new n.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,`Conflicting routes found: ${r.join(", ")}`);[l]=r,l&&this.#n.set(i,{route:l,params:o})}return l?{handler:e[l],methodParams:o}:{handler:null,methodParams:o}};#s={};#l=(e,t)=>{let r=this.routes[e],o={};return r.forEach((e,r)=>{if(t!==r._segmentName)return;let a=r._prefix??"";Object.entries(e??{}).forEach(([e,t])=>{o[[a,e].filter(Boolean).join("/")]={staticMethod:t,controller:r}})}),o};#e=async({httpMethod:e,req:t,params:r,segmentName:n})=>{let u,p=r[Object.keys(r)[0]]??[],d=this.#s[n]?.[e]??this.#l(e,n);this.#s[n]??={},this.#s[n][e]=d;try{u=t.headers}catch{u=null}let f=u?.get("x-meta"),E=f&&JSON.parse(f);E&&(0,l.reqMeta)(t,{xMetaHeader:E});let{handler:h,methodParams:m}=this.#i({handlers:d,path:p,params:r});if(!h)return this.#t({req:t,statusCode:a.HttpStatus.NOT_FOUND,message:`Route '${p.join("/")}' is not found for ${e} method at ${""===n?"the root segment":`segment '${n}'`}`});let{staticMethod:O,controller:y}=h,T=o.getHeadersFromDecoratorOptions(O._options),{_onSuccess:_,_onBefore:R}=y;t.vovk={body:()=>t.json(),query:()=>(0,s.reqQuery)(t),meta:e=>(0,l.reqMeta)(t,e),form:()=>(0,c.reqForm)(t),params:()=>m};try{await O._options?.before?.call(y,t),await R?.(t);let e=await O.call(y,t,m);if(e instanceof Response){for(let[r,o]of(await _?.(e,t),Object.entries(T)))e.headers.has(r)||e.headers.set(r,o);return e}if(e instanceof i.Responder){for(let[r,o]of(await _?.(e,t),Object.entries(T)))e.response.headers.has(r)||e.response.headers.set(r,o);return e.response}if("object"==typeof e&&e&&!(e instanceof Array)&&(Reflect.has(e,Symbol.iterator)&&"function"==typeof e[Symbol.iterator]||Reflect.has(e,Symbol.asyncIterator)&&"function"==typeof e[Symbol.asyncIterator])){let r=new i.JSONLinesResponder(t,({headers:e,readableStream:t})=>new Response(t,{headers:{...T,...e}}));return(async()=>{try{for await(let t of e)await r.send(t)}catch(e){return r.throw(e)}return r.close()})(),await _?.(r,t),r.response}let r=e??null;return await _?.(r,t),this.respond({req:t,statusCode:200,responseBody:r,options:O._options})}catch(e){try{await y._onError?.(e,t)}catch(e){console.error("An error caught in onError handler:",e)}if("NEXT_REDIRECT"!==e.message&&"NEXT_NOT_FOUND"!==e.message){let r=e.statusCode||a.HttpStatus.INTERNAL_SERVER_ERROR;return this.#t({req:t,statusCode:r,message:e.message,options:O._options,cause:e.cause})}throw e}}}o=u,r.vovkApp=new u},57452,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.trimPath=void 0,r.trimPath=e=>e.trim().replace(/^\/|\/$/g,"")},45706,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getControllerSchema=a,r.getSchema=n;let o=e.r(19863);async function a(e,t,r){let o=r?e._handlers??{}:Object.fromEntries(Object.entries(e._handlers??{}).map(([e,{validation:t,...r}])=>[e,r]));return{rpcModuleName:t,originalControllerName:e.name,prefix:e._prefix??"",handlers:o}}async function n(e){let t=e?.exposeValidation??!0,r=e.emitSchema??!0,n={$schema:o.VovkSchemaIdEnum.SEGMENT,emitSchema:r,segmentName:e.segmentName??"",segmentType:"segment",controllers:{}};if(!r)return n;for(let[r,o]of Object.entries(e.controllers??{}))n.controllers[r]=await a(o,r,t);return n}},55863,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.initSegment=void 0;let o=e.r(36013),a=e.r(57452);e.r(45706),r.initSegment=e=>{let t=(0,a.trimPath)(e.segmentName??"");for(let[r,o]of(e.segmentName=t,Object.entries(e.controllers??{})))o._segmentName=t,o._rpcModuleName=r,o._onError=e?.onError,o._onSuccess=e?.onSuccess,o._onBefore=e?.onBefore;return{GET:(e,r)=>o.vovkApp.GET(e,r,t),POST:(e,r)=>o.vovkApp.POST(e,r,t),PUT:(e,r)=>o.vovkApp.PUT(e,r,t),PATCH:(e,r)=>o.vovkApp.PATCH(e,r,t),DELETE:(e,r)=>o.vovkApp.DELETE(e,r,t),HEAD:(e,r)=>o.vovkApp.HEAD(e,r,t),OPTIONS:(e,r)=>o.vovkApp.OPTIONS(e,r,t)}}},83488,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toKebabCase=void 0,r.toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase().replace(/^-/,"")},867,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.options=r.head=r.del=r.patch=r.put=r.post=r.get=r.prefix=void 0,r.cloneControllerMetadata=function(){return function(e){let t=Object.getPrototypeOf(e);return e._handlers={...t._handlers,...e._handlers},e._handlersMetadata={...t._handlersMetadata,...e._handlersMetadata},Object.values(o.vovkApp.routes).forEach(r=>{let o=r.get(t)??{};r.set(e,{...o,...r.get(e)})}),e}};let o=e.r(36013),a=e.r(19863),n=e.r(57452),i=e.r(83488),s=({controller:e,propertyKey:t,path:r,options:a,httpMethod:n})=>{if("undefined"!=typeof window)throw Error("HTTP decorators can be used on server-side only. You have probably imported a controller on the client-side.");if(!("function"==typeof e&&/class/.test(e.toString()))){let e=n.toLowerCase();throw"delete"===e&&(e="del"),Error(`Decorator must be used on a static class method. Check the controller method named "${t}" used with @${e}().`)}let i=o.vovkApp.routes[n].get(e)??{};if(o.vovkApp.routes[n].set(e,i),a?.cors){let t=o.vovkApp.routes.OPTIONS.get(e)??{};t[r]=()=>{},t[r]._options=a,o.vovkApp.routes.OPTIONS.set(e,t)}let s=e[t];s._controller=e,s._sourceMethod=s._sourceMethod??s;let l=s._sourceMethod._getSchema?.(e);s.schema=l,s.fn=s._sourceMethod?.fn,s.definition=s._sourceMethod?.definition,s._sourceMethod.wrapper=s,e._handlers={...e._handlers,[t]:{...l,...(e._handlers??{})[t],path:r,httpMethod:n}},i[r]=s,i[r]._options=a,e._handlersMetadata={...e._handlersMetadata,[t]:{...(e._handlersMetadata??{})[t],staticParams:a?.staticParams}}};function l(e){let t=function(t="",r){let o=(0,n.trimPath)(t);return function(t,a){s({controller:t,propertyKey:a,path:o,options:r,httpMethod:e})}};return t.auto=t=>function(r,o){let a=Object.keys((r._handlers??{})[o]?.validation?.params?.properties??{}),n=(0,i.toKebabCase)(o);s({controller:r,propertyKey:o,path:a.length?`${n}/${a.map(e=>`{${e}}`).join("/")}`:n,options:t,httpMethod:e})},t}r.prefix=(e="")=>{let t=(0,n.trimPath)(e);return e=>(e._prefix=t,e)},r.get=l(a.HttpMethod.GET),r.post=l(a.HttpMethod.POST),r.put=l(a.HttpMethod.PUT),r.patch=l(a.HttpMethod.PATCH),r.del=l(a.HttpMethod.DELETE),r.head=l(a.HttpMethod.HEAD),r.options=l(a.HttpMethod.OPTIONS)},98876,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.error=void 0;let o=e.r(19863),a=e.r(40700),n={[o.HttpStatus.NULL]:"Error",[o.HttpStatus.CONTINUE]:"Continue",[o.HttpStatus.SWITCHING_PROTOCOLS]:"Switching Protocols",[o.HttpStatus.PROCESSING]:"Processing",[o.HttpStatus.EARLYHINTS]:"Early Hints",[o.HttpStatus.OK]:"OK",[o.HttpStatus.CREATED]:"Created",[o.HttpStatus.ACCEPTED]:"Accepted",[o.HttpStatus.NON_AUTHORITATIVE_INFORMATION]:"Non Authoritative Information",[o.HttpStatus.NO_CONTENT]:"No Content",[o.HttpStatus.RESET_CONTENT]:"Reset Content",[o.HttpStatus.PARTIAL_CONTENT]:"Partial Content",[o.HttpStatus.AMBIGUOUS]:"Ambiguous",[o.HttpStatus.MOVED_PERMANENTLY]:"Moved Permanently",[o.HttpStatus.FOUND]:"Found",[o.HttpStatus.SEE_OTHER]:"See Other",[o.HttpStatus.NOT_MODIFIED]:"Not Modified",[o.HttpStatus.TEMPORARY_REDIRECT]:"Temporary Redirect",[o.HttpStatus.PERMANENT_REDIRECT]:"Permanent Redirect",[o.HttpStatus.BAD_REQUEST]:"Bad Request",[o.HttpStatus.UNAUTHORIZED]:"Unauthorized",[o.HttpStatus.PAYMENT_REQUIRED]:"Payment Required",[o.HttpStatus.FORBIDDEN]:"Forbidden",[o.HttpStatus.NOT_FOUND]:"Not Found",[o.HttpStatus.METHOD_NOT_ALLOWED]:"Method Not Allowed",[o.HttpStatus.NOT_ACCEPTABLE]:"Not Acceptable",[o.HttpStatus.PROXY_AUTHENTICATION_REQUIRED]:"Proxy Authentication Required",[o.HttpStatus.REQUEST_TIMEOUT]:"Request Timeout",[o.HttpStatus.CONFLICT]:"Conflict",[o.HttpStatus.GONE]:"Gone",[o.HttpStatus.LENGTH_REQUIRED]:"Length Required",[o.HttpStatus.PRECONDITION_FAILED]:"Precondition Failed",[o.HttpStatus.PAYLOAD_TOO_LARGE]:"Payload Too Large",[o.HttpStatus.URI_TOO_LONG]:"URI Too Long",[o.HttpStatus.UNSUPPORTED_MEDIA_TYPE]:"Unsupported Media Type",[o.HttpStatus.REQUESTED_RANGE_NOT_SATISFIABLE]:"Requested Range Not Satisfiable",[o.HttpStatus.EXPECTATION_FAILED]:"Expectation Failed",[o.HttpStatus.I_AM_A_TEAPOT]:"I am a teapot",[o.HttpStatus.MISDIRECTED]:"Misdirected",[o.HttpStatus.UNPROCESSABLE_ENTITY]:"Unprocessable Entity",[o.HttpStatus.FAILED_DEPENDENCY]:"Failed Dependency",[o.HttpStatus.PRECONDITION_REQUIRED]:"Precondition Required",[o.HttpStatus.TOO_MANY_TRequestS]:"Too Many Requests",[o.HttpStatus.INTERNAL_SERVER_ERROR]:"Internal Server Error",[o.HttpStatus.NOT_IMPLEMENTED]:"Not Implemented",[o.HttpStatus.BAD_GATEWAY]:"Bad Gateway",[o.HttpStatus.SERVICE_UNAVAILABLE]:"Service Unavailable",[o.HttpStatus.GATEWAY_TIMEOUT]:"Gateway Timeout",[o.HttpStatus.HTTP_VERSION_NOT_SUPPORTED]:"HTTP Version Not Supported"};r.error=(0,a.createDecorator)(null,(e,t)=>r=>({...r,operationObject:{...r?.operationObject,responses:{...r?.operationObject?.responses,[e]:{description:`${e} ${n[e]}`,content:{"application/json":{schema:{allOf:[{$ref:"#/components/schemas/VovkErrorResponse"},{type:"object",properties:{message:{type:"string",enum:[t,...r?.operationObject?.responses?.[e]?.content?.["application/json"]?.schema?.allOf?.[1]?.properties?.message?.enum??[]]},statusCode:{type:"integer",enum:[e]}}}]}}}}}}}))},59745,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.tool=void 0,r.tool=(0,e.r(40700).createDecorator)(null,e=>t=>({...t,operationObject:{...t?.operationObject,"x-tool":e}}))},98571,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.operation=r.operationDecorator=void 0;let o=e.r(40700),a=e.r(98876),n=e.r(59745);r.operationDecorator=(0,o.createDecorator)(null,(e={})=>t=>({...t,operationObject:{...t?.operationObject,...e}})),r.operation=Object.assign(r.operationDecorator,{error:a.error,tool:n.tool})},64323,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createValidateOnClient=function({validate:e}){return async function(t,r,o){let a={...t};return t.body&&r.body&&(a.body=await e(t.body,r.body,{...o,type:"body"})??t.body),t.query&&r.query&&(a.query=await e(t.query,r.query,{...o,type:"query"})??t.query),t.params&&r.params&&(a.params=await e(t.params,r.params,{...o,type:"params"})??t.params),a}}},81475,(e,t,r)=>{"use strict";async function o(e,t){e._getSchema=r=>{if(!r)throw Error("Error setting client validators. Controller not found. Did you forget to use an HTTP decorator?");if(!Object.getOwnPropertyNames(r).find(t=>r[t]._sourceMethod===e))throw Error("Error setting client validators. Handler not found.");return t}}Object.defineProperty(r,"__esModule",{value:!0}),r.setHandlerSchema=o},27752,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.withValidationLibrary=function({isForm:e,disableServerSideValidation:t,skipSchemaEmission:r,validateEachIteration:c,body:u,query:p,params:d,output:f,iteration:E,handle:h,toJSONSchema:m,validate:O,preferTransformed:y,operationObject:T}){y=y??!0;let _=!1===t?[]:!0===t?l:t??[],R=!1===r?[]:!0===r?l:r??[],S=async(e,t)=>{let{__disableClientValidation:r}=e.vovk.meta(),n=await h(e,t);if(r)return n;if(f&&E)throw new o.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,"Output and iteration are mutually exclusive. You can't use them together.");if(f&&!_.includes("output")){if(!n)throw new o.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,"Output is required. You probably forgot to return something from your handler.");let t=await O(n,f,{validationType:"output",req:e})??n;return y?t:n}if(E&&!_.includes("iteration")){if(!n||"function"!=typeof n[Symbol.asyncIterator]&&!(n instanceof s.JSONLinesResponder))throw new o.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,"Data is not an async iterable, neither JSONLinesResponder but iteration validation is defined.");return n instanceof s.JSONLinesResponder?(n.onBeforeSend=async(t,r)=>{let o;return o=c||0===r?await O(t,E,{validationType:"iteration",req:e,status:200,i:r})??t:t,r++,y?o:t},n):async function*(){let t=0;for await(let r of n){let o;o=c||0===t?await O(r,E,{validationType:"iteration",req:e,status:200,i:t})??r:r,t++,yield y?o:r}}()}if(c)throw new o.HttpException(a.HttpStatus.INTERNAL_SERVER_ERROR,"validateEachIteration is set but iteration is not defined.");return n},b=async(t,r)=>{let{__disableClientValidation:o}=t.vovk.meta();if(!o){if(u&&!_.includes("body")){let r=await t.vovk[e?"form":"body"](),o=await O(r,u,{validationType:e?"form":"body",req:t})??r,a=y?o:r;t.json=()=>Promise.resolve(r),t.vovk[e?"form":"body"]=()=>Promise.resolve(a)}if(p&&!_.includes("query")){let e=t.vovk.query(),r=await O(e,p,{validationType:"query",req:t})??e,o=y?r:e;t.vovk.query=()=>o}if(d&&!_.includes("params")){let e=t.vovk.params(),r=await O(e,d,{validationType:"params",req:t})??e,o=y?r:e;t.vovk.params=()=>o}}return S(t,r)},N={isForm:e,disableServerSideValidation:t,skipSchemaEmission:r,validateEachIteration:c,body:u,query:p,params:d,output:f,iteration:E,handle:h,toJSONSchema:m,validate:O,preferTransformed:y,operationObject:T},g=Object.assign(b,{fn:function(e){let t={vovk:{body:()=>Promise.resolve(e?.body??{}),query:()=>e?.query??{},params:()=>e?.params??{},meta:e=>(0,n.reqMeta)(t,e),form:()=>{throw Error("Form data is not supported in this context.")}}};t.vovk.meta({__disableClientValidation:e?.disableClientValidation,...e?.meta});let r=(b.wrapper??b)(t,e?.params??{});return e&&"transform"in e&&"function"==typeof e.transform?Promise.resolve(r).then(r=>e.transform(r,t)):r},definition:N});if(m){let t=(t,r)=>Object.assign(m(t,{validationType:r}),"body"===r&&e?{"x-isForm":e}:{}),r={};u&&!R.includes("body")&&(r.body=t(u,"body")),p&&!R.includes("query")&&(r.query=t(p,"query")),d&&!R.includes("params")&&(r.params=t(d,"params")),f&&!R.includes("output")&&(r.output=t(f,"output")),E&&!R.includes("iteration")&&(r.iteration=t(E,"iteration")),g.schema={validation:r,operationObject:T},(0,i.setHandlerSchema)(g,{validation:r,operationObject:T})}return g};let o=e.r(41300),a=e.r(19863),n=e.r(86037),i=e.r(81475),s=e.r(29701),l=["body","query","params","output","iteration"]},49028,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toModelOutputDefault=void 0,r.toModelOutputDefault=(e,t,r)=>e instanceof Error?{error:e.message}:e},59969,(e,t,r)=>{"use strict";var o=e.i(67034);Object.defineProperty(r,"__esModule",{value:!0}),r.toModelOutputMCP=void 0;let a=e.r(86037),n=e=>Array.isArray(e)?{items:e}:e,i=e=>void 0!==o.Buffer?o.Buffer.from(e).toString("base64"):btoa([...new Uint8Array(e)].map(e=>String.fromCharCode(e)).join(""));async function s(e){let t=e.headers.get("Content-Type")?.split(";")[0].trim()||"";if(t.startsWith("audio/"))return{content:[{type:"audio",mimeType:t,data:i(await e.arrayBuffer())}]};if(t.startsWith("image/"))return{content:[{type:"image",mimeType:t,data:i(await e.arrayBuffer())}]};if("application/json"===t){let t=await e.json();return{content:[{type:"text",text:JSON.stringify(t)}],structuredContent:n(t)}}return t.startsWith("text/")||/xml|javascript|yaml/.test(t)?{content:[{type:"text",text:await e.text()}]}:{content:[{type:"text",text:`Unsupported response content type ${t}`}],isError:!0}}r.toModelOutputMCP=async(e,t,r)=>{let o=r?(0,a.reqMeta)(r).mcpOutput:null;if(e instanceof Response)return{...await s(e),...o||{}};let i=e instanceof Error;return{content:[{type:"text",text:i?e.message:JSON.stringify(e)}],...i?{isError:!0}:{},...!i&&"object"==typeof e&&null!==e?{structuredContent:n(e)}:{},...o||{}}}},54923,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ToModelOutput=void 0;let o=e.r(49028),a=e.r(59969);r.ToModelOutput={DEFAULT:o.toModelOutputDefault,MCP:a.toModelOutputMCP}},81282,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createToolFactory=function({toJSONSchema:e}){return function({name:t,title:r,description:a,toModelOutput:n=o.ToModelOutput.DEFAULT,onExecute:i,onError:s,inputSchema:l,outputSchema:c,execute:u,target:p}){let d,f={type:"function",name:t,title:r,description:a,get parameters(){return d??=l?e(l,{validationType:"tool-input",target:p}):{}},inputSchema:l,outputSchema:c,inputSchemas:void 0,async execute(e,t){let r;try{let o;if(l){let t=await l["~standard"].validate(e);if(t.issues?.length)throw Error(`Input validation failed. ${t.issues.map(({message:e,path:t})=>`${e}${t?` at ${t.join(".")}`:""}`).join(", ")}`);o=t.value}else o=null;if(r=await u(o,t),c){let e=await c["~standard"].validate(r);if(e.issues?.length)throw Error(`Output validation failed. ${e.issues.map(({message:e,path:t})=>`${e}${t?` at ${t.join(".")}`:""}`).join(", ")}`);r=e.value}i?.(r,f)}catch(e){s?.(e,f),r=e}return r instanceof Error&&(r.toJSON=()=>({isError:!0,message:r.message})),n(r,f,null)}};return f}};let o=e.r(54923)},84640,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createStandardValidation=function({toJSONSchema:e}){return Object.assign(function({isForm:t,body:r,query:i,params:s,output:l,iteration:c,handle:u,disableServerSideValidation:p,skipSchemaEmission:d,validateEachIteration:f,preferTransformed:E,operationObject:h,target:m}){return(0,a.withValidationLibrary)({isForm:t,body:r,query:i,params:s,output:l,iteration:c,disableServerSideValidation:p,skipSchemaEmission:d,validateEachIteration:f,handle:u,toJSONSchema:(t,r)=>e(t,{validationType:r.validationType,target:m}),validate:async(e,t,{validationType:r,i:a})=>{let i=await t["~standard"].validate(e);if(i.issues?.length)throw new n.HttpException(o.HttpStatus.BAD_REQUEST,`Validation failed. Invalid ${"iteration"===r?`${r} #${a}`:r} on server: ${i.issues.map(({message:e,path:t})=>`${e}${t?` at ${t.join(".")}`:""}`).join(", ")}`,{issues:i.issues});return i.value},preferTransformed:E,operationObject:h})},{createTool:(0,i.createToolFactory)({toJSONSchema:e})})};let o=e.r(19863),a=e.r(27752),n=e.r(41300),i=e.r(81282)},26617,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.procedure=void 0,r.procedure=(0,e.r(84640).createStandardValidation)({toJSONSchema:(e,t)=>e["~standard"]?.jsonSchema?.input({target:t.target??"draft-2020-12"})??{}})},65729,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createTool=void 0,r.createTool=e.r(26617).procedure.createTool},49221,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deriveTools=function(e){let{modules:t,meta:r,toModelOutput:n=o.ToModelOutput.DEFAULT,onExecute:i=e=>e,onError:s=()=>{}}=e,l=Object.entries(t??{}).map(([e,t])=>Object.entries(t??{}).filter(([,e])=>e?.schema?.operationObject&&!e?.schema?.operationObject?.["x-tool"]?.hidden).map(([o])=>(({moduleName:e,handlerName:t,module:r,meta:o,toModelOutput:n,onExecute:i,onError:s})=>{if(!r)throw Error(`Module "${e}" not found.`);let l=r[t];if(!l)throw Error(`Handler "${t}" not found in module "${e}".`);let{schema:c,definition:u}=l,p=Object.fromEntries(["body","query","params"].map(e=>[e,u?.[e]]).filter(([,e])=>!!e));if(!c||!c.operationObject)throw Error(`Handler "${t}" in module "${e}" does not have a valid schema.`);let d=async r=>{let{body:u,query:d,params:f}=r,[h,m]=await a({schema:c,inputSchemas:p,handler:l,body:u,query:d,params:f,meta:o,handlerName:t,moduleName:e,toModelOutput:n},E);return h instanceof Error?s(h,E,m):i(h,E,m),h},f={...c?.validation?.body?{body:c.validation.body}:{},...c?.validation?.query?{query:c.validation.query}:{},...c?.validation?.params?{params:c.validation.params}:{}},E={type:"function",execute:d,name:c.operationObject?.["x-tool"]?.name??`${e}_${t}`,inputSchema:void 0,outputSchema:u?.output,title:c.operationObject?.["x-tool"]?.title??c.operationObject?.summary,description:c.operationObject?.["x-tool"]?.description??([c.operationObject?.summary??"",c.operationObject?.description??""].filter(Boolean).join("\n")||t),parameters:{type:"object",properties:f,required:Object.keys(f),additionalProperties:!1},inputSchemas:p};return E})({moduleName:e,handlerName:o,module:t,meta:r,toModelOutput:n,onExecute:i,onError:s}))).flat(),c=Object.fromEntries(l.map(e=>[e.name,e]));return{tools:l,toolsByName:c}};let o=e.r(54923);async function a({handler:e,handlerName:t,body:r,query:o,params:a,meta:n,toModelOutput:i},s){if(!e.isRPC&&!e.fn)throw Error("Handler is not a valid RPC or controller method");try{let l,c=null;if(e.isRPC)l=await e({handler:e,body:r,query:o,params:a,meta:n});else if(e.fn)[l,c]=await e.fn({body:r,query:o,params:a,meta:n,transform:(e,t)=>[e,t]});else throw Error(`Unable to call handler "${t}". It's neither RPC nor controller method with "fn" interface.`);return[await i(l,s,c),c]}catch(e){return[await i(e,s,null),null]}}},17198,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deriveTools=r.createTool=r.ToModelOutput=r.procedure=r.createValidateOnClient=r.operation=r.cloneControllerMetadata=r.prefix=r.options=r.head=r.del=r.patch=r.put=r.post=r.get=r.initSegment=r.createFetcher=r.fetcher=r.createRPC=r.progressive=r.toDownloadResponse=r.JSONLinesResponder=r.multitenant=r.controllersToStaticParams=r.createDecorator=r.HttpException=r.HttpMethod=r.HttpStatus=void 0;var o=e.r(19863);Object.defineProperty(r,"HttpStatus",{enumerable:!0,get:function(){return o.HttpStatus}}),Object.defineProperty(r,"HttpMethod",{enumerable:!0,get:function(){return o.HttpMethod}});var a=e.r(41300);Object.defineProperty(r,"HttpException",{enumerable:!0,get:function(){return a.HttpException}});var n=e.r(40700);Object.defineProperty(r,"createDecorator",{enumerable:!0,get:function(){return n.createDecorator}});var i=e.r(16137);Object.defineProperty(r,"controllersToStaticParams",{enumerable:!0,get:function(){return i.controllersToStaticParams}});var s=e.r(31391);Object.defineProperty(r,"multitenant",{enumerable:!0,get:function(){return s.multitenant}});var l=e.r(29701);Object.defineProperty(r,"JSONLinesResponder",{enumerable:!0,get:function(){return l.JSONLinesResponder}});var c=e.r(62066);Object.defineProperty(r,"toDownloadResponse",{enumerable:!0,get:function(){return c.toDownloadResponse}});var u=e.r(15577);Object.defineProperty(r,"progressive",{enumerable:!0,get:function(){return u.progressive}});var p=e.r(4067);Object.defineProperty(r,"createRPC",{enumerable:!0,get:function(){return p.createRPC}});var d=e.r(19147);Object.defineProperty(r,"fetcher",{enumerable:!0,get:function(){return d.fetcher}}),Object.defineProperty(r,"createFetcher",{enumerable:!0,get:function(){return d.createFetcher}});var f=e.r(55863);Object.defineProperty(r,"initSegment",{enumerable:!0,get:function(){return f.initSegment}});var E=e.r(867);Object.defineProperty(r,"get",{enumerable:!0,get:function(){return E.get}}),Object.defineProperty(r,"post",{enumerable:!0,get:function(){return E.post}}),Object.defineProperty(r,"put",{enumerable:!0,get:function(){return E.put}}),Object.defineProperty(r,"patch",{enumerable:!0,get:function(){return E.patch}}),Object.defineProperty(r,"del",{enumerable:!0,get:function(){return E.del}}),Object.defineProperty(r,"head",{enumerable:!0,get:function(){return E.head}}),Object.defineProperty(r,"options",{enumerable:!0,get:function(){return E.options}}),Object.defineProperty(r,"prefix",{enumerable:!0,get:function(){return E.prefix}}),Object.defineProperty(r,"cloneControllerMetadata",{enumerable:!0,get:function(){return E.cloneControllerMetadata}});var h=e.r(98571);Object.defineProperty(r,"operation",{enumerable:!0,get:function(){return h.operation}});var m=e.r(64323);Object.defineProperty(r,"createValidateOnClient",{enumerable:!0,get:function(){return m.createValidateOnClient}});var O=e.r(26617);Object.defineProperty(r,"procedure",{enumerable:!0,get:function(){return O.procedure}});var y=e.r(54923);Object.defineProperty(r,"ToModelOutput",{enumerable:!0,get:function(){return y.ToModelOutput}});var T=e.r(65729);Object.defineProperty(r,"createTool",{enumerable:!0,get:function(){return T.createTool}});var _=e.r(49221);Object.defineProperty(r,"deriveTools",{enumerable:!0,get:function(){return _.deriveTools}})}]);