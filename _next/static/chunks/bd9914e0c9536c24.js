(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19863,(e,t,r)=>{"use strict";var o,n,a,i,s,l;Object.defineProperty(r,"__esModule",{value:!0}),r.VovkSchemaIdEnum=r.HttpStatus=r.HttpMethod=void 0,(i=o||(r.HttpMethod=o={})).GET="GET",i.POST="POST",i.PUT="PUT",i.PATCH="PATCH",i.DELETE="DELETE",i.HEAD="HEAD",i.OPTIONS="OPTIONS",(s=n||(r.HttpStatus=n={}))[s.NULL=0]="NULL",s[s.CONTINUE=100]="CONTINUE",s[s.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",s[s.PROCESSING=102]="PROCESSING",s[s.EARLYHINTS=103]="EARLYHINTS",s[s.OK=200]="OK",s[s.CREATED=201]="CREATED",s[s.ACCEPTED=202]="ACCEPTED",s[s.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",s[s.NO_CONTENT=204]="NO_CONTENT",s[s.RESET_CONTENT=205]="RESET_CONTENT",s[s.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",s[s.AMBIGUOUS=300]="AMBIGUOUS",s[s.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",s[s.FOUND=302]="FOUND",s[s.SEE_OTHER=303]="SEE_OTHER",s[s.NOT_MODIFIED=304]="NOT_MODIFIED",s[s.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",s[s.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",s[s.BAD_REQUEST=400]="BAD_REQUEST",s[s.UNAUTHORIZED=401]="UNAUTHORIZED",s[s.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",s[s.FORBIDDEN=403]="FORBIDDEN",s[s.NOT_FOUND=404]="NOT_FOUND",s[s.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",s[s.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",s[s.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",s[s.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",s[s.CONFLICT=409]="CONFLICT",s[s.GONE=410]="GONE",s[s.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",s[s.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",s[s.PAYLOAD_TOO_LARGE=413]="PAYLOAD_TOO_LARGE",s[s.URI_TOO_LONG=414]="URI_TOO_LONG",s[s.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",s[s.REQUESTED_RANGE_NOT_SATISFIABLE=416]="REQUESTED_RANGE_NOT_SATISFIABLE",s[s.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",s[s.I_AM_A_TEAPOT=418]="I_AM_A_TEAPOT",s[s.MISDIRECTED=421]="MISDIRECTED",s[s.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",s[s.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",s[s.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",s[s.TOO_MANY_TRequestS=429]="TOO_MANY_TRequestS",s[s.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",s[s.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",s[s.BAD_GATEWAY=502]="BAD_GATEWAY",s[s.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",s[s.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",s[s.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",(l=a||(r.VovkSchemaIdEnum=a={})).META="https://vovk.dev/api/schema/v3/meta.json",l.CONFIG="https://vovk.dev/api/schema/v3/config.json",l.SEGMENT="https://vovk.dev/api/schema/v3/segment.json",l.SCHEMA="https://vovk.dev/api/schema/v3/schema.json"},22468,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.HttpException=void 0,r.HttpException=class extends Error{statusCode;message;cause;constructor(e,t,r){super(t),this.statusCode=e,this.message=t,this.cause=r}toJSON(){return{isError:!0,statusCode:this.statusCode,message:this.message,...this.cause?{cause:this.cause}:{}}}}},77742,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),"symbol"!=typeof Symbol.dispose&&Object.defineProperty(Symbol,"dispose",{configurable:!1,enumerable:!1,writable:!1,value:Symbol.for("dispose")}),"symbol"!=typeof Symbol.asyncDispose&&Object.defineProperty(Symbol,"asyncDispose",{configurable:!1,enumerable:!1,writable:!1,value:Symbol.for("asyncDispose")})},44901,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.JSONLinesResponse=void 0,e.r(77742);class o extends Response{isClosed=!1;controller;encoder;readableStream;iteratorQueue=[];iteratorResolvers=[];constructor(e,t){let r;const o=new TextEncoder,n=new ReadableStream({cancel:()=>{this.isClosed=!0},start:e=>{r=e}});super(n,{...t,headers:{"content-type":!e||e?.headers?.get("accept")?.includes("application/jsonl")?"application/jsonl; charset=utf-8":"text/plain; charset=utf-8",...t?.headers}}),this.readableStream=e?n:null,this.encoder=e?o:null,this.controller=e?r:null,e?.signal?.addEventListener("abort",this.close,{once:!0}),this.controller?.enqueue(o?.encode(""))}send=e=>{let{controller:t,encoder:r}=this;this.isClosed||(t?.enqueue(r?.encode(JSON.stringify(e)+"\n")),this.iteratorResolvers.length>0?this.iteratorResolvers.shift()({value:e,done:!1}):this.iteratorQueue.push(e))};close=()=>{let{controller:e}=this;if(!this.isClosed)for(this.isClosed=!0,e?.close();this.iteratorResolvers.length>0;)this.iteratorResolvers.shift()({done:!0,value:void 0})};throw=e=>(this.send({isError:!0,reason:e instanceof Error?e.message:e}),this.close());[Symbol.dispose]=()=>this.close();[Symbol.asyncDispose]=()=>this.close();[Symbol.asyncIterator]=()=>({next:async()=>this.iteratorQueue.length>0?{value:this.iteratorQueue.shift(),done:!1}:this.isClosed?{done:!0,value:void 0}:new Promise(e=>{this.iteratorResolvers.push(e)})})}r.JSONLinesResponse=o},94007,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseQuery=function(e){let t={};if(!e)return t;for(let r of e.replace(/^\?/,"").split("&")){let[e,o=""]=r.split("="),n=decodeURIComponent(e),a=decodeURIComponent(o);!function(e,t,r){let o=e;for(let e=0;e<t.length;e++){let n=t[e];if(e===t.length-1)if(""===n)Array.isArray(o)||(o=[]),o.push(r);else if(isNaN(Number(n)))o[n]=r;else{let e=Number(n);Array.isArray(o)||(o=[]),o[e]=r}else{let r=t[e+1];if(""===n)Array.isArray(o)||(o=[]),0===o.length?o.push("string"!=typeof r||isNaN(Number(r))?{}:[]):"string"!=typeof r||isNaN(Number(r))?"object"!=typeof o[o.length-1]&&(o[o.length-1]={}):Array.isArray(o[o.length-1])||(o[o.length-1]=[]),o=o[o.length-1];else if(isNaN(Number(n)))void 0===o[n]&&(o[n]="string"!=typeof r||isNaN(Number(r))?{}:[]),o=o[n];else{let e=Number(n);Array.isArray(o)||(o=[]),void 0===o[e]&&(o[e]="string"!=typeof r||isNaN(Number(r))?{}:[]),o=o[e]}}}}(t,function(e){let t,r=[],o=e.match(/^([^[\]]+)/);o?r.push(o[1]):r.push("");let n=/\[([^[\]]*)\]/g;for(;null!==(t=n.exec(e));)r.push(t[1]);return r}(n),a)}return t}},4110,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.reqQuery=function(e){return(0,o.parseQuery)(e.nextUrl.search)};let o=e.r(94007)},86037,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.reqMeta=function(e,t){return t?o.set(e,{...o.get(e),...t}):null===t&&o.delete(e),o.get(e)??{}};let o=new WeakMap},81051,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.reqForm=n;let o=new WeakMap;async function n(e){if(o.has(e))return o.get(e);let t=await e.formData();e.formData=()=>Promise.resolve(t);let r={};for(let[e,o]of t.entries())o instanceof File?r[e]?Array.isArray(r[e])?r[e].push(o):r[e]=[r[e],o]:r[e]=o:r[e]=o.toString();return o.set(e,r),r}},60078,(e,t,r)=>{"use strict";var o;Object.defineProperty(r,"__esModule",{value:!0}),r.VovkApp=void 0;let n=e.r(19863),a=e.r(22468),i=e.r(44901),s=e.r(4110),l=e.r(86037),c=e.r(81051);class u{static getHeadersFromOptions(e){return e?{...e.cors?{"access-control-allow-origin":"*","access-control-allow-methods":"GET, POST, PUT, DELETE, OPTIONS, HEAD","access-control-allow-headers":"content-type, authorization"}:{},...e.headers??{}}:{}}routes={GET:new Map,POST:new Map,PUT:new Map,PATCH:new Map,DELETE:new Map,HEAD:new Map,OPTIONS:new Map};GET=async(e,t)=>this.#e({httpMethod:n.HttpMethod.GET,req:e,params:await t.params});POST=async(e,t)=>this.#e({httpMethod:n.HttpMethod.POST,req:e,params:await t.params});PUT=async(e,t)=>this.#e({httpMethod:n.HttpMethod.PUT,req:e,params:await t.params});PATCH=async(e,t)=>this.#e({httpMethod:n.HttpMethod.PATCH,req:e,params:await t.params});DELETE=async(e,t)=>this.#e({httpMethod:n.HttpMethod.DELETE,req:e,params:await t.params});HEAD=async(e,t)=>this.#e({httpMethod:n.HttpMethod.HEAD,req:e,params:await t.params});OPTIONS=async(e,t)=>this.#e({httpMethod:n.HttpMethod.OPTIONS,req:e,params:await t.params});respond=async({statusCode:e,responseBody:t,options:r})=>new Response(JSON.stringify(t),{status:e,headers:{"content-type":"application/json",...o.getHeadersFromOptions(r)}});#t=({req:e,statusCode:t,message:r,options:o,cause:n})=>this.respond({req:e,statusCode:t,responseBody:{cause:n,statusCode:t,message:r,isError:!0},options:o});#r=new Map;#o=new Map;#n=new Map;#a=new Map;#i=({handlers:e,path:t,params:r})=>{let o={};if(0===Object.keys(r).length)return{handler:e[""],methodParams:o};let i=t.join("/"),s=this.#a.get(i);if(s)return{handler:e[s.route],methodParams:s.params};let l=e[i]?i:null;if(!l){let r=[],s=t.length,c=new Map;for(let t of Object.keys(e)){let e=this.#o.get(t);if(!e&&(e=t.split("/"),this.#o.set(t,e),t.includes("{"))){let r=[];for(let t=0;t<e.length;t++){let o=e[t];if(o.includes("{")){let e=o.match(/\{(\w+)\}/);e&&r.push({index:t,paramName:e[1]})}}this.#n.set(t,r)}let r=e.length;if(r!==s)continue;let o=c.get(r)||[];o.push(t),c.set(r,o)}for(let e of c.get(s)||[]){let i=this.#o.get(e),s={},l=this.#n.get(e);if(l){let c=!0;for(let e=0;e<i.length;e++){let r=i[e];if(!r.includes("{")&&r!==t[e]){c=!1;break}}if(!c)continue;for(let{index:r,paramName:o}of l){let l=i[r],u=t[r],p=this.#r.get(l);if(!p){let e=l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\\{(\w+)\\}/g,"(?<$1>[^/]+)");p=RegExp(`^${e}$`),this.#r.set(l,p)}let d=u.match(p)?.groups;if(!d){c=!1;break}if(o in s)throw new a.HttpException(n.HttpStatus.INTERNAL_SERVER_ERROR,`Duplicate parameter "${o}" at ${e}`);s[o]=d[o]}c&&(o=s,r.push(e))}else{let o=!0;for(let e=0;e<i.length;e++)if(i[e]!==t[e]){o=!1;break}o&&r.push(e)}}if(r.length>1)throw new a.HttpException(n.HttpStatus.INTERNAL_SERVER_ERROR,`Conflicting routes found: ${r.join(", ")}`);[l]=r,l&&this.#a.set(i,{route:l,params:o})}return l?{handler:e[l],methodParams:o}:{handler:null,methodParams:o}};#s={};#l=e=>{let t=this.routes[e],r={};return t.forEach((e,t)=>{let o=t._prefix??"";Object.entries(e??{}).forEach(([e,n])=>{r[[o,e].filter(Boolean).join("/")]={staticMethod:n,controller:t}})}),r};#e=async({httpMethod:e,req:t,params:r})=>{let a,u=r[Object.keys(r)[0]],p=this.#s[e]??this.#l(e);this.#s[e]=p;try{a=t.headers}catch{a=null}let d=a?.get("x-meta"),f=d&&JSON.parse(d);f&&(0,l.reqMeta)(t,{xMetaHeader:f});let{handler:m,methodParams:h}=this.#i({handlers:p,path:u,params:r});if(!m)return this.#t({req:t,statusCode:n.HttpStatus.NOT_FOUND,message:`Route ${u.join("/")} is not found`});let{staticMethod:E,controller:y}=m,{_onSuccess:O,_onBefore:b}=y;t.vovk={body:()=>t.json(),query:()=>(0,s.reqQuery)(t),meta:e=>(0,l.reqMeta)(t,e),form:()=>(0,c.reqForm)(t),params:()=>h};try{await E._options?.before?.call(y,t),await b?.(t);let e=await E.call(y,t,h);if(e instanceof Response)return await O?.(e,t),e;if("object"==typeof e&&e&&!(e instanceof Array)&&(Reflect.has(e,Symbol.iterator)&&"function"==typeof e[Symbol.iterator]||Reflect.has(e,Symbol.asyncIterator)&&"function"==typeof e[Symbol.asyncIterator])){let r=new i.JSONLinesResponse(t,{headers:{...o.getHeadersFromOptions(E._options)}});return(async()=>{try{for await(let t of e)r.send(t)}catch(e){return r.throw(e)}return r.close()})(),await O?.(r,t),r}let r=e??null;return await O?.(r,t),this.respond({req:t,statusCode:200,responseBody:r,options:E._options})}catch(e){try{await y._onError?.(e,t)}catch(e){console.error("An error caught in onError handler:",e)}if("NEXT_REDIRECT"!==e.message&&"NEXT_NOT_FOUND"!==e.message){let r=e.statusCode||n.HttpStatus.INTERNAL_SERVER_ERROR;return this.#t({req:t,statusCode:r,message:e.message,options:E._options,cause:e.cause})}throw e}}}r.VovkApp=u,o=u},45706,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getControllerSchema=n,r.getSchema=a;let o=e.r(19863);async function n(e,t,r){let o=r?e._handlers??{}:Object.fromEntries(Object.entries(e._handlers??{}).map(([e,{validation:t,...r}])=>[e,r]));return{rpcModuleName:t,originalControllerName:e.name,prefix:e._prefix??"",handlers:o}}async function a(e){let t=e?.exposeValidation??!0,r=e.emitSchema??!0,a={$schema:o.VovkSchemaIdEnum.SEGMENT,emitSchema:r,segmentName:e.segmentName??"",segmentType:"segment",controllers:{}};if(e.forceApiRoot&&(a.forceApiRoot=e.forceApiRoot),!r)return a;for(let[r,o]of Object.entries(e.controllers??{}))a.controllers[r]=await n(o,r,t);return a}},56823,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createVovkApp=function(){let e=new o.VovkApp;function t(t){let r=function(r="",o){let n=a(r);return function(r,a){i({controller:r,propertyKey:a,path:n,options:o,httpMethod:t,vovkApp:e})}};return r.auto=r=>function(o,n){let a=e.routes[t].get(o)??{};e.routes[t].set(o,a),o._handlers={...o._handlers,[n]:{...(o._handlers??{})[n],httpMethod:t}};let s=Object.keys(o._handlers[n]?.validation?.params?.properties??{}),l=n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase().replace(/^-/,"");i({controller:o,propertyKey:n,path:s.length?`${l}/${s.map(e=>`{${e}}`).join("/")}`:l,options:r,httpMethod:t,vovkApp:e})},r}return{get:t(n.HttpMethod.GET),post:t(n.HttpMethod.POST),put:t(n.HttpMethod.PUT),patch:t(n.HttpMethod.PATCH),del:t(n.HttpMethod.DELETE),head:t(n.HttpMethod.HEAD),options:t(n.HttpMethod.OPTIONS),prefix:(e="")=>{let t=a(e);return e=>(e._prefix=t,e)},initSegment:t=>{for(let[e,r]of(t.segmentName=a(t.segmentName??""),Object.entries(t.controllers??{})))r._rpcModuleName=e,r._onError=t?.onError,r._onSuccess=t?.onSuccess,r._onBefore=t?.onBefore;return{GET:e.GET,POST:e.POST,PUT:e.PUT,PATCH:e.PATCH,DELETE:e.DELETE,HEAD:e.HEAD,OPTIONS:e.OPTIONS}}}};let o=e.r(60078),n=e.r(19863);e.r(45706);let a=e=>e.trim().replace(/^\/|\/$/g,""),i=({controller:e,propertyKey:t,path:r,options:o,httpMethod:n,vovkApp:a})=>{if("undefined"!=typeof window)throw Error("HTTP decorators can be used on server-side only. You have probably imported a controller on the client-side.");if(!("function"==typeof e&&/class/.test(e.toString()))){let e=n.toLowerCase();throw"delete"===e&&(e="del"),Error(`Decorator must be used on a static class method. Check the controller method named "${t}" used with @${e}().`)}let i=a.routes[n].get(e)??{};if(a.routes[n].set(e,i),o?.cors){let t=a.routes.OPTIONS.get(e)??{};t[r]=()=>{},t[r]._options=o,a.routes.OPTIONS.set(e,t)}let s=e[t];s._controller=e,s._sourceMethod=s._sourceMethod??s;let l=s._sourceMethod._getSchema?.(e);s.schema=l,s.fn=s._sourceMethod?.fn,s.models=s._sourceMethod?.models,s._sourceMethod.wrapper=s,e._handlers={...e._handlers,[t]:{...l,...(e._handlers??{})[t],path:r,httpMethod:n}},i[r]=s,i[r]._options=o,e._handlersMetadata={...e._handlersMetadata,[t]:{...(e._handlersMetadata??{})[t],staticParams:o?.staticParams}}}},19147,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fetcher=r.DEFAULT_ERROR_MESSAGE=void 0,r.createFetcher=a;let o=e.r(19863),n=e.r(22468);function a({prepareRequestInit:e,transformResponse:t,onSuccess:i,onError:s}={}){return async({httpMethod:a,getURL:l,validate:c,defaultHandler:u,defaultStreamHandler:p,schema:d},f)=>{let m=null,h=null,E=null;try{let{meta:s,apiRoot:y,disableClientValidation:O,init:b,interpretAs:g}=f,{body:T,query:S,params:_}=f,v=l({apiRoot:y,params:_,query:S}),R=Array.from(new URL(v.startsWith("/")?`http://localhost${v}`:v).pathname.matchAll(/\{([^}]+)\}/g)).map(e=>e[1]);if(R.length)throw new n.HttpException(o.HttpStatus.NULL,`Unused params: ${R.join(", ")} in ${v}`,{body:T,query:S,params:_,endpoint:v});if(!O)try{({body:T,query:S,params:_}=await c(f,{endpoint:v})??{body:T,query:S,params:_})}catch(e){if(e instanceof n.HttpException)throw e;throw new n.HttpException(o.HttpStatus.NULL,e.message??r.DEFAULT_ERROR_MESSAGE,{body:T,query:S,params:_,endpoint:v})}E={method:a,...b,headers:{accept:"application/jsonl, application/json",...T instanceof FormData?{}:{"content-type":"application/json"},...s?{"x-meta":JSON.stringify(s)}:{},...b?.headers}},T instanceof FormData?E.body=T:T&&(E.body=JSON.stringify(T));let j=new AbortController;E.signal=j.signal,E=e?await e(E,f):E;try{m=await fetch(v,E)}catch(e){throw new n.HttpException(o.HttpStatus.NULL,(e?.message??r.DEFAULT_ERROR_MESSAGE)+" "+v,{body:T,query:S,params:_,endpoint:v})}let P=g??m.headers.get("content-type");return h=P?.startsWith("application/jsonl")?p({response:m,abortController:j,schema:d}):P?.startsWith("application/json")?await u({response:m,schema:d}):m,h=t?await t(h,f,{response:m,init:E,schema:d}):h,await i?.(h,f,{response:m,init:E,schema:d}),[h,m]}catch(e){throw await s?.(e,f,{response:m,init:E,respData:h,schema:d}),e}}}r.DEFAULT_ERROR_MESSAGE="Unknown error at default fetcher",r.fetcher=a()},73593,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaultHandler=r.DEFAULT_ERROR_MESSAGE=void 0;let o=e.r(22468);r.DEFAULT_ERROR_MESSAGE="Unknown error at defaultHandler";let n=async({response:e,schema:t})=>{let n;try{n=await e.json()}catch(t){throw new o.HttpException(e.status,t?.message??r.DEFAULT_ERROR_MESSAGE)}if(!e.ok){let a=t.operationObject&&"x-errorMessageKey"in t.operationObject?t.operationObject["x-errorMessageKey"]:"message",i=n;throw new o.HttpException(e.status,a.split(".").reduce((e,t)=>e&&"object"==typeof e?e[t]:void 0,i)??r.DEFAULT_ERROR_MESSAGE,i?.cause??JSON.stringify(n))}return n};r.defaultHandler=n},7731,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaultStreamHandler=r.DEFAULT_ERROR_MESSAGE=void 0;let o=e.r(19863),n=e.r(22468);e.r(77742),r.DEFAULT_ERROR_MESSAGE="An unknown error at defaultStreamHandler",r.defaultStreamHandler=({response:e,abortController:t})=>{if(e.ok||e.json().then(t=>{throw new n.HttpException(e.status,t.message??r.DEFAULT_ERROR_MESSAGE)}).catch(t=>{throw new n.HttpException(e.status,t.message??r.DEFAULT_ERROR_MESSAGE,t)}),!e.body)throw new n.HttpException(o.HttpStatus.NULL,"Stream body is falsy. Check your controller code.");let a=e.body.getReader(),i=new Set,s=!1;async function*l(){let e="",r=0;for(;;){let o;try{let e;if(t.signal.aborted||({value:o,done:e}=await a.read(),e))break}catch(t){if(t?.name==="AbortError"&&s)break;let e=Error("JSONLines stream error. "+String(t));throw e.cause=t,e}for(let n of(e+="number"==typeof o?String.fromCharCode(o):new TextDecoder().decode(o)).split("\n").filter(Boolean)){let o;try{o=JSON.parse(n),e=e.slice(n.length+1)}catch{break}if(o){if(i.forEach(e=>{t.signal.aborted||e(o,r)}),r++,"isError"in o&&"reason"in o){let e=o.reason;if(t.abort(o.reason),"string"==typeof e)throw Error(e);throw e}t.signal.aborted||(yield o)}}}}let c=async()=>{let e=[];for await(let t of l())e.push(t);return e};return{status:e.status,asPromise:c,abortController:t,[Symbol.asyncIterator]:l,[Symbol.dispose]:()=>{s=!0,t.abort("Stream disposed")},[Symbol.asyncDispose]:()=>{s=!0,t.abort("Stream async disposed")},abortWithoutError:e=>{s=!0,t.abort(e)},onIterate:e=>t.signal.aborted?()=>{}:(i.add(e),()=>{i.delete(e)})}}},49931,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.serializeQuery=function(e){if(!e||"object"!=typeof e)return"";let t=[];for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){let o=e[r];t.push(...function e(t,r){return null==r?[]:"object"==typeof r?Array.isArray(r)?r.flatMap((r,o)=>e(`${t}[${o}]`,r)):Object.keys(r).flatMap(o=>e(`${t}[${o}]`,r[o])):[`${encodeURIComponent(t)}=${encodeURIComponent(String(r))}`]}(r,o))}return t.join("&")}},51893,(e,t,r)=>{"use strict";var o=e.i(67034);function n(e){return e instanceof o.Buffer||e instanceof Date||e instanceof RegExp}function a(e){if(e instanceof o.Buffer){let t=o.Buffer.alloc?o.Buffer.alloc(e.length):o.Buffer.from(e);return e.copy(t),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);throw Error("Unexpected situation")}function i(e){let t=[];return e.forEach((e,r)=>{"object"==typeof e&&null!==e?Array.isArray(e)?t[r]=i(e):n(e)?t[r]=a(e):t[r]=l({},e):t[r]=e}),t}function s(e,t){return"__proto__"===t?void 0:e[t]}function l(...e){if(e.length<1||"object"!=typeof e[0])return!1;if(e.length<2)return e[0];let t=e[0];return e.slice(1).forEach(e=>{"object"!=typeof e||null===e||Array.isArray(e)||Object.keys(e).forEach(r=>{let o=s(t,r),c=s(e,r);if(c!==t){if("object"!=typeof c||null===c){t[r]=c;return}if(Array.isArray(c)){t[r]=i(c);return}if(n(c)){t[r]=a(c);return}else if("object"!=typeof o||null===o||Array.isArray(o)){t[r]=l({},c);return}else{t[r]=l(o,c);return}}})}),t}Object.defineProperty(r,"__esModule",{value:!0}),r.deepExtend=l,r.deepCloneArray=i,r.isSpecificValue=n,r.cloneSpecificValue=a,r.safeGetProperty=s},4067,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createRPC=void 0;let o=e.r(19147),n=e.r(73593),a=e.r(7731),i=e.r(49931),s=e.r(51893),l=(e,t,r)=>{let o=e,n=r?(0,i.serializeQuery)(r):null;for(let[e,r]of Object.entries(t??{}))o=o.replace(`{${e}}`,r);return`${o}${n?`?${n}`:""}`};r.createRPC=(e,t,i,c,u)=>{let p=u?.segmentNameOverride??t,d=e.segments[t];if(!d)throw Error(`Unable to create RPC module. Segment schema is missing for segment "${t}".`);let f=e.segments[t]?.controllers[i],m={};f||(console.warn(`ðŸº Unable to create RPC module. Controller schema is missing for module "${i}" from segment "${t}". Assuming that schema is not ready yet and a segment is importing an uncompiled RPC module.`),f={rpcModuleName:i,prefix:"",handlers:{}});let h=(f.prefix??"").trim().replace(/^\/|\/$/g,""),E=f.forceApiRoot??d.forceApiRoot,y=e.meta?.config?.rootEntry,O=E??u?.apiRoot??(y?`/${y}`:"/api");for(let[t,r]of Object.entries(f.handlers??{})){let{path:i,httpMethod:y,validation:b}=r,g=({apiRoot:e,params:t,query:r}={})=>[(e=e??O).startsWith("http://")||e.startsWith("https://")||e.startsWith("/")?"":"/",e,E?"":p,l([h,i].filter(Boolean).join("/"),t,r)].filter(Boolean).join("/").replace(/([^:])\/+/g,"$1/"),T=async(i={})=>{let l=u?.validateOnClient instanceof Promise?(await u?.validateOnClient)?.validateOnClient:u?.validateOnClient,p=c instanceof Promise?(await c).fetcher:c??o.fetcher,d={name:t,httpMethod:y,getURL:g,validate:async(t,{endpoint:r})=>{let o=i.validateOnClient??l;if(o&&b){if("function"!=typeof o)throw Error("validateOnClient must be a function");return await o({...t},b,{fullSchema:e,endpoint:r})??t}return t},defaultHandler:n.defaultHandler,defaultStreamHandler:a.defaultStreamHandler,schema:r},f={...(0,s.deepExtend)({},u,{validateOnClient:l},i),body:i.body??null,query:i.query??{},params:i.params??{}};if(!p)throw Error("Fetcher is not provided");let[m,h]=await p(d,f);return i.transform?i.transform(m,h):m};T.schema=r,T.controllerSchema=f,T.segmentSchema=d,T.fullSchema=e,T.isRPC=!0,T.apiRoot=O,T.getURL=g,T.queryKey=e=>[T.segmentSchema.segmentName,T.controllerSchema.prefix??"",T.controllerSchema.rpcModuleName,T.schema.path,T.schema.httpMethod,...e??[]],m[t]=T}return m.withDefaults=o=>(0,r.createRPC)(e,t,i,c,{...u,...o}),m}},15577,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.progressive=function(e,...t){let[r]=t,o={};return e(r).then(async e=>{for await(let t of e)for(let[e,r]of Object.entries(t))if(e in o)o[e].isSettled||(o[e].isSettled=!0,o[e].resolve(r));else{let{promise:t,resolve:n,reject:a}=Promise.withResolvers();o[e]={resolve:n,reject:a,promise:t,isSettled:!0},o[e].resolve(r)}return Object.keys(o).forEach(e=>{o[e].isSettled||(o[e].isSettled=!0,o[e].reject(Error(`The connection was closed without sending a value for "${e}"`)))}),e}).catch(e=>(Object.keys(o).forEach(t=>{o[t].isSettled||(o[t].isSettled=!0,o[t].reject(e))}),e)),new Proxy({},{get(e,t){if(t in o)return o[t].promise;let{promise:r,resolve:n,reject:a}=Promise.withResolvers();return o[t]={resolve:n,reject:a,promise:r,isSettled:!1},r},ownKeys:()=>{throw Error("Getting own keys is not possible as they are dynamically created")}})}},98446,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.progressive=r.createFetcher=r.fetcher=r.createRPC=void 0;var o=e.r(4067);Object.defineProperty(r,"createRPC",{enumerable:!0,get:function(){return o.createRPC}});var n=e.r(19147);Object.defineProperty(r,"fetcher",{enumerable:!0,get:function(){return n.fetcher}}),Object.defineProperty(r,"createFetcher",{enumerable:!0,get:function(){return n.createFetcher}});var a=e.r(15577);Object.defineProperty(r,"progressive",{enumerable:!0,get:function(){return a.progressive}})},15955,(e,t,r)=>{"use strict";function o(e,t,r){if(!e||"object"!=typeof e)return null;if(t=t||e,!r||"string"!==e.type||"binary"!==e.format){if(void 0!==e.example)return e.example;if(e.examples&&e.examples.length>0)return e.examples[0];if(void 0!==e.const)return e.const;if(e.$ref){return i=e.$ref,s=t,l=r,o(n(i,s),s,l)}if(e.enum&&e.enum.length>0)return e.enum[0];if(e.oneOf&&e.oneOf.length>0)return o(e.oneOf[0],t,r);if(e.anyOf&&e.anyOf.length>0)return o(e.anyOf[0],t,r);if(e.allOf&&e.allOf.length>0)return o(e.allOf.reduce((e,t)=>({...e,...t}),{}),t,r);if(e.type)switch(e.type){case"string":var i,s,l,c,u=e;if(u.format)switch(u.format){case"email":case"idn-email":return"user@example.com";case"uri":case"url":case"iri":return"https://example.com";case"date":return"2023-01-01";case"date-time":return"2023-01-01T00:00:00Z";case"time":return"12:00:00Z";case"duration":return"PT1H";case"uuid":return"00000000-0000-0000-0000-000000000000";case"regex":return"^[a-zA-Z0-9]+$";case"relative-json-pointer":return"/some/relative/path";case"color":return"#000000";case"hostname":return"example.com";case"zipcode":return"12345";case"phone":return"+123-456-7890";case"password":return"******";case"binary":return"binary-data";default:return"string"}return u.pattern?"pattern-string":"string";case"number":case"integer":return void 0!==(c=e).minimum&&void 0!==c.maximum||void 0!==c.minimum?c.minimum:void 0!==c.maximum?c.maximum:0;case"boolean":return!0;case"object":return a(e,t,r);case"array":var p=e,d=t,f=r;if(p.items){let e=p.items;if(f&&"string"===e.type&&"binary"===e.format)return;let t=Math.min(p.minItems||1,3),r=Array.from({length:t},()=>o(e,d,f)).filter(e=>void 0!==e);if(0===r.length&&t>0)return;return r}return[];default:return null}return e.properties?a(e,t,r):null}}function n(e,t){let r=e.split("/").slice(1),o=t;for(let e of r)if(void 0===(o=o[e]))return{};return o}function a(e,t,r){let n={};if(e.properties){let a=e.required||[];for(let[i,s]of Object.entries(e.properties))if(a.includes(i)||0===a.length){let e=o(s,t,r);void 0!==e&&(n[i]=e)}}if(e.additionalProperties&&"object"==typeof e.additionalProperties){let a=o(e.additionalProperties,t,r);void 0!==a&&(n.additionalProp=a)}return n}Object.defineProperty(r,"__esModule",{value:!0}),r.JSONSchemaToCode=function(e,t,r){let{comment:a="//",stripQuotes:i=!1,indent:s=0,nestingIndent:l=4,ignoreBinary:c=!1}=t;return e&&"object"==typeof e?(r=r||e,function e(t,r,o,a,i,s,l,c,u){let p=" ".repeat(s),d=" ".repeat(l);if(void 0===t)return"";if(null===t)return"null";if("object"!=typeof t||t instanceof Date)return JSON.stringify(t);if(Array.isArray(t)){if(0===t.length)return"[]";let n=t.map(t=>{let n=e(t,r.items||{},o,a,i,s+l,l,c,!1);return`${p}${d}${n}`});return`[
${n.join(",\n")}
${p}]`}if("object"==typeof t){let f=Object.entries(t);if(0===f.length)return"{}";let m=[];if(u&&"object"===r.type&&r.description){let e=r.description.split("\n");m.push(`${p}${d}${a} -----`),e.forEach(e=>{m.push(`${p}${d}${a} ${e.trim()}`)}),m.push(`${p}${d}${a} -----`)}return f.forEach(([t,u],h)=>{let E=r.properties?.[t]??{},y=E;E.$ref&&(y=n(E.$ref,o)),y.description&&y.description.split("\n").forEach(e=>{m.push(`${p}${d}${a} ${e.trim()}`)});let O=i&&/^[A-Za-z_$][0-9A-Za-z_$]*$/.test(t)?t:JSON.stringify(t),b=e(u,y,o,a,i,s+l,l,c,!1);m.push(`${p}${d}${O}: ${b}${h<f.length-1?",":""}`)}),`{
${m.join("\n")}
${p}}`}return JSON.stringify(t)}(o(e,r,c),e,r,a,i,s,l,c,!0)):"null"},r.getSampleValue=o},76516,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.objectToCode=function(e,t){let{stripQuotes:r=!1,indent:o=0,nestingIndent:n=2,quote:a='"'}=t||{},i=JSON.stringify(e,null,n);if("'"===a&&(i=i.replace(/"([^"]*)"/g,(e,t)=>{let r=i.indexOf(e);if(i.substring(r+e.length).startsWith(":"))return e;let o=t.replace(/'/g,"\\'");return`'${o}'`})),r){let e="'"===a?"'":'"',t=RegExp(`${e}([a-zA-Z_$][a-zA-Z0-9_$]*)${e}:`,"g");i=i.replace(t,"$1:")}if(o>0){let e=" ".repeat(o);i=i.split("\n").map((t,r)=>0===r?t:e+t).join("\n")}return i}},89792,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createCodeSamples=function({handlerName:e,handlerSchema:t,controllerSchema:r,package:s,config:l}){let c=t?.validation?.query,u=t?.validation?.body,p=t?.validation?.params,d=t?.validation?.output,f=t?.validation?.iteration,m=!!c||!!u||!!p||!!l?.apiRoot||!!l?.headers,h=r.rpcModuleName,E=s?.name||"vovk-client",y=a(E),O=s?.py_name??y,b=s?.rs_name??y,g={handlerName:e,rpcName:h,packageName:E,queryValidation:c,bodyValidation:u,paramsValidation:p,outputValidation:d,iterationValidation:f,hasArg:m,config:l},T=function({handlerName:e,rpcName:t,packageName:r,queryValidation:a,bodyValidation:s,paramsValidation:l,outputValidation:c,iterationValidation:u,hasArg:p,config:d}){let f=(e,t)=>(0,o.JSONSchemaToCode)(e,{stripQuotes:!0,indent:t??4}),m=(e,t,r)=>{let n;n="string"===e.type&&"binary"===e.format?`new Blob(${i(e.contentMediaType)?'["text_content"]':"[binary_data]"}${e.contentMediaType?`, { type: "${e.contentMediaType}" }`:""})`:"object"===e.type?'"object_unknown"':`"${(0,o.getSampleValue)(e)}"`;let a=e.description??r;return`
${a?`// ${a}
`:""}formData.append("${t}", ${n});`},h=p?`{
${[s?`    body: ${s["x-isForm"]?"formData":f(s)},`:null,a?`    query: ${f(a)},`:null,l?`    params: ${f(l)},`:null,d?.apiRoot?`    apiRoot: '${d.apiRoot}',`:null,d?.headers?`    init: {
      headers: ${(0,n.objectToCode)(d.headers,{stripQuotes:!0,indent:6,nestingIndent:4})}
    },`:null].filter(Boolean).join("\n")}
}`:"";return`import { ${t} } from '${r}';
${s?.["x-isForm"]?(e=>{let t="\nconst formData = new FormData();";for(let[r,o]of Object.entries(e.properties||{})){let e=o.oneOf?.[0]||o.anyOf?.[0]||o.allOf?.[0]||o,n=e.description??o.description??void 0;"array"===e.type&&e.items?(t+=m(e.items,r,n),t+=m(e.items,r,n)):t+=m(e,r,n)}return t})(s)+"\n":""}
${u?"using":"const"} response = await ${t}.${e}(${h});
${c?`
console.log(response); 
/* 
${f(c,0)}
*/`:""}${u?`
for await (const item of response) {
    console.log(item); 
    /*
    ${f(u)}
    */
}`:""}`.trim()}(g);return{ts:T,py:function({handlerName:e,rpcName:t,packageName:r,queryValidation:s,bodyValidation:l,paramsValidation:c,outputValidation:u,iterationValidation:p,hasArg:d,config:f}){let m=(e,t)=>(0,o.JSONSchemaToCode)(e,{stripQuotes:!1,indent:t??4,comment:"#",ignoreBinary:!0,nestingIndent:4}),h=a(e),E=e=>`('name.ext', BytesIO(${i(e.contentMediaType)?'"text_content".encode("utf-8")':"binary_data"})${e.contentMediaType?`, "${e.contentMediaType}"`:""})`,y=l?Object.entries(l.properties??{}).reduce((e,[t,r])=>{let o=r.oneOf?.[0]||r.anyOf?.[0]||r.allOf?.[0]||r,n=o.description??r.description??void 0;if("string"===o.type&&"binary"===o.format)e.push(`${n?`${" ".repeat(8)}# ${n}
`:""}${" ".repeat(8)}('${t}', ${E(o)})`);else if("array"===o.type&&o.items?.format==="binary"){let r=`${n?`${" ".repeat(8)}# ${n}
`:""}${" ".repeat(8)}('${t}', ${E(o.items)})`;e.push(r,r)}return e},[]):null,O=y?.length?`${" ".repeat(4)}files=[
${y.join(",\n")}
${" ".repeat(4)}],`:null;return`from ${r} import ${t}
${l?.["x-isForm"]?"from io import BytesIO\n":""}
response = ${t}.${h}(${d?"\n"+[l?`    body=${m(l)},`:null,O,s?`    query=${m(s)},`:null,c?`    params=${m(c)},`:null,f?.apiRoot?`    api_root="${f.apiRoot}",`:null,f?.headers?`    headers=${(0,n.objectToCode)(f.headers,{stripQuotes:!1,indent:4,nestingIndent:4})},`:null].filter(Boolean).join("\n")+"\n":""})

${u?`print(response)
${m(u,0)}`:""}${p?`for i, item in enumerate(response):
    print(f"iteration #{i}:\\n {item}")
    # iteration #0:
    ${m(p)}`:""}`.trim()}({...g,packageName:O}),rs:function({handlerName:e,rpcName:t,packageName:r,queryValidation:n,bodyValidation:s,paramsValidation:l,outputValidation:c,iterationValidation:u,config:p}){let d=(e,t)=>(0,o.JSONSchemaToCode)(e,{stripQuotes:!1,indent:t??4}),f=(e,t)=>(0,o.JSONSchemaToCode)(e,{stripQuotes:!0,indent:t??4}),m=(e,t,r)=>{let n;"string"===e.type&&"binary"===e.format?(n=i(e.contentMediaType)?'multipart::Part::text("text_content")':"multipart::Part::bytes(binary_data)",e.contentMediaType&&(n+=`.mime_str("${e.contentMediaType}").unwrap()`)):n="object"===e.type?'"object_unknown"':`"${(0,o.getSampleValue)(e)}"`;let a=e.description??r;return`
${" ".repeat(4)}${a?`// ${a}
`:""}${" ".repeat(4)}.part("${t}", ${n});`},h=a(e),E=a(t),y=e=>`from_value(json!(${e})).unwrap()`;return`use ${r}::${E};
use serde_json::{ 
  from_value, 
  json 
};
${s?.["x-isForm"]?`use multipart;
`:""}
pub fn main() {${s?.["x-isForm"]?"\n  "+(e=>{let t="let form = multipart::Form::new()";for(let[r,o]of Object.entries(e.properties||{})){let e=o.oneOf?.[0]||o.anyOf?.[0]||o.allOf?.[0]||o,n=e.description??o.description??void 0;"array"===e.type&&e.items?(t+=m(e.items,r,n),t+=m(e.items,r,n)):t+=m(e,r,n)}return t})(s)+"\n":""}
  let response = ${E}::${h}(
    ${s?s["x-isForm"]?"form":y(d(s)):"()"}, /* body */ 
    ${n?y(d(n)):"()"}, /* query */ 
    ${l?y(d(l)):"()"}, /* params */ 
    ${p?.headers?`${((e,t=4)=>{let r=Object.entries(e).map(([e,r])=>{let o;return`${o=t+2," ".repeat(o)}("${e}".to_string(), "${r}".to_string())`}).join(",\n");return`Some(&HashMap::from([
${r}
${" ".repeat(4)}]))`})(p.headers)}, /* headers */`:"None, /* headers (HashMap) */ "}
    ${p?.apiRoot?`"${p.apiRoot}".to_string(), /* api_root */`:"None, /* api_root */"}
    false, /* disable_client_validation */
  );${c?`

match response {
    Ok(output) => println!("{:?}", output),
    /* 
    output ${f(c)} 
    */
    Err(e) => println!("error: {:?}", e),
  }`:""}${u?`

match response {
    Ok(stream) => {
      for (i, item) in stream.enumerate() {
        println!("#{}: {:?}", i, item);
        /*
        #0: iteration ${f(u,8)}
        */
      }
    },
    Err(e) => println!("Error initiating stream: {:?}", e),
  }`:""}
}`.trim()}({...g,packageName:b})}};let o=e.r(15955),n=e.r(76516),a=e=>e.replace(/-/g,"_").replace(/([a-z0-9])([A-Z])/g,"$1_$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1_$2").toLowerCase().replace(/^_/,"");function i(e){return!!e&&(e.startsWith("text/")||["application/json","application/ld+json","application/xml","application/xhtml+xml","application/javascript","application/typescript","application/yaml","application/x-yaml","application/toml","application/sql","application/graphql","application/x-www-form-urlencoded"].includes(e)||e.endsWith("+json")||e.endsWith("+xml"))}},55427,(e,t,r)=>{"use strict";function o(e,t){if(!e||"object"!=typeof e)return null;if(t=t||e,void 0!==e.example)return e.example;if(e.examples&&e.examples.length>0)return e.examples[0];if(void 0!==e.const)return e.const;if(e.$ref){var r,a=e.$ref,i=t;let n=a.split("/").slice(1),s=i;for(let e of n)if(void 0===(s=s[e]))return null;return o(s,i)}if(e.enum&&e.enum.length>0)return e.enum[0];if(e.oneOf&&e.oneOf.length>0)return o(e.oneOf[0],t);if(e.anyOf&&e.anyOf.length>0)return o(e.anyOf[0],t);if(e.allOf&&e.allOf.length>0)return o(e.allOf.reduce((e,t)=>({...e,...t}),{}),t);if(e.type)switch(e.type){case"string":var s=e;if(s.format)switch(s.format){case"email":case"idn-email":return"user@example.com";case"uri":case"url":case"iri":return"https://example.com";case"date":return"2023-01-01";case"date-time":return"2023-01-01T00:00:00Z";case"time":return"12:00:00Z";case"duration":return"PT1H";case"uuid":return"00000000-0000-0000-0000-000000000000";case"regex":return"^[a-zA-Z0-9]+$";case"relative-json-pointer":return"/some/relative/path";case"color":return"#000000";case"hostname":return"example.com";case"zipcode":return"12345";case"phone":return"+123-456-7890";case"password":return"******";default:return"string"}return s.pattern?"pattern-string":"string";case"number":case"integer":return void 0!==(r=e).minimum&&void 0!==r.maximum||void 0!==r.minimum?r.minimum:void 0!==r.maximum?r.maximum:0;case"boolean":return!0;case"object":return n(e,t);case"array":var l=e,c=t;if(l.items){let e=l.items;return Array.from({length:Math.min(l.minItems||1,3)},()=>o(e,c))}return[];default:return null}return e.properties?n(e,t):null}function n(e,t){let r={};if(e.properties){let n=e.required||[];for(let[a,i]of Object.entries(e.properties))(n.includes(a)||0===n.length)&&(r[a]=o(i,t))}return e.additionalProperties&&"object"==typeof e.additionalProperties&&(r.additionalProp=o(e.additionalProperties,t)),r}Object.defineProperty(r,"__esModule",{value:!0}),r.JSONSchemaToObject=o},70891,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.resolveGeneratorConfigValues=function({config:e,outputConfigs:t,forceOutputConfigs:r,segmentName:n,isBundle:a,projectPackageJson:i}){let s=(0,o.deepExtend)({},{main:"./index.cjs",module:"./index.mjs",types:"./index.d.mts",exports:{".":{import:"./index.mjs",require:"./index.cjs",types:"./index.d.mts"}}},Object.fromEntries(Object.entries(i??{}).filter(([e])=>["name","version","description","license","authors","repository","homepage","bugs","keywords"].includes(e))),e?.outputConfig?.package,"string"==typeof n?e?.outputConfig?.segments?.[n]?.package:void 0,t?.reduce((e,t)=>(0,o.deepExtend)(e,t.package),{}),a?e?.bundle?.outputConfig?.package:void 0);return{package:s,openAPIObject:(0,o.deepExtend)({},{openapi:"3.1.0",info:{title:s.name,version:s.version,description:s.description}},e?.outputConfig?.openAPIObject,"string"==typeof n?e?.outputConfig?.segments?.[n]?.openAPIObject:void 0,t?.reduce((e,t)=>(0,o.deepExtend)(e,t.openAPIObject),{}),a?e?.bundle?.outputConfig?.openAPIObject:void 0,r?.reduce((e,t)=>(0,o.deepExtend)(e,t.openAPIObject),{})),samples:(0,o.deepExtend)({},e?.outputConfig?.samples,"string"==typeof n?e?.outputConfig?.segments?.[n]?.samples:void 0,t?.reduce((e,t)=>(0,o.deepExtend)(e,t.samples),{}),a?e?.bundle?.outputConfig?.samples:void 0,r?.reduce((e,t)=>(0,o.deepExtend)(e,t.samples),{})),readme:(0,o.deepExtend)({},e?.outputConfig?.readme,"string"==typeof n?e?.outputConfig?.segments?.[n]?.readme:void 0,t?.reduce((e,t)=>(0,o.deepExtend)(e,t.readme),{}),a?e?.bundle?.outputConfig?.readme:void 0,r?.reduce((e,t)=>(0,o.deepExtend)(e,t.readme),{})),origin:[e?.outputConfig?.origin,"string"==typeof n?e?.outputConfig?.segments?.[n]?.origin:void 0,...t?.map(e=>e.origin)??[],a?e?.bundle?.outputConfig?.origin:void 0,...r?.map(e=>e.origin)??[]].filter(Boolean).at(-1)?.replace(/\/$/,"")??"",imports:(0,o.deepExtend)({fetcher:["vovk"],validateOnClient:null,createRPC:["vovk"]},e?.outputConfig?.imports,"string"==typeof n?e?.outputConfig?.segments?.[n]?.imports:void 0,t?.reduce((e,t)=>(0,o.deepExtend)(e,t.imports),{}),a?e?.bundle?.outputConfig?.imports:void 0,r?.reduce((e,t)=>(0,o.deepExtend)(e,t.imports),{})),reExports:(0,o.deepExtend)({},!n&&e?.outputConfig?.reExports,"string"!=typeof n&&Object.values(e?.outputConfig?.segments??{}).reduce((e,t)=>(0,o.deepExtend)(e,t.reExports??{}),{}),"string"==typeof n?e?.outputConfig?.segments?.[n]?.reExports:void 0,t?.reduce((e,t)=>(0,o.deepExtend)(e,t.reExports),{}),a?e?.bundle?.outputConfig?.reExports:void 0,r?.reduce((e,t)=>(0,o.deepExtend)(e,t.reExports),{}))}};let o=e.r(51893)},91204,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.vovkSchemaToOpenAPI=function({config:e,rootEntry:t="api",schema:r,outputConfigs:l,forceOutputConfigs:c,isBundle:u,segmentName:p,projectPackageJson:d}){let f={},m={},{openAPIObject:h,samples:E,package:y,readme:O,origin:b,imports:g,reExports:T}=(0,i.resolveGeneratorConfigValues)({config:e,outputConfigs:l,forceOutputConfigs:c,isBundle:u,segmentName:p??null,projectPackageJson:d});for(let[e,n]of p?[[p,r.segments[p]]]:Object.entries(r.segments??{}))for(let r of Object.values(n.controllers))for(let[n,i]of Object.entries(r.handlers??{}))if(i.operationObject&&!i.misc?.isOpenAPIMixin){let[l,c]=s(i?.validation?.query),[u,p]=s(i?.validation?.body),[d,h]=s(i?.validation?.params),[O,b]=s(i?.validation?.output),[g,T]=s(i?.validation?.iteration);Object.assign(m,c,p,h,b,T);let{ts:S,rs:_,py:v}=(0,o.createCodeSamples)({package:y,handlerName:n,handlerSchema:i,controllerSchema:r,config:E}),R=l&&"type"in l&&"properties"in l?Object.entries(l.properties??{}).map(([e,t])=>({name:e,in:"query",required:!!l.required&&l.required.includes(e),schema:t})):null,j=d&&"type"in d&&"properties"in d?Object.entries(d.properties??{}).map(([e,t])=>({name:e,in:"path",required:!!d.required&&d.required.includes(e),schema:t})):null,P=i.misc?.originalPath??"/"+[t.replace(/^\/+|\/+$/g,""),e,r.prefix,i.path].filter(Boolean).join("/");f[P]=f[P]??{};let A=i.httpMethod.toLowerCase();f[P][A]??={},f[P][A]={...i.operationObject,...f[P][A],"x-codeSamples":[...f[P][A]["x-codeSamples"]??[],...i.operationObject?.["x-codeSamples"]??[],{label:"TypeScript RPC",lang:"typescript",source:S},{label:"Python RPC",lang:"python",source:v},{label:"Rust RPC",lang:"rust",source:_}],...R||j?{parameters:i.operationObject?.parameters??[...R||[],...j||[]]}:{},...f[P][A].parameters?{parameters:f[P][A].parameters}:{},...O&&"type"in O?{responses:{200:{description:"description"in O?O.description:"Success",content:{[O["x-isForm"]?"multipart/form-data":"application/json"]:{schema:O}}},...i.operationObject?.responses}}:{},...g&&"type"in g?{responses:{200:{description:"description"in g?g.description:"JSON Lines response",content:{"application/jsonl":{schema:{...g,examples:g.examples??[[JSON.stringify((0,a.JSONSchemaToObject)(g)),JSON.stringify((0,a.JSONSchemaToObject)(g)),JSON.stringify((0,a.JSONSchemaToObject)(g))].join("\n")]}}}},...i.operationObject?.responses}}:{},...f[P][A].responses?{responses:f[P][A].responses}:{},...u&&"type"in u?{requestBody:i.operationObject?.requestBody??{description:"description"in u?u.description:"Request body",required:!0,content:{"application/json":{schema:u}}}}:{},...f[P][A].requestBody?{requestBody:f[P][A].requestBody}:{},tags:f[P][A].tags??i.operationObject?.tags}}return{readme:O,samples:E,package:y,imports:g,reExports:T,origin:b,openAPIObject:{...h,components:{...h?.components,schemas:{...h?.components?.schemas??m,HttpStatus:{type:"integer",description:"HTTP status code",enum:Object.keys(n.HttpStatus).map(e=>n.HttpStatus[e]).filter(Boolean).filter(e=>"number"==typeof e)},VovkErrorResponse:{type:"object",description:"Vovk error response",properties:{cause:{description:"Error cause of any shape"},statusCode:{$ref:"#/components/schemas/HttpStatus"},message:{type:"string",description:"Error message"},isError:{type:"boolean",const:!0,description:"Indicates that this object represents an error"}},required:["statusCode","message","isError"],additionalProperties:!1},...h?.components?.schemas}},paths:f}}};let o=e.r(89792),n=e.r(19863),a=e.r(55427),i=e.r(70891);function s(e){if(!e)return[void 0,{}];let t={},r=(e,o=[])=>{if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(e=>r(e,o));let n={};for(let[a,i]of(Object.entries({...e.definitions,...e.$defs}).forEach(([e,n])=>{t[e]=r(n,[...o,e])}),Object.entries(e??{})))if("$defs"!==a&&"definitions"!==a)if("$ref"===a&&"string"==typeof i){let e=i.split("/"),t=e[e.length-1];n[a]=`#/components/schemas/${t}`}else n[a]=r(i,[...o,a]);return n};return[r(e),t]}},84202,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.camelCase=function(e){return((null==e?"":String(e)).replace(/[\s_-]+/g," ").trim().match(o)||[]).map((e,t)=>{let r=e.toLowerCase();return 0===t?r:r.charAt(0).toUpperCase()+r.slice(1)}).join("")};let o=/[\p{Lu}]{2,}(?=[\p{Lu}][\p{Ll}]+[0-9]*|\b)|[\p{Lu}]?[\p{Ll}]+[0-9]*|[\p{Lu}]|[0-9]+/gu},4389,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.upperFirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},71057,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.applyComponentsSchemas=function(e,t,r){let i="components/schemas";if(!t||!Object.keys(t).length)return e;let s=a(e);s.$defs=s.$defs||{};let l=new Set;return function e(c){if(!c||"object"!=typeof c)return c;if(Array.isArray(c))return c.map(t=>e(t));let u={...c},p=u.$ref;if(p&&"string"==typeof p&&p.startsWith(`#/${i}/`)){let c=p.replace(`#/${i}/`,"");t[c]?(u.$ref=`#/$defs/${c}`,u["x-tsType"]??=`Mixins.${(0,n.upperFirst)((0,o.camelCase)(r))}.${(0,n.upperFirst)((0,o.camelCase)(c))}`):delete u.$ref,!l.has(c)&&t[c]&&(l.add(c),s.$defs[c]=e(a(t[c])))}for(let t in u)Object.prototype.hasOwnProperty.call(u,t)&&(u[t]=e(u[t]));return u}(s)};let o=e.r(84202),n=e.r(4389);function a(e){if(null===e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(a);let t={};for(let[r,o]of Object.entries(e))o instanceof Date||o instanceof RegExp||"function"==typeof o||(t[r]=a(o));return t}},5711,(e,t,r)=>{"use strict";function o(e,t){if(!e.startsWith("#/"))return void console.warn(`External references are not supported: ${e}`);let r=e.substring(1).split("/").filter(e=>""!==e),o=t;for(let t of r){let r=t.replace(/~1/g,"/").replace(/~0/g,"~");if(!o||"object"!=typeof o||!(r in o))return void console.warn(`Could not resolve reference: ${e}`);o=o[r]}return o}Object.defineProperty(r,"__esModule",{value:!0}),r.inlineRefs=function(e,t){if(null==e)return e;if(Array.isArray(e))return e.map(e=>{if(e&&"object"==typeof e&&"$ref"in e&&"string"==typeof e.$ref){if(e.$ref.startsWith("#/components/schemas/"))return e;let r=o(e.$ref,t);if(void 0!==r){let{$ref:t,...o}=e;return Object.keys(o).length>0?{...r,...o}:r}}return e});if("object"!=typeof e)return e;if("$ref"in e&&"string"==typeof e.$ref){if(e.$ref.startsWith("#/components/schemas/"))return e;let r=o(e.$ref,t);if(void 0!==r){let{$ref:t,...o}=e;return Object.keys(o).length>0?{...r,...o}:r}}return e}},90838,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.openAPIToVovkSchema=function({apiRoot:e,source:{object:t},getModuleName:r,getMethodName:i,errorMessageKey:s,segmentName:l}){l=l??"";let c=e||(t.servers?.[0]?.url??("host"in t?`https://${t.host}${"basePath"in t?t.basePath:""}`:null));if(!c)throw Error("API root URL is required in OpenAPI configuration");let{paths:u,...p}=t,d={$schema:o.VovkSchemaIdEnum.SCHEMA,segments:{[l]:{$schema:o.VovkSchemaIdEnum.SEGMENT,emitSchema:!0,segmentName:l,segmentType:"mixin",controllers:{},forceApiRoot:c,meta:{openAPIObject:p}}}},f=d.segments[l];return Object.entries(u??{}).reduce((e,[o,c])=>(Object.entries(c??{}).filter(([,e])=>e&&"object"==typeof e).forEach(([e,c])=>{let u=r({method:e.toUpperCase(),path:o,openAPIObject:t,operationObject:c}),p=i({method:e.toUpperCase(),path:o,openAPIObject:t,operationObject:c});f.controllers[u]??={rpcModuleName:u,handlers:{}};let d=(0,a.inlineRefs)(c.parameters??[],t),m=d.filter(e=>"query"===e.in)??null,h=d.filter(e=>"path"===e.in)??null,E=m?.length?{type:"object",properties:Object.fromEntries(m.map(e=>[e.name,e.schema])),required:m.filter(e=>e.required).map(e=>e.name)}:null,y=h?.length?{type:"object",properties:Object.fromEntries(h.map(e=>[e.name,e.schema])),required:h.filter(e=>e.required).map(e=>e.name)}:null,O=(0,a.inlineRefs)(c.requestBody,t)?.content??{},b=O["application/json"]?.schema??null,g=O["multipart/form-data"]?.schema??null,T=O["application/x-www-form-urlencoded"]?.schema??null;g&&T&&JSON.stringify(g)===JSON.stringify(T)&&(T=null),g&&Object.assign(g,{"x-isForm":!0,"x-tsType":"FormData"}),T&&Object.assign(T,{"x-isForm":!0,"x-tsType":"FormData"});let S=[b,g,T].filter(Boolean),_=S.length?1===S.length?S[0]:{anyOf:S}:null,v=c.responses?.["200"]?.content?.["application/json"]?.schema??c.responses?.["201"]?.content?.["application/json"]?.schema??null,R=c.responses?.["200"]?.content?.["application/jsonl"]?.schema??c.responses?.["201"]?.content?.["application/jsonl"]?.schema??c.responses?.["200"]?.content?.["application/jsonlines"]?.schema??c.responses?.["201"]?.content?.["application/jsonlines"]?.schema??null;s&&(c["x-errorMessageKey"]=s);let j=t.components?.schemas??("definitions"in t?t.definitions:{});f.controllers[u].handlers[p]={httpMethod:e.toUpperCase(),path:o,operationObject:c,misc:{isOpenAPIMixin:!0,originalPath:o},validation:{...E&&{query:(0,n.applyComponentsSchemas)(E,j,l)},...y&&{params:(0,n.applyComponentsSchemas)(y,j,l)},..._&&{body:(0,n.applyComponentsSchemas)(_,j,l)},...v&&{output:(0,n.applyComponentsSchemas)(v,j,l)},...R&&{iteration:(0,n.applyComponentsSchemas)(R,j,l)}}}}),e),d)};let o=e.r(19863),n=e.r(71057),a=e.r(5711)},40700,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createDecorator=function(e,t){return function(...r){return function(o,n){let a=o[n];if("function"!=typeof a)throw Error(`Unable to decorate: ${n} is not a function`);let i=a._sourceMethod??a,s=function(t,n){let i=async()=>await a.call(o,t,n);return e?e.call(o,t,i,...r):i()};o[n]=s,s._controller=o,s._sourceMethod=i,s.fn=a.fn,s.models=a.models,i.wrapper=s,a._controller=o;let l=o._handlers?.[n]??null,c=t?.call(o,...r),u="function"==typeof c?c(l,{handlerName:n}):c,p={...l,...u?.validation?{validation:u.validation}:{},...u?.operationObject?{operationObject:u.operationObject}:{},...u?.misc?{misc:u.misc}:{}};s.schema=p,o._handlers={...o._handlers,[n]:p}}}}},98876,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.error=void 0;let o=e.r(19863),n=e.r(40700),a={[o.HttpStatus.NULL]:"Error",[o.HttpStatus.CONTINUE]:"Continue",[o.HttpStatus.SWITCHING_PROTOCOLS]:"Switching Protocols",[o.HttpStatus.PROCESSING]:"Processing",[o.HttpStatus.EARLYHINTS]:"Early Hints",[o.HttpStatus.OK]:"OK",[o.HttpStatus.CREATED]:"Created",[o.HttpStatus.ACCEPTED]:"Accepted",[o.HttpStatus.NON_AUTHORITATIVE_INFORMATION]:"Non Authoritative Information",[o.HttpStatus.NO_CONTENT]:"No Content",[o.HttpStatus.RESET_CONTENT]:"Reset Content",[o.HttpStatus.PARTIAL_CONTENT]:"Partial Content",[o.HttpStatus.AMBIGUOUS]:"Ambiguous",[o.HttpStatus.MOVED_PERMANENTLY]:"Moved Permanently",[o.HttpStatus.FOUND]:"Found",[o.HttpStatus.SEE_OTHER]:"See Other",[o.HttpStatus.NOT_MODIFIED]:"Not Modified",[o.HttpStatus.TEMPORARY_REDIRECT]:"Temporary Redirect",[o.HttpStatus.PERMANENT_REDIRECT]:"Permanent Redirect",[o.HttpStatus.BAD_REQUEST]:"Bad Request",[o.HttpStatus.UNAUTHORIZED]:"Unauthorized",[o.HttpStatus.PAYMENT_REQUIRED]:"Payment Required",[o.HttpStatus.FORBIDDEN]:"Forbidden",[o.HttpStatus.NOT_FOUND]:"Not Found",[o.HttpStatus.METHOD_NOT_ALLOWED]:"Method Not Allowed",[o.HttpStatus.NOT_ACCEPTABLE]:"Not Acceptable",[o.HttpStatus.PROXY_AUTHENTICATION_REQUIRED]:"Proxy Authentication Required",[o.HttpStatus.REQUEST_TIMEOUT]:"Request Timeout",[o.HttpStatus.CONFLICT]:"Conflict",[o.HttpStatus.GONE]:"Gone",[o.HttpStatus.LENGTH_REQUIRED]:"Length Required",[o.HttpStatus.PRECONDITION_FAILED]:"Precondition Failed",[o.HttpStatus.PAYLOAD_TOO_LARGE]:"Payload Too Large",[o.HttpStatus.URI_TOO_LONG]:"URI Too Long",[o.HttpStatus.UNSUPPORTED_MEDIA_TYPE]:"Unsupported Media Type",[o.HttpStatus.REQUESTED_RANGE_NOT_SATISFIABLE]:"Requested Range Not Satisfiable",[o.HttpStatus.EXPECTATION_FAILED]:"Expectation Failed",[o.HttpStatus.I_AM_A_TEAPOT]:"I am a teapot",[o.HttpStatus.MISDIRECTED]:"Misdirected",[o.HttpStatus.UNPROCESSABLE_ENTITY]:"Unprocessable Entity",[o.HttpStatus.FAILED_DEPENDENCY]:"Failed Dependency",[o.HttpStatus.PRECONDITION_REQUIRED]:"Precondition Required",[o.HttpStatus.TOO_MANY_TRequestS]:"Too Many Requests",[o.HttpStatus.INTERNAL_SERVER_ERROR]:"Internal Server Error",[o.HttpStatus.NOT_IMPLEMENTED]:"Not Implemented",[o.HttpStatus.BAD_GATEWAY]:"Bad Gateway",[o.HttpStatus.SERVICE_UNAVAILABLE]:"Service Unavailable",[o.HttpStatus.GATEWAY_TIMEOUT]:"Gateway Timeout",[o.HttpStatus.HTTP_VERSION_NOT_SUPPORTED]:"HTTP Version Not Supported"};r.error=(0,n.createDecorator)(null,(e,t)=>r=>({...r,operationObject:{...r?.operationObject,responses:{...r?.operationObject?.responses,[e]:{description:`${e} ${a[e]}`,content:{"application/json":{schema:{allOf:[{$ref:"#/components/schemas/VovkErrorResponse"},{type:"object",properties:{message:{type:"string",enum:[t,...r?.operationObject?.responses?.[e]?.content?.["application/json"]?.schema?.allOf?.[1]?.properties?.message?.enum??[]]},statusCode:{type:"integer",enum:[e]}}}]}}}}}}}))},59745,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.tool=void 0,r.tool=(0,e.r(40700).createDecorator)(null,e=>t=>({...t,operationObject:{...t?.operationObject,"x-tool":e}}))},3182,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.openAPIToVovkSchema=r.vovkSchemaToOpenAPI=r.operation=r.operationDecorator=void 0;let o=e.r(91204);Object.defineProperty(r,"vovkSchemaToOpenAPI",{enumerable:!0,get:function(){return o.vovkSchemaToOpenAPI}});let n=e.r(90838);Object.defineProperty(r,"openAPIToVovkSchema",{enumerable:!0,get:function(){return n.openAPIToVovkSchema}});let a=e.r(40700),i=e.r(98876),s=e.r(59745);r.operationDecorator=(0,a.createDecorator)(null,(e={})=>t=>({...t,operationObject:{...t?.operationObject,...e}})),r.operation=Object.assign(r.operationDecorator,{error:i.error,tool:s.tool})},34168,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateStaticAPI=function(e,t="vovk"){return[{[t]:["_schema_"]},...Object.values(e).map(e=>{let r=e._handlers,o=e._prefix?.split("/")??[];return Object.entries(r??{}).map(([r,n])=>{let a=e._handlersMetadata?.[r]?.staticParams;return a?.length?a.map(e=>{let r=n.path;for(let[t,o]of Object.entries(e??{}))r=r.replace(`{${t}}`,o);return{[t]:[...o,...r.split("/")].filter(Boolean)}}):[{[t]:[...o,...n.path.split("/")].filter(Boolean)}]}).flat()}).flat()]}},81475,(e,t,r)=>{"use strict";async function o(e,t){e._getSchema=r=>{if(!r)throw Error("Error setting client validators. Controller not found. Did you forget to use an HTTP decorator?");if(!Object.getOwnPropertyNames(r).find(t=>r[t]._sourceMethod===e))throw Error("Error setting client validators. Handler not found.");return t}}Object.defineProperty(r,"__esModule",{value:!0}),r.setHandlerSchema=o},27752,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.withValidationLibrary=function({isForm:e,disableServerSideValidation:t,skipSchemaEmission:r,validateEachIteration:l,body:c,query:u,params:p,output:d,iteration:f,handle:m,toJSONSchema:h,validate:E,preferTransformed:y,operationObject:O}){y=y??!0;let b=!1===t?[]:!0===t?s:t??[],g=!1===r?[]:!0===r?s:r??[],T=async(e,t)=>{let{__disableClientValidation:r}=e.vovk.meta(),a=await m(e,t);if(r)return a;if(d&&f)throw new o.HttpException(n.HttpStatus.INTERNAL_SERVER_ERROR,"Output and iteration are mutually exclusive. You can't use them together.");if(d&&!b.includes("output")){if(!a)throw new o.HttpException(n.HttpStatus.INTERNAL_SERVER_ERROR,"Output is required. You probably forgot to return something from your handler.");let t=await E(a,d,{validationType:"output",req:e})??a;return y?t:a}if(f&&!b.includes("iteration")){if(!a||"function"!=typeof a[Symbol.asyncIterator])throw new o.HttpException(n.HttpStatus.INTERNAL_SERVER_ERROR,"Data is not an async iterable but iteration validation is defined.");return async function*(){let t=0;for await(let r of a){let o;o=l||0===t?await E(r,f,{validationType:"iteration",req:e,status:200,i:t})??r:r,t++,yield y?o:r}}()}if(l)throw new o.HttpException(n.HttpStatus.INTERNAL_SERVER_ERROR,"validateEachIteration is set but iteration is not defined.");return a},S=async(t,r)=>{let{__disableClientValidation:o}=t.vovk.meta();if(!o){if(c&&!b.includes("body")){let r=await t.vovk[e?"form":"body"](),o=await E(r,c,{validationType:e?"form":"body",req:t})??r,n=y?o:r;t.json=()=>Promise.resolve(r),t.vovk[e?"form":"body"]=()=>Promise.resolve(n)}if(u&&!b.includes("query")){let e=t.vovk.query(),r=await E(e,u,{validationType:"query",req:t})??e,o=y?r:e;t.vovk.query=()=>o}if(p&&!b.includes("params")){let e=t.vovk.params(),r=await E(e,p,{validationType:"params",req:t})??e,o=y?r:e;t.vovk.params=()=>o}}return T(t,r)},_=Object.assign(S,{fn:function(e){let t={vovk:{body:()=>Promise.resolve(e?.body??{}),query:()=>e?.query??{},params:()=>e?.params??{},meta:e=>(0,a.reqMeta)(t,e),form:()=>{throw Error("Form data is not supported in this context.")}}};t.vovk.meta({__disableClientValidation:e?.disableClientValidation,...e?.meta});let r=(S.wrapper??S)(t,e?.params??{});return e&&"transform"in e&&"function"==typeof e.transform?Promise.resolve(r).then(r=>e.transform(r,t)):r},models:{...void 0!==c?{body:c}:{},...void 0!==u?{query:u}:{},...void 0!==p?{params:p}:{},...void 0!==d?{output:d}:{},...void 0!==f?{iteration:f}:{}}});if(h){let t=(t,r)=>Object.assign(h(t,{validationType:r}),"body"===r&&e?{"x-isForm":e}:{}),r={};c&&!g.includes("body")&&(r.body=t(c,"body")),u&&!g.includes("query")&&(r.query=t(u,"query")),p&&!g.includes("params")&&(r.params=t(p,"params")),d&&!g.includes("output")&&(r.output=t(d,"output")),f&&!g.includes("iteration")&&(r.iteration=t(f,"iteration")),_.schema={validation:r,operationObject:O},(0,i.setHandlerSchema)(_,{validation:r,operationObject:O})}return _};let o=e.r(22468),n=e.r(19863),a=e.r(86037),i=e.r(81475),s=["body","query","params","output","iteration"]},49028,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toModelOutputDefault=void 0,r.toModelOutputDefault=e=>Promise.resolve(e instanceof Error?{error:e.message}:e)},59969,(e,t,r)=>{"use strict";var o=e.i(67034);Object.defineProperty(r,"__esModule",{value:!0}),r.toModelOutputMCP=void 0;let n=e.r(86037),a=e=>void 0!==o.Buffer?o.Buffer.from(e).toString("base64"):btoa([...new Uint8Array(e)].map(e=>String.fromCharCode(e)).join(""));async function i(e){let t=e.headers.get("Content-Type")?.split(";")[0].trim()||"";if(t.startsWith("audio/"))return{content:[{type:"audio",mimeType:t,data:a(await e.arrayBuffer())}]};if(t.startsWith("image/"))return{content:[{type:"image",mimeType:t,data:a(await e.arrayBuffer())}]};if("application/json"===t){let t=await e.json();return{content:[{type:"text",text:JSON.stringify(t)}],structuredContent:t}}return t.startsWith("text/")||/xml|javascript|yaml/.test(t)?{content:[{type:"text",text:await e.text()}]}:{content:[{type:"text",text:`Unsupported response content type ${t}`}],isError:!0}}r.toModelOutputMCP=async(e,{req:t})=>{let r=t?(0,n.reqMeta)(t).mcpOutput:null;if(e instanceof Response)return{...await i(e),...r||{}};let o=e instanceof Error;return{content:[{type:"text",text:o?e.message:JSON.stringify(e)}],...o?{isError:!0}:{},...!o&&"object"==typeof e&&null!==e?{structuredContent:e}:{},...r||{}}}},54923,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ToModelOutput=void 0;let o=e.r(49028),n=e.r(59969);r.ToModelOutput={DEFAULT:o.toModelOutputDefault,MCP:n.toModelOutputMCP}},81282,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createToolFactory=function({toJSONSchema:e}){return function({name:t,title:r,description:n,toModelOutput:a=o.ToModelOutput.DEFAULT,onExecute:i,onError:s,inputSchema:l,outputSchema:c,execute:u,target:p}){let d;return{type:"function",name:t,title:r,description:n,get parameters(){return d??=l?e(l,{validationType:"tool-input",target:p}):{}},inputSchema:l,outputSchema:c,inputSchemas:void 0,async execute(e,o){let p,d={name:t,title:r,description:n};try{let t;if(l){let r=await l["~standard"].validate(e);if(r.issues?.length)throw Error(`Input validation failed. ${r.issues.map(({message:e,path:t})=>`${e}${t?` at ${t.join(".")}`:""}`).join(", ")}`);t=r.value}else t=null;if(p=await u(t,o),c){let e=await c["~standard"].validate(p);if(e.issues?.length)throw Error(`Output validation failed. ${e.issues.map(({message:e,path:t})=>`${e}${t?` at ${t.join(".")}`:""}`).join(", ")}`);p=e.value}i?.(p,{toolOptions:d,processingMeta:o})}catch(e){s?.(e,{toolOptions:d,processingMeta:o}),p=e}return p instanceof Error&&(p.toJSON=()=>({isError:!0,message:p.message})),a(p,{toolOptions:d,handlerSchema:null,req:null})}}}};let o=e.r(54923)},84640,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createStandardValidation=function({toJSONSchema:e}){return Object.assign(function({isForm:t,body:r,query:i,params:s,output:l,iteration:c,handle:u,disableServerSideValidation:p,skipSchemaEmission:d,validateEachIteration:f,preferTransformed:m,operationObject:h,target:E}){return(0,n.withValidationLibrary)({isForm:t,body:r,query:i,params:s,output:l,iteration:c,disableServerSideValidation:p,skipSchemaEmission:d,validateEachIteration:f,handle:u,toJSONSchema:(t,r)=>e(t,{validationType:r.validationType,target:E}),validate:async(e,t,{validationType:r,i:n})=>{let i=await t["~standard"].validate(e);if(i.issues?.length)throw new a.HttpException(o.HttpStatus.BAD_REQUEST,`Validation failed. Invalid ${"iteration"===r?`${r} #${n}`:r} on server: ${i.issues.map(({message:e,path:t})=>`${e}${t?` at ${t.join(".")}`:""}`).join(", ")}`,{issues:i.issues});return i.value},preferTransformed:m,operationObject:h})},{createTool:(0,i.createToolFactory)({toJSONSchema:e})})};let o=e.r(19863),n=e.r(27752),a=e.r(22468),i=e.r(81282)},31391,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.multitenant=function(e){let{requestUrl:t,requestHost:r,targetHost:n,overrides:a}=e,i=new URL(t),s=i.pathname.slice(1);if(s.endsWith("_schema_"))return{action:null,destination:null,message:"Schema endpoint, bypassing overrides",subdomains:null};let l=s.split("/").filter(Boolean),c=Object.keys(a).filter(e=>!e.includes("[")&&!e.includes("]"));for(let e=0;e<l.length;e++){let t=l[e];if(c.includes(t)){let r=`${t}.${n}`,o=[...l.slice(0,e),...l.slice(e+1)].join("/"),a=new URL(`${i.protocol}//${r}`);return o&&(a.pathname=`/${o}`),a.search=i.search,{action:"redirect",destination:a.toString(),message:`Redirecting to ${t} subdomain`,subdomains:null}}}for(let e in a){let{regex:t,paramNames:l}=o(`${e}.${n}`),c=r.match(t);if(c){let t=a[e],r={};if(c.length>1)for(let e=0;e<l.length;e++)r[l[e]]=c[e+1];for(let e of t)if(s===e.from||s.startsWith(`${e.from}/`)){let t=s.replace(e.from,e.to);Object.keys(r).length>0&&Object.entries(r).forEach(([e,r])=>{t=t.replace(`[${e}]`,r)});let o=l.length>0?r:null;return{action:"rewrite",destination:`${i.protocol}//${i.host}/${t}${i.search}`,message:`Rewriting to ${t}`,subdomains:o}}}}if(l.length>0&&c.includes(l[0])){let e=l[0],t=l.slice(1).join("/"),r=`${e}.${n}`,o=new URL(`${i.protocol}//${r}`);return t&&(o.pathname=`/${t}`),o.search=i.search,{action:"redirect",destination:o.toString(),message:`Redirecting to ${e} subdomain`,subdomains:null}}return{action:null,destination:null,message:"No action",subdomains:null}};let o=e=>{let t=[],r=e.replace(/\[([^\]]+)\]/g,(e,r)=>(t.push(r),"([^.]+)")).replace(/\./g,"\\.");return{regex:RegExp(`^${r}$`),paramNames:t}}},49221,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deriveTools=function(e){let{modules:t,meta:r,toModelOutput:a=o.ToModelOutput.DEFAULT,onExecute:i=e=>e,onError:s=()=>{}}=e,l=Object.entries(t??{}).map(([e,t])=>Object.entries(t??{}).filter(([,e])=>e?.schema?.operationObject&&!e?.schema?.operationObject?.["x-tool"]?.hidden).map(([o])=>(({moduleName:e,handlerName:t,module:r,meta:o,toModelOutput:a,onExecute:i,onError:s})=>{if(!r)throw Error(`Module "${e}" not found.`);let l=r[t];if(!l)throw Error(`Handler "${t}" not found in module "${e}".`);let{schema:c,models:u}=l,p=Object.fromEntries(["body","query","params"].map(e=>[e,u?.[e]||void 0]).filter(([,e])=>!!e));if(!c||!c.operationObject)throw Error(`Handler "${t}" in module "${e}" does not have a valid schema.`);let d=async(r,u)=>{let{body:d,query:f,params:m}=r,h=c.operationObject?.["x-tool"]??{},E=await n({schema:c,inputSchemas:p,handler:l,toolOptions:h,body:d,query:f,params:m,meta:o,handlerName:t,moduleName:e,toModelOutput:a},u);return E instanceof Error?s(E,{toolOptions:h,processingMeta:u,req:null}):i(E,{toolOptions:h,processingMeta:u,req:null}),E},f={...c?.validation?.body?{body:c.validation.body}:{},...c?.validation?.query?{query:c.validation.query}:{},...c?.validation?.params?{params:c.validation.params}:{}};return{type:"function",execute:d,name:c.operationObject?.["x-tool"]?.name??`${e}_${t}`,inputSchema:void 0,outputSchema:u?.output,title:c.operationObject?.["x-tool"]?.title??c.operationObject?.summary,description:c.operationObject?.["x-tool"]?.description??([c.operationObject?.summary??"",c.operationObject?.description??""].filter(Boolean).join("\n")||t),parameters:{type:"object",properties:f,required:Object.keys(f),additionalProperties:!1},inputSchemas:p}})({moduleName:e,handlerName:o,module:t,meta:r,toModelOutput:a,onExecute:i,onError:s}))).flat(),c=Object.fromEntries(l.map(e=>[e.name,e]));return{tools:l,toolsByName:c}};let o=e.r(54923);async function n({handler:e,handlerName:t,body:r,query:o,params:n,meta:a,toModelOutput:i,schema:s,toolOptions:l},c){if(!e.isRPC&&!e.fn)throw Error("Handler is not a valid RPC or controller method");try{let c,u;if(e.isRPC)c=await e({handler:e,body:r,query:o,params:n,meta:a});else if(e.fn)[c,u]=await e.fn({body:r,query:o,params:n,meta:a,transform:(e,t)=>[e,t]});else throw Error(`Unable to call handler "${t}". It's neither RPC nor controller method with "fn" interface.`);return i(c,{toolOptions:l,handlerSchema:s,req:u})}catch(e){return i(e,{toolOptions:l,handlerSchema:s,req:null})}}},64323,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createValidateOnClient=function({validate:e}){return async function(t,r,o){let n={...t};return t.body&&r.body&&(n.body=await e(t.body,r.body,{...o,type:"body"})??t.body),t.query&&r.query&&(n.query=await e(t.query,r.query,{...o,type:"query"})??t.query),t.params&&r.params&&(n.params=await e(t.params,r.params,{...o,type:"params"})??t.params),n}}},26617,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.procedure=void 0,r.procedure=(0,e.r(84640).createStandardValidation)({toJSONSchema:(e,t)=>e["~standard"].jsonSchema.input({target:t.target??"draft-2020-12"})})},62066,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toDownloadResponse=function(e,{filename:t,type:r,headers:o}={}){let n=e instanceof Blob||e instanceof ReadableStream?e:new Blob([e],{type:r??"application/octet-stream"}),a=t??(e instanceof File?e.name:void 0),i=r??(n instanceof Blob?n.type:void 0);return new Response(n,{headers:{...i?{"Content-Type":i}:{},...a?{"Content-Disposition":`attachment; filename="${a.replace(/[^\x20-\x7E]|"/g,"_")}"; filename*=UTF-8''${encodeURIComponent(a)}`}:{},...o}})}},65729,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createTool=void 0,r.createTool=e.r(26617).procedure.createTool},17198,(e,t,r)=>{"use strict";var o;Object.defineProperty(r,"__esModule",{value:!0}),r.initSegment=r.prefix=r.options=r.head=r.del=r.patch=r.put=r.post=r.get=r.createTool=r.procedure=r.toDownloadResponse=r.ToModelOutput=r.resolveGeneratorConfigValues=r.vovkSchemaToOpenAPI=r.openAPIToVovkSchema=r.operation=r.progressive=r.createValidateOnClient=r.createCodeSamples=r.deriveTools=r.multitenant=r.createStandardValidation=r.withValidationLibrary=r.generateStaticAPI=r.createFetcher=r.fetcher=r.createRPC=r.createDecorator=r.createVovkApp=r.HttpMethod=r.HttpStatus=r.HttpException=r.JSONLinesResponse=r.VovkSchemaIdEnum=void 0;let n=e.r(56823);Object.defineProperty(r,"createVovkApp",{enumerable:!0,get:function(){return n.createVovkApp}});let a=e.r(19863);Object.defineProperty(r,"HttpStatus",{enumerable:!0,get:function(){return a.HttpStatus}}),Object.defineProperty(r,"HttpMethod",{enumerable:!0,get:function(){return a.HttpMethod}}),Object.defineProperty(r,"VovkSchemaIdEnum",{enumerable:!0,get:function(){return a.VovkSchemaIdEnum}});let i=e.r(98446);Object.defineProperty(r,"createRPC",{enumerable:!0,get:function(){return i.createRPC}}),Object.defineProperty(r,"fetcher",{enumerable:!0,get:function(){return i.fetcher}}),Object.defineProperty(r,"createFetcher",{enumerable:!0,get:function(){return i.createFetcher}}),Object.defineProperty(r,"progressive",{enumerable:!0,get:function(){return i.progressive}});let s=e.r(3182);Object.defineProperty(r,"operation",{enumerable:!0,get:function(){return s.operation}}),Object.defineProperty(r,"openAPIToVovkSchema",{enumerable:!0,get:function(){return s.openAPIToVovkSchema}}),Object.defineProperty(r,"vovkSchemaToOpenAPI",{enumerable:!0,get:function(){return s.vovkSchemaToOpenAPI}});let l=e.r(22468);Object.defineProperty(r,"HttpException",{enumerable:!0,get:function(){return l.HttpException}});let c=e.r(40700);Object.defineProperty(r,"createDecorator",{enumerable:!0,get:function(){return c.createDecorator}});let u=e.r(44901);Object.defineProperty(r,"JSONLinesResponse",{enumerable:!0,get:function(){return u.JSONLinesResponse}});let p=e.r(34168);Object.defineProperty(r,"generateStaticAPI",{enumerable:!0,get:function(){return p.generateStaticAPI}});let d=e.r(27752);Object.defineProperty(r,"withValidationLibrary",{enumerable:!0,get:function(){return d.withValidationLibrary}});let f=e.r(84640);Object.defineProperty(r,"createStandardValidation",{enumerable:!0,get:function(){return f.createStandardValidation}});let m=e.r(31391);Object.defineProperty(r,"multitenant",{enumerable:!0,get:function(){return m.multitenant}});let h=e.r(49221);Object.defineProperty(r,"deriveTools",{enumerable:!0,get:function(){return h.deriveTools}});let E=e.r(89792);Object.defineProperty(r,"createCodeSamples",{enumerable:!0,get:function(){return E.createCodeSamples}});let y=e.r(64323);Object.defineProperty(r,"createValidateOnClient",{enumerable:!0,get:function(){return y.createValidateOnClient}});let O=e.r(26617);Object.defineProperty(r,"procedure",{enumerable:!0,get:function(){return O.procedure}});let b=e.r(70891);Object.defineProperty(r,"resolveGeneratorConfigValues",{enumerable:!0,get:function(){return b.resolveGeneratorConfigValues}});let g=e.r(54923);Object.defineProperty(r,"ToModelOutput",{enumerable:!0,get:function(){return g.ToModelOutput}});let T=e.r(62066);Object.defineProperty(r,"toDownloadResponse",{enumerable:!0,get:function(){return T.toDownloadResponse}});let S=e.r(65729);Object.defineProperty(r,"createTool",{enumerable:!0,get:function(){return S.createTool}}),r.get=(o=(0,n.createVovkApp)()).get,r.post=o.post,r.put=o.put,r.patch=o.patch,r.del=o.del,r.head=o.head,r.options=o.options,r.prefix=o.prefix,r.initSegment=o.initSegment}]);