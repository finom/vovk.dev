import { FileTree } from 'nextra/components';

# Composed RPC Client

By default, Vovk.ts emits a single RPC client that contains all RPC modules from all segments. This approach is called the **Composed RPC Client** and is useful for single-page applications where you want a single import entry point for all RPC modules and all segments. The files are emitted into the [reconfigurable](/config) **node_modules/.vovk-client** folder, which is, in turn, re-exported from the **vovk-client** package.

The structure of the **node_modules/.vovk-client** folder that is generated by default from the [cjs](/templates#cjs) + [mjs](/templates#mjs) templates looks like this:

<FileTree> 
  <FileTree.Folder name="node_modules/.vovk-client" defaultOpen>
    <FileTree.File name="index.cjs" />
    <FileTree.File name="index.d.cts" />
    <FileTree.File name="index.mjs" />
    <FileTree.File name="index.d.mts" />
    <FileTree.File name="schema.cjs" />
    <FileTree.File name="schema.d.cts" />
    <FileTree.File name="openapi.json" />
    <FileTree.File name="openapi.cjs" />
    <FileTree.File name="openapi.d.cts" />
  </FileTree.Folder>
</FileTree>

The **vovk-client** package re-exports the `index.cjs`, `index.mjs`, etc. files in its own `index.cjs`, `index.mjs`, etc. files.

```ts filename="node_modules/vovk-client/index.mjs"
export * from '../.vovk-client/index.mjs';
```

```ts filename="node_modules/vovk-client/index.d.mts"
export * from '../.vovk-client/index.d.mts';
```

etc.

The generation using default settings can be replicated by the [CLI](/cli) command:

```sh npm2yarn
npx vovk generate --from mjs --from cjs --out-dir node_modules/.vovk-client
```

## Composed Client Config

The composed client can be configured with the following options:

```ts filename="vovk.config.mjs"
/** @type {import('vovk').VovkConfig} */
const config = {
  composedClient: {
    enabled: true, // default
    fromTemplates: ['mjs', 'cjs'], // default
    outDir: './node_modules/.vovk-client', // default
    includeSegments: ['foo'], // exclusive with `excludeSegments`
    excludeSegments: ['bar'], // exclusive with `includeSegments`,
  },
};
export default config;
```

### `enabled`

If set to `false`, the composed client won't be generated. This is useful if you want to generate only segmented clients.

### `fromTemplates`

An array of templates to use for composed client generation. By default, it uses `["mjs", "cjs"]` templates that generate ESM and CJS modules with TypeScript definitions. The array can contain names of [built-in templates](/templates) as well as custom templates.

### `outDir`

The path where the composed client will be generated. By default, it uses the `./node_modules/.vovk-client` folder. The path is relative to CWD.

### `includeSegments`

An array of segments to include in the composed client. By default, it includes all segments. You can use this option to include only specific segments in the composed client.

### `excludeSegments`

An array of segments to exclude from the composed client. By default, it excludes no segments. You can use this option to exclude specific segments from the composed client. This property is mutually exclusive with `includeSegments`.

### `prettifyClient`

Whether the generated client code needs to be prettified. Defaults to `false`. If set to `true`, the client code will be formatted with [Prettier](https://prettier.io/) using your local configuration. This slightly increases time of generation.
