### Vercel cron jobs

In order to create a cron job on Vercel, you can create a decorator that checks authorization header with a secret key defined as `CRON_SECRET` in the environment variable.

```ts filename="src/decorators/cronGuard.ts"
import { HttpException, HttpStatus, createDecorator } from 'vovk';

const cronGuard = createDecorator(async (req, next) => {
  if (req.headers.get('authorization') !== `Bearer ${process.env.CRON_SECRET}`) {
    throw new HttpException(HttpStatus.UNAUTHORIZED, 'Unauthorized');
  }

  return next();
});

export default cronGuard;
```

```ts filename="src/modules/cron/CronController.ts"
import { get, prefix } from 'vovk';
import cronGuard from '../decorators/cronGuard';

@prefix('cron')
export default class CronController {
  @get('do-something')
  @cronGuard()
  static async doSomething() {
    // ...
  }
}
```

Add the cron job to the `vercel.json` file. The `schedule` field uses the cron syntax (at this case the cron job will run every day at midnight). Read more about [Vercel cron jobs](https://vercel.com/docs/cron-jobs).

```json filename="/vercel.json"
{
  "crons": [
    {
      "path": "/api/cron/do-something",
      "schedule": "0 0 * * *"
    }
  ]
}
```
